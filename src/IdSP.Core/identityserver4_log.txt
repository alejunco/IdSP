2017-11-09 23:33:47.730 -05:00 [ERR] Failed executing DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Clients] AS [c])
    THEN CAST(1 AS BIT) ELSE CAST(0 AS BIT)0
END
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
ClientConnectionId:5801552d-66dd-4885-9685-246e33cebc85
Error Number:208,State:1,Class:16
2017-11-09 23:33:47.806 -05:00 [ERR] An exception occurred in the database while iterating the results of a query for context type 'IdentityServer4.EntityFramework.DbContexts.ConfigurationDbContext'.
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at lambda_method(Closure , QueryContext )
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass17_0`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:5801552d-66dd-4885-9685-246e33cebc85
Error Number:208,State:1,Class:16
System.Data.SqlClient.SqlException (0x80131904): Invalid object name 'Clients'.
   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at System.Data.SqlClient.SqlDataReader.get_MetaData()
   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString)
   at System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, SqlDataReader ds)
   at System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean asyncWrite, String method)
   at System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at System.Data.Common.DbCommand.ExecuteReader()
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.Execute(IRelationalConnection connection, DbCommandMethod executeMethod, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Storage.Internal.RelationalCommand.ExecuteReader(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.BufferlessMoveNext(Boolean buffer)
   at Microsoft.EntityFrameworkCore.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryingEnumerable`1.Enumerator.MoveNext()
   at Microsoft.EntityFrameworkCore.Query.QueryMethodProvider.GetResult[TResult](IEnumerable`1 valueBuffers, Boolean throwOnNullResult)
   at lambda_method(Closure , QueryContext )
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass17_0`1.<CompileQueryCore>b__0(QueryContext qc)
ClientConnectionId:5801552d-66dd-4885-9685-246e33cebc85
Error Number:208,State:1,Class:16
2017-11-09 23:36:56.755 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-09 23:36:56.782 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-09 23:36:56.783 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-09 23:36:56.783 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-09 23:36:56.784 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-09 23:36:56.868 -05:00 [DBG] Starting token cleanup
2017-11-09 23:37:56.982 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-09 23:37:57.010 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-09 23:37:57.011 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-09 23:37:57.012 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-09 23:37:57.012 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-09 23:37:57.091 -05:00 [DBG] Starting token cleanup
2017-11-09 23:41:28.782 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-09 23:41:28.810 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-09 23:41:28.810 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-09 23:41:28.811 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-09 23:41:28.812 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-09 23:41:28.895 -05:00 [DBG] Starting token cleanup
2017-11-09 23:57:03.325 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-09 23:57:03.354 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-09 23:57:03.356 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-09 23:57:03.356 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-09 23:57:03.357 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-09 23:57:03.436 -05:00 [DBG] Starting token cleanup
2017-11-09 23:59:50.860 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-09 23:59:50.890 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-09 23:59:50.891 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-09 23:59:50.892 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-09 23:59:50.893 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-09 23:59:50.975 -05:00 [DBG] Starting token cleanup
2017-11-10 00:15:51.937 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:15:51.966 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:15:51.967 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:15:51.968 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:15:51.968 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:15:52.052 -05:00 [DBG] Starting token cleanup
2017-11-10 00:15:58.918 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: Unable to resolve service for type 'IdSP.Core.Services.IEmailSender' while attempting to activate 'IdSP.Core.Controllers.AccountController'.
   at Microsoft.Extensions.Internal.ActivatorUtilities.GetService(IServiceProvider sp, Type type, Type requiredBy, Boolean isDefaultParameterRequired)
   at lambda_method(Closure , IServiceProvider , Object[] )
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerActivatorProvider.<>c__DisplayClass4_0.<CreateActivator>b__0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Controllers.ControllerFactoryProvider.<>c__DisplayClass5_0.<CreateControllerFactory>g__CreateController0(ControllerContext controllerContext)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:17:40.771 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:17:40.807 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:17:40.808 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:17:40.809 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:17:40.809 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:17:40.924 -05:00 [DBG] Starting token cleanup
2017-11-10 00:17:42.070 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 00:17:42.082 -05:00 [ERR] The view 'Login' was not found. Searched locations: ["/Views/Account/Login.cshtml","/Views/Shared/Login.cshtml"]
2017-11-10 00:17:42.097 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.InvalidOperationException: The view 'Login' was not found. The following locations were searched:
/Views/Account/Login.cshtml
/Views/Shared/Login.cshtml
   at Microsoft.AspNetCore.Mvc.ViewEngines.ViewEngineResult.EnsureSuccessful(IEnumerable`1 originalLocations)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:18:16.811 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 00:18:33.571 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 00:30:18.544 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:30:18.573 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:30:18.574 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:30:18.575 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:30:18.575 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:30:18.658 -05:00 [DBG] Starting token cleanup
2017-11-10 00:30:54.189 -05:00 [INF] User created a new account with password.
2017-11-10 00:30:54.490 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.Net.Mail.SmtpException: Failure sending mail. ---> System.Net.Sockets.SocketException: No such host is known
   at System.Net.Dns.InternalGetHostByName(String hostName, Boolean includeIPv6)
   at System.Net.Dns.GetHostAddresses(String hostNameOrAddress)
   at System.Net.Sockets.TcpClient.Connect(String hostname, Int32 port)
   at System.Net.Mail.SmtpConnection.GetConnection(String host, Int32 port)
   at System.Net.Mail.SmtpTransport.GetConnection(String host, Int32 port)
   at System.Net.Mail.SmtpClient.GetConnection()
   at System.Net.Mail.SmtpClient.Send(MailMessage message)
   --- End of inner exception stack trace ---
   at IdSP.Core.Services.EmailSender.SendEmailAsync(String email, String subject, String message) in C:\GitHub\IdSP\src\IdSP.Core\Services\EmailSender.cs:line 39
   at IdSP.Core.Extensions.EmailSenderExtensions.SendEmailConfirmationAsync(IEmailSender emailSender, String email, String link) in C:\GitHub\IdSP\src\IdSP.Core\Extensions\EmailSenderExtensions.cs:line 15
   at IdSP.Core.Controllers.AccountController.<Register>d__19.MoveNext() in C:\GitHub\IdSP\src\IdSP.Core\Controllers\AccountController.cs:line 244
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:36:26.357 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:36:26.389 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:36:26.390 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:36:26.391 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:36:26.391 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:36:26.498 -05:00 [DBG] Starting token cleanup
2017-11-10 00:36:53.082 -05:00 [INF] User created a new account with password.
2017-11-10 00:36:53.834 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.Net.Mail.SmtpException: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required. Learn more at
   at IdSP.Core.Services.EmailSender.SendEmailAsync(String email, String subject, String message) in C:\GitHub\IdSP\src\IdSP.Core\Services\EmailSender.cs:line 44
   at IdSP.Core.Extensions.EmailSenderExtensions.SendEmailConfirmationAsync(IEmailSender emailSender, String email, String link) in C:\GitHub\IdSP\src\IdSP.Core\Extensions\EmailSenderExtensions.cs:line 15
   at IdSP.Core.Controllers.AccountController.<Register>d__19.MoveNext() in C:\GitHub\IdSP\src\IdSP.Core\Controllers\AccountController.cs:line 244
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:37:58.658 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:37:58.688 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:37:58.689 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:37:58.690 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:37:58.690 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:37:58.782 -05:00 [DBG] Starting token cleanup
2017-11-10 00:38:13.256 -05:00 [INF] User created a new account with password.
2017-11-10 00:38:13.789 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.Net.Mail.SmtpException: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required. Learn more at
   at IdSP.Core.Services.EmailSender.SendEmailAsync(String email, String subject, String message) in C:\GitHub\IdSP\src\IdSP.Core\Services\EmailSender.cs:line 44
   at IdSP.Core.Extensions.EmailSenderExtensions.SendEmailConfirmationAsync(IEmailSender emailSender, String email, String link) in C:\GitHub\IdSP\src\IdSP.Core\Extensions\EmailSenderExtensions.cs:line 15
   at IdSP.Core.Controllers.AccountController.<Register>d__19.MoveNext() in C:\GitHub\IdSP\src\IdSP.Core\Controllers\AccountController.cs:line 244
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:38:43.766 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:38:43.808 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:38:43.809 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:38:43.810 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:38:43.813 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:38:43.930 -05:00 [DBG] Starting token cleanup
2017-11-10 00:38:59.934 -05:00 [INF] User created a new account with password.
2017-11-10 00:39:00.466 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.Net.Mail.SmtpException: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required. Learn more at
   at IdSP.Core.Services.EmailSender.SendEmailAsync(String email, String subject, String message) in C:\GitHub\IdSP\src\IdSP.Core\Services\EmailSender.cs:line 51
   at IdSP.Core.Extensions.EmailSenderExtensions.SendEmailConfirmationAsync(IEmailSender emailSender, String email, String link) in C:\GitHub\IdSP\src\IdSP.Core\Extensions\EmailSenderExtensions.cs:line 15
   at IdSP.Core.Controllers.AccountController.<Register>d__19.MoveNext() in C:\GitHub\IdSP\src\IdSP.Core\Controllers\AccountController.cs:line 244
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:43:38.937 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:43:38.966 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:43:38.967 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:43:38.968 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:43:38.968 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:43:39.059 -05:00 [DBG] Starting token cleanup
2017-11-10 00:43:59.209 -05:00 [INF] User created a new account with password.
2017-11-10 00:43:59.705 -05:00 [ERR] An unhandled exception has occurred while executing the request
System.Net.Mail.SmtpException: The SMTP server requires a secure connection or the client was not authenticated. The server response was: 5.5.1 Authentication Required. Learn more at
   at IdSP.Core.Services.EmailSender.SendEmailAsync(String email, String subject, String message) in C:\GitHub\IdSP\src\IdSP.Core\Services\EmailSender.cs:line 51
   at IdSP.Core.Extensions.EmailSenderExtensions.SendEmailConfirmationAsync(IEmailSender emailSender, String email, String link) in C:\GitHub\IdSP\src\IdSP.Core\Extensions\EmailSenderExtensions.cs:line 15
   at IdSP.Core.Controllers.AccountController.<Register>d__19.MoveNext() in C:\GitHub\IdSP\src\IdSP.Core\Controllers\AccountController.cs:line 244
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeActionMethodAsync>d__12.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeNextActionFilterAsync>d__10.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:47:05.622 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:47:05.654 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:47:05.655 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:47:05.655 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:47:05.656 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:47:05.766 -05:00 [DBG] Starting token cleanup
2017-11-10 00:47:21.821 -05:00 [INF] User created a new account with password.
2017-11-10 00:47:23.412 -05:00 [DBG] Augmenting SignInContext
2017-11-10 00:47:23.426 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-10 00:47:23.427 -05:00 [INF] User created a new account with password.
2017-11-10 00:47:23.438 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:47:23.439 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:47:23.608 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:47:23.609 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:47:23.769 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:47:23.770 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:08.661 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:48:08.689 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:48:08.690 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:48:08.690 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:48:08.691 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:48:08.779 -05:00 [DBG] Starting token cleanup
2017-11-10 00:48:22.002 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:22.019 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:22.260 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-10 00:48:22.285 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 00:48:22.285 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-10 00:48:22.286 -05:00 [INF] User logged out.
2017-11-10 00:48:31.345 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 00:48:44.771 -05:00 [INF] User created a new account with password.
2017-11-10 00:48:46.273 -05:00 [DBG] Augmenting SignInContext
2017-11-10 00:48:46.282 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-10 00:48:46.283 -05:00 [INF] User created a new account with password.
2017-11-10 00:48:46.289 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:46.290 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:46.338 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:46.339 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:46.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:46.479 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:58.715 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:58.716 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:59.404 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:59.405 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:59.733 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:48:59.735 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:49:28.383 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:49:28.384 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:57:58.066 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:57:58.096 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:57:58.097 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:57:58.097 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:57:58.098 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:57:58.198 -05:00 [DBG] Starting token cleanup
2017-11-10 00:58:44.291 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:58:44.324 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:58:44.325 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:58:44.325 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:58:44.326 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:58:44.426 -05:00 [DBG] Starting token cleanup
2017-11-10 00:58:45.708 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:45.722 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:49.193 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:49.197 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:53.489 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:53.490 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:56.337 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:56.338 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:56.550 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:58:56.551 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:02.585 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:02.588 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:03.113 -05:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\_ViewImports.cshtml(2,12): error CS0234: The type or namespace name 'Models' does not exist in the namespace 'Host' (are you missing an assembly reference?)
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\_ViewImports.cshtml(3,12): error CS0234: The type or namespace name 'Models' does not exist in the namespace 'Host' (are you missing an assembly reference?)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CreateCacheEntry(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:59:52.242 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 00:59:52.294 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 00:59:52.296 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 00:59:52.298 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 00:59:52.300 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 00:59:52.415 -05:00 [DBG] Starting token cleanup
2017-11-10 00:59:52.729 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:52.743 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:54.511 -05:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\Index.cshtml(4,28): error CS0103: The name 'ManageNavPages' does not exist in the current context
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\Index.cshtml(4,14): error CS1061: 'ViewDataDictionary<IndexViewModel>' does not contain a definition for 'AddActivePage' and no extension method 'AddActivePage' accepting a first argument of type 'ViewDataDictionary<IndexViewModel>' could be found (are you missing a using directive or an assembly reference?)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CreateCacheEntry(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 00:59:56.777 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:56.785 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 00:59:56.803 -05:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\Index.cshtml(4,28): error CS0103: The name 'ManageNavPages' does not exist in the current context
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\Index.cshtml(4,14): error CS1061: 'ViewDataDictionary<IndexViewModel>' does not contain a definition for 'AddActivePage' and no extension method 'AddActivePage' accepting a first argument of type 'ViewDataDictionary<IndexViewModel>' could be found (are you missing a using directive or an assembly reference?)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CreateCacheEntry(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-10 01:00:43.617 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 01:00:43.655 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 01:00:43.656 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 01:00:43.656 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 01:00:43.657 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 01:00:43.759 -05:00 [DBG] Starting token cleanup
2017-11-10 01:00:43.989 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:44.003 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:47.247 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:47.277 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:47.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:47.480 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.278 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.279 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.458 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.460 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.500 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:51.501 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.621 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.622 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.948 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.949 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.990 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:52.990 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.399 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.400 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.563 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.570 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.663 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:53.663 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.194 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.196 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.226 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.230 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.334 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.339 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.771 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.772 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.801 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.804 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.929 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:54.930 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.381 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.382 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.405 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.406 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.520 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:00:55.521 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:04.848 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:04.849 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:04.882 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:04.888 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.042 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.043 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.557 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.558 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.591 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.601 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.693 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:05.696 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.368 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.369 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.403 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.413 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.509 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:06.513 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.062 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.065 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.094 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.101 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.195 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:10.197 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.000 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.002 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.039 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.044 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.161 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:12.163 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:13.958 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:13.960 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:13.988 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:13.992 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:14.035 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:14.038 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.185 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.188 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.212 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.220 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.316 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:15.318 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:16.188 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:16.191 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:16.238 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 01:01:16.245 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-10 01:01:49.035 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-10 01:01:49.043 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.046 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.058 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-10 01:01:49.229 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-10 01:01:49.340 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.342 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.413 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.419 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.541 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:01:49.544 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:03:31.744 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-10 01:03:31.790 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-10 01:03:31.791 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-10 01:03:31.791 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-10 01:03:31.792 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-10 01:03:31.915 -05:00 [DBG] Starting token cleanup
2017-11-10 01:04:17.244 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:04:17.258 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:04:20.683 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:04:20.698 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:04:20.893 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-10 01:04:20.894 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:13:24.830 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:13:24.858 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:13:24.858 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:13:24.858 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:13:24.858 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:13:25.066 -05:00 [DBG] Starting token cleanup
2017-11-13 13:13:42.598 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:13:42.621 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:13:42.622 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:13:42.622 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:13:42.622 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:13:42.716 -05:00 [DBG] Starting token cleanup
2017-11-13 13:13:50.242 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:13:54.505 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 13:14:59.537 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:14:59.564 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:14:59.565 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:14:59.566 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:14:59.566 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:14:59.644 -05:00 [DBG] Starting token cleanup
2017-11-13 13:15:08.924 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:15:10.810 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 13:15:11.343 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 13:15:11.358 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 13:15:14.518 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 13:15:14.728 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:15:14.737 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:15:14.738 -05:00 [INF] User created an account using Facebook provider.
2017-11-13 13:15:14.746 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:15:14.747 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:15:14.768 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:15:14.769 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:15:14.877 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:15:14.878 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:00.929 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:00.930 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:01.433 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:01.435 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:01.629 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:01.630 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.758 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.760 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.828 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.829 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.858 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:09.859 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:10.011 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:10.012 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:11.944 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:11.946 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:11.959 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:11.961 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.114 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.217 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.219 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.888 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:12.890 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.115 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.117 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.249 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.251 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.905 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:13.906 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.066 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.068 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.172 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.173 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.697 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.698 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.721 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.722 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.818 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:14.820 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.257 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.259 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.285 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.287 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.385 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:16.386 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.392 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.394 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.581 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.581 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.583 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.584 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.679 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.680 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.724 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:16:17.726 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:49.949 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:49.950 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:50.124 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:50.128 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:50.332 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:17:50.333 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.297 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.299 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.342 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e has enabled 2FA with an authenticator app.
2017-11-13 13:18:35.349 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.350 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.374 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e has generated new 2FA recovery codes.
2017-11-13 13:18:35.524 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.526 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.741 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:35.742 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:49.869 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:49.871 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:49.895 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:49.896 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:50.096 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:50.097 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.397 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.399 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.407 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.409 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.430 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.431 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.555 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:18:51.556 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.694 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.720 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.722 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.823 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:00.825 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:01.964 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:01.966 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:01.992 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:01.994 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.126 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.128 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.725 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.727 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.750 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.752 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.881 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:02.882 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.725 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.726 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.747 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.749 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.845 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:06.846 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.252 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.254 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.263 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.265 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.287 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.379 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.380 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.819 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.821 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.841 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.843 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:11.935 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.396 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.398 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.421 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.423 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.511 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.512 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.997 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:12.998 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.019 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.021 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.114 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.596 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.597 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.604 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.606 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.625 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.626 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.716 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:13.717 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.109 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.111 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.132 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.133 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.223 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.225 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.979 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:14.981 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:15.005 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:15.006 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:15.111 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:15.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:16.892 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:16.894 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:16.923 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e has generated new 2FA recovery codes.
2017-11-13 13:19:16.941 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:16.943 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:17.033 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:17.035 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.421 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.423 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.447 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.448 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.540 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:18.541 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.627 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.629 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.769 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.771 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.895 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:23.896 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:27.908 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:27.910 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:27.931 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:27.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.050 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.051 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.659 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.662 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.668 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.669 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.688 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.690 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.780 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:28.781 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.235 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.236 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.256 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.257 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.347 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:29.349 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.570 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.572 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.591 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.593 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:32.693 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.155 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.157 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.246 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.264 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.265 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.355 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.356 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.667 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.669 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.766 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.769 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.860 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:33.861 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.194 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.196 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.198 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.213 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.215 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.305 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.306 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.691 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.711 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.713 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.808 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:34.810 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.123 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.125 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.144 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.145 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.234 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.236 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.892 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.894 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.896 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.914 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:35.916 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:36.014 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:36.016 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:38.922 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:38.924 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:38.945 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:38.946 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.042 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.044 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.580 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.582 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.604 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.606 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.702 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:39.703 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:41.568 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:41.570 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.452 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.453 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.476 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.477 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.572 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:43.573 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:56.870 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:56.871 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:57.301 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:57.303 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:57.611 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:19:57.612 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.042 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.044 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.071 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.075 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.221 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:01.223 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.586 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.588 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.591 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.609 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.611 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.711 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:03.712 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.689 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.690 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.710 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.713 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.811 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:06.812 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:08.667 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:08.669 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:08.712 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:20:08.714 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:20:08.715 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:20:08.716 -05:00 [INF] User logged out.
2017-11-13 13:20:13.219 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:20:13.226 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:20:15.923 -05:00 [WRN] Invalid password for user cf559f42-d46a-4dea-9390-b50e0f71a84e.
2017-11-13 13:20:15.925 -05:00 [WRN] User cf559f42-d46a-4dea-9390-b50e0f71a84e failed to provide the correct password.
2017-11-13 13:20:19.380 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 13:20:19.658 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 13:20:19.664 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 13:20:19.677 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:20:19.685 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:20:19.687 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:20:19.688 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 13:20:19.694 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:19.695 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:19.716 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:19.718 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:19.808 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:19.809 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.145 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.147 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.154 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.156 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.175 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.176 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.268 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:21.269 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:24.875 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:24.876 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:24.896 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:24.897 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:24.999 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.001 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.642 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.644 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.651 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.652 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.670 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.672 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.763 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:25.764 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.166 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.168 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.186 -05:00 [WRN] User cf559f42-d46a-4dea-9390-b50e0f71a84e password validation failed: PasswordRequiresUpper.
2017-11-13 13:20:38.207 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.208 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.399 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:38.400 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.230 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.232 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.259 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:20:48.261 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:20:48.267 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.268 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.277 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.278 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.437 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.438 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.678 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:48.680 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.666 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.668 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.705 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.707 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.836 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:52.837 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:53.721 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:53.724 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:20:53.725 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:20:53.727 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:20:53.727 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:20:53.729 -05:00 [INF] User logged out.
2017-11-13 13:20:57.257 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:21:02.604 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:21:02.620 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:21:17.517 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:21:17.521 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:21:17.525 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:21:17.532 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:21:17.534 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:21:17.535 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:21:17.541 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:17.542 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:17.562 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:17.563 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:17.759 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:17.761 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.562 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.563 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.584 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.586 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.684 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:19.685 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.281 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.283 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.302 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.304 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.409 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:22.410 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.288 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.290 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.292 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.309 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.311 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.402 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.404 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.736 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.737 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.754 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.756 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.846 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:23.847 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.160 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.161 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.163 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.179 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.181 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.272 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.273 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.657 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.659 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.678 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.680 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.774 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:24.775 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.239 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.240 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.465 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.467 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.668 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:21:55.669 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.077 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.078 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.250 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.252 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.449 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:42.451 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:55.980 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:55.981 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:56.156 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:56.157 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:56.357 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:22:56.358 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:23:46.973 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:23:46.976 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:26:14.522 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:26:14.524 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:27:07.775 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:27:07.777 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:27:29.156 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:27:29.184 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:27:29.185 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:27:29.185 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:27:29.186 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:27:29.260 -05:00 [DBG] Starting token cleanup
2017-11-13 13:27:30.182 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:27:30.196 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:26.606 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:26.607 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:47.814 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:47.815 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:51.772 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:51.774 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:28:51.837 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:28:51.839 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:28:51.839 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:28:51.840 -05:00 [INF] User logged out.
2017-11-13 13:29:27.556 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:29:27.567 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:29:32.085 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:29:32.100 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:29:45.077 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:29:45.083 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:29:45.091 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:29:45.151 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:29:45.156 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:29:45.157 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:29:45.162 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:45.163 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:48.452 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:48.454 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:49.860 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:49.861 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:52.645 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:52.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:29:52.648 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:29:52.648 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:29:52.649 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:29:52.649 -05:00 [INF] User logged out.
2017-11-13 13:30:18.817 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:30:18.822 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:30:22.220 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:30:24.111 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:30:24.119 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:30:37.151 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:30:37.154 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:30:37.157 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:30:37.160 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:30:37.160 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:30:37.161 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:30:37.167 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:37.168 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:40.572 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:40.573 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:44.004 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:44.005 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:30:44.006 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:30:44.007 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:30:44.007 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:30:44.008 -05:00 [INF] User logged out.
2017-11-13 13:31:47.914 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:31:49.385 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:31:49.393 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:02.984 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:02.987 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:02.989 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:32:02.994 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:32:02.995 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:32:02.996 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:32:03.001 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:32:03.002 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:32:07.050 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:32:07.051 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:32:07.052 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:32:07.053 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:32:07.053 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:32:07.054 -05:00 [INF] User logged out.
2017-11-13 13:32:23.574 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:32:23.604 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:32:23.605 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:32:23.606 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:32:23.606 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:32:23.755 -05:00 [DBG] Starting token cleanup
2017-11-13 13:32:45.280 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:32:48.932 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:32:48.975 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:58.495 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:58.543 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:32:58.580 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:32:58.583 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 13:32:58.702 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:32:58.720 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:32:58.723 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:32:58.741 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:32:58.744 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:00.658 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:00.661 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:03.098 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:03.101 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:05.314 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:33:05.317 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:35:18.771 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:35:18.774 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:35:18.777 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:35:18.779 -05:00 [INF] User logged out.
2017-11-13 13:39:11.876 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:39:11.904 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:39:11.905 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:39:11.905 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:39:11.906 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:39:11.985 -05:00 [DBG] Starting token cleanup
2017-11-13 13:39:17.400 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:39:22.832 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 13:39:22.896 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:39:22.906 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:39:22.907 -05:00 [INF] User logged in.
2017-11-13 13:39:22.918 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:39:22.919 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:43:33.256 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:43:33.283 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:43:33.284 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:43:33.284 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:43:33.285 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:43:33.364 -05:00 [DBG] Starting token cleanup
2017-11-13 13:43:36.660 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:43:36.674 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:43:36.825 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:43:36.828 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:43:36.828 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:43:36.829 -05:00 [INF] User logged out.
2017-11-13 13:43:49.878 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:43:49.911 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:43:49.912 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:43:49.913 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:43:49.914 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:43:50.086 -05:00 [DBG] Starting token cleanup
2017-11-13 13:43:55.347 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:43:58.354 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 13:43:58.480 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:43:58.497 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:43:58.500 -05:00 [INF] User logged in.
2017-11-13 13:43:58.519 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:43:58.522 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:44:03.276 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:44:03.280 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:48:49.418 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:48:49.446 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:48:49.447 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:48:49.448 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:48:49.448 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:48:49.525 -05:00 [DBG] Starting token cleanup
2017-11-13 13:48:56.585 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:48:56.616 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:48:56.617 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:48:56.618 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:48:56.620 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:48:56.763 -05:00 [DBG] Starting token cleanup
2017-11-13 13:48:57.256 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:48:57.273 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:49:06.399 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T18:49:04.0122432+00:00"".
2017-11-13 13:49:45.429 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:49:45.433 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:49:48.078 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:49:48.082 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:49:48.084 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:49:48.087 -05:00 [INF] User logged out.
2017-11-13 13:49:52.949 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:49:52.982 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:49:55.775 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 13:49:55.894 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:49:55.902 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:49:55.905 -05:00 [INF] User logged in.
2017-11-13 13:49:55.918 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:49:55.920 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:02.784 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:02.787 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:39.231 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:50:39.260 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:50:39.261 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:50:39.262 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:50:39.262 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:50:39.410 -05:00 [DBG] Starting token cleanup
2017-11-13 13:50:39.557 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:39.573 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:44.362 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:44.366 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:46.914 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:50:46.917 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:51:48.614 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:51:48.643 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:51:48.645 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:51:48.645 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:51:48.646 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:51:48.793 -05:00 [DBG] Starting token cleanup
2017-11-13 13:51:48.980 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:51:48.996 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:51:53.892 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:51:53.895 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:54:24.496 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:54:24.500 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:54:24.503 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:54:25.098 -05:00 [INF] User logged out.
2017-11-13 13:56:12.610 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:56:12.643 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:56:12.644 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:56:12.645 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:56:12.646 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:56:12.810 -05:00 [DBG] Starting token cleanup
2017-11-13 13:56:16.168 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:16.186 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:22.943 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:22.967 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:26.931 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:26.934 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:56:41.138 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:56:41.143 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:56:41.146 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:56:41.653 -05:00 [INF] User logged out.
2017-11-13 13:57:33.995 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:57:34.022 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:57:34.024 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:57:34.025 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:57:34.025 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:57:34.119 -05:00 [DBG] Starting token cleanup
2017-11-13 13:57:36.128 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:57:40.856 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 13:57:40.916 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:57:40.926 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:57:40.927 -05:00 [INF] User logged in.
2017-11-13 13:57:40.938 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:40.939 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:43.036 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:43.038 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:45.443 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:45.444 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:57:45.470 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:57:45.471 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:57:45.472 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:57:45.473 -05:00 [INF] User logged out.
2017-11-13 13:58:11.936 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:58:14.326 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 13:58:14.341 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:58:30.534 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:58:30.540 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 13:58:30.548 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:58:30.557 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:58:30.558 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:58:30.559 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 13:58:30.565 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:58:30.567 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:58:50.984 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:58:50.986 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:58:50.989 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:58:50.991 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:58:50.992 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:58:50.993 -05:00 [INF] User logged out.
2017-11-13 13:59:26.296 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 13:59:26.323 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 13:59:26.325 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 13:59:26.325 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 13:59:26.326 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 13:59:26.402 -05:00 [DBG] Starting token cleanup
2017-11-13 13:59:27.961 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:31.676 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 13:59:32.094 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 13:59:32.107 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 13:59:32.219 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:32.277 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:59:32.284 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:59:32.285 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 13:59:32.294 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:32.296 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:35.423 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:35.424 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:37.487 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:37.488 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:37.518 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:59:37.520 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:37.520 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:59:37.521 -05:00 [INF] User logged out.
2017-11-13 13:59:43.249 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:59:43.255 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:47.512 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 13:59:47.715 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 13:59:47.721 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 13:59:47.727 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:47.730 -05:00 [DBG] Augmenting SignInContext
2017-11-13 13:59:47.731 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 13:59:47.732 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 13:59:47.739 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:47.741 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:48.598 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:48.600 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 13:59:48.602 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 13:59:48.603 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 13:59:48.604 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 13:59:48.605 -05:00 [INF] User logged out.
2017-11-13 13:59:52.721 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 13:59:52.728 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:00:01.952 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 14:00:01.983 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 14:00:01.984 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 14:00:01.985 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 14:00:01.986 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 14:00:02.140 -05:00 [DBG] Starting token cleanup
2017-11-13 14:00:04.236 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 14:00:04.685 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 14:00:04.736 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 14:00:04.915 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:00:05.029 -05:00 [DBG] Augmenting SignInContext
2017-11-13 14:00:05.043 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 14:00:05.046 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 14:00:05.061 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:00:05.064 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:00:23.864 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:00:23.868 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:02.580 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 14:18:02.607 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 14:18:02.607 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 14:18:02.608 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 14:18:02.609 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 14:18:02.688 -05:00 [DBG] Starting token cleanup
2017-11-13 14:18:07.137 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:07.151 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:12.418 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:12.419 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:15.087 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:15.088 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:15.168 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 14:18:15.170 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:18:15.170 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 14:18:15.171 -05:00 [INF] User logged out.
2017-11-13 14:18:25.775 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 14:18:25.787 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:18:29.472 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 14:18:29.932 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 14:18:29.944 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 14:18:29.986 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:18:30.060 -05:00 [DBG] Augmenting SignInContext
2017-11-13 14:18:30.064 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 14:18:30.065 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 14:18:30.072 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:30.074 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:41.328 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 14:18:41.357 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 14:18:41.358 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 14:18:41.358 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 14:18:41.359 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 14:18:41.521 -05:00 [DBG] Starting token cleanup
2017-11-13 14:18:46.822 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:18:46.838 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:19:52.196 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 14:19:52.223 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 14:19:52.224 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 14:19:52.225 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 14:19:52.225 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 14:19:52.303 -05:00 [DBG] Starting token cleanup
2017-11-13 14:19:55.742 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:19:55.757 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:19:59.712 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:19:59.715 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:01.371 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:01.372 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:01.452 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 14:20:01.455 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:20:01.456 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 14:20:01.457 -05:00 [INF] User logged out.
2017-11-13 14:20:03.328 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:20:09.601 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 14:20:09.618 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 14:20:56.791 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 14:20:56.796 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 14:20:56.808 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 14:20:56.811 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 14:20:56.868 -05:00 [DBG] Augmenting SignInContext
2017-11-13 14:20:56.873 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 14:20:56.874 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 14:20:56.881 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:56.882 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:58.828 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:20:58.830 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:00.836 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:00.838 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:00.839 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 14:21:00.840 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:21:00.841 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 14:21:00.842 -05:00 [INF] User logged out.
2017-11-13 14:21:02.325 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:21:04.208 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 14:21:04.721 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 14:21:04.737 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 14:21:04.773 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:21:04.779 -05:00 [DBG] Augmenting SignInContext
2017-11-13 14:21:04.781 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 14:21:04.782 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 14:21:04.788 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:04.789 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:05.756 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:05.757 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:05.759 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 14:21:05.760 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:21:05.761 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 14:21:05.762 -05:00 [INF] User logged out.
2017-11-13 14:21:39.501 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 14:21:41.508 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 14:21:41.514 -05:00 [DBG] Augmenting SignInContext
2017-11-13 14:21:41.516 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 14:21:41.518 -05:00 [INF] User logged in.
2017-11-13 14:21:41.525 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:41.527 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:42.916 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:42.918 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 14:21:42.919 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:09:05.558 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 16:09:05.586 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 16:09:05.588 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 16:09:05.588 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 16:09:05.589 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 16:09:05.661 -05:00 [DBG] Starting token cleanup
2017-11-13 16:16:26.766 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 16:16:26.779 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 16:16:26.780 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 16:16:26.784 -05:00 [DBG] Start discovery request
2017-11-13 16:16:27.017 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 16:16:27.258 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 16:16:27.260 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 16:16:27.262 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 16:16:27.267 -05:00 [DBG] Start key discovery request
2017-11-13 16:16:27.441 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:16:27.442 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:16:27.444 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:16:27.448 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:16:27.449 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:16:27.453 -05:00 [DBG] Start authorize request
2017-11-13 16:16:27.464 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:16:27.470 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:16:27.653 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:16:27.662 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:16:27.664 -05:00 [DBG] No PKCE used.
2017-11-13 16:16:27.702 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:16:27.810 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:16:27.822 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:16:27.828 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:16:27.836 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:16:27.849 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaN7ZciuRaPMlmBO7yLEJePGhpw-N17YPXVE1zIKdZFYSNSAjr-ZGC_iqjQuvURxnozLRbYR6pz0JOXPmczwsedqobXweUdUZfZG_SsRhLHCscH1FPF2IcCYy1p-WF57BNPVfco5_KP81q7PiPg_58C-TY4LeQlgT0yY3nR7g2BPP7NSEDW7-rBB9JBOAED7xEfcF7Lf_0IZPo2EXzkP0gWmcwOhV7s27M3qJHokjutvsfm-1uUhLvKChJmCsPAuXBrF_f8ER38CXdapyHWZ7gZ",
  "Nonce": "636462045873159153.NmJhNGIzMGYtZjFlMi00ZjgxLTllNTYtNjM4ZWRjOGJjOTkwM2MxNTYxZDYtOTNkYi00NjA2LWEzNjYtNTJlMDQ1M2QzNjIx",
  "SessionId": "f0e2c5d20b59f518d8ffdaa57d0f7c80",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462045873159153.NmJhNGIzMGYtZjFlMi00ZjgxLTllNTYtNjM4ZWRjOGJjOTkwM2MxNTYxZDYtOTNkYi00NjA2LWEzNjYtNTJlMDQ1M2QzNjIx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaN7ZciuRaPMlmBO7yLEJePGhpw-N17YPXVE1zIKdZFYSNSAjr-ZGC_iqjQuvURxnozLRbYR6pz0JOXPmczwsedqobXweUdUZfZG_SsRhLHCscH1FPF2IcCYy1p-WF57BNPVfco5_KP81q7PiPg_58C-TY4LeQlgT0yY3nR7g2BPP7NSEDW7-rBB9JBOAED7xEfcF7Lf_0IZPo2EXzkP0gWmcwOhV7s27M3qJHokjutvsfm-1uUhLvKChJmCsPAuXBrF_f8ER38CXdapyHWZ7gZ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:16:27.885 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:16:27.886 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:16:27.901 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:16:27.904 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:21.617 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 16:37:21.648 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 16:37:21.648 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 16:37:21.649 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 16:37:21.649 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 16:37:21.732 -05:00 [DBG] Starting token cleanup
2017-11-13 16:37:37.873 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:37.887 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:38.010 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:37:38.518 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:37:38.527 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:37:38.528 -05:00 [DBG] No PKCE used.
2017-11-13 16:37:38.579 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:38.794 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:38.806 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:38.811 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:38.820 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:37:38.827 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:37:38.832 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:38.893 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:46.710 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:46.712 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:46.742 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:37:46.749 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:37:46.750 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:37:46.751 -05:00 [DBG] No PKCE used.
2017-11-13 16:37:46.755 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:46.758 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:46.760 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:46.765 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:46.767 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:37:46.829 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:46.830 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:37:46.833 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:37:46.837 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:37:46.839 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:37:46.845 -05:00 [DBG] Start authorize callback request
2017-11-13 16:37:46.873 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:37:46.875 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:37:46.880 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:37:46.881 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:37:46.882 -05:00 [DBG] No PKCE used.
2017-11-13 16:37:46.884 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:46.889 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:46.891 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:37:46.894 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:37:46.895 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:37:46.915 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaN7ZciuRaPMlmBO7yLEJePGhpw-N17YPXVE1zIKdZFYSNSAjr-ZGC_iqjQuvURxnozLRbYR6pz0JOXPmczwsedqobXweUdUZfZG_SsRhLHCscH1FPF2IcCYy1p-WF57BNPVfco5_KP81q7PiPg_58C-TY4LeQlgT0yY3nR7g2BPP7NSEDW7-rBB9JBOAED7xEfcF7Lf_0IZPo2EXzkP0gWmcwOhV7s27M3qJHokjutvsfm-1uUhLvKChJmCsPAuXBrF_f8ER38CXdapyHWZ7gZ",
  "Nonce": "636462045873159153.NmJhNGIzMGYtZjFlMi00ZjgxLTllNTYtNjM4ZWRjOGJjOTkwM2MxNTYxZDYtOTNkYi00NjA2LWEzNjYtNTJlMDQ1M2QzNjIx",
  "SessionId": "f0e2c5d20b59f518d8ffdaa57d0f7c80",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462045873159153.NmJhNGIzMGYtZjFlMi00ZjgxLTllNTYtNjM4ZWRjOGJjOTkwM2MxNTYxZDYtOTNkYi00NjA2LWEzNjYtNTJlMDQ1M2QzNjIx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaN7ZciuRaPMlmBO7yLEJePGhpw-N17YPXVE1zIKdZFYSNSAjr-ZGC_iqjQuvURxnozLRbYR6pz0JOXPmczwsedqobXweUdUZfZG_SsRhLHCscH1FPF2IcCYy1p-WF57BNPVfco5_KP81q7PiPg_58C-TY4LeQlgT0yY3nR7g2BPP7NSEDW7-rBB9JBOAED7xEfcF7Lf_0IZPo2EXzkP0gWmcwOhV7s27M3qJHokjutvsfm-1uUhLvKChJmCsPAuXBrF_f8ER38CXdapyHWZ7gZ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:37:46.984 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:37:46.990 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:37:46.995 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:37:47.011 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:37:47.018 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:37:47.054 -05:00 [DBG] r4SFbnNtviz4nnLmTystwdt38eVEEafb9qHvhjPTmgg= not found in database
2017-11-13 16:37:47.097 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:37:47.106 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:37:47.110 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:37:47.152 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaN7ZciuRaPMlmBO7yLEJePGhpw-N17YPXVE1zIKdZFYSNSAjr-ZGC_iqjQuvURxnozLRbYR6pz0JOXPmczwsedqobXweUdUZfZG_SsRhLHCscH1FPF2IcCYy1p-WF57BNPVfco5_KP81q7PiPg_58C-TY4LeQlgT0yY3nR7g2BPP7NSEDW7-rBB9JBOAED7xEfcF7Lf_0IZPo2EXzkP0gWmcwOhV7s27M3qJHokjutvsfm-1uUhLvKChJmCsPAuXBrF_f8ER38CXdapyHWZ7gZ",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:37:47.176 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:37:47.183 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:38:19.802 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 16:38:19.806 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 16:38:19.808 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 16:38:19.812 -05:00 [DBG] Start discovery request
2017-11-13 16:38:19.879 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 16:38:20.050 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 16:38:20.052 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 16:38:20.054 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 16:38:20.059 -05:00 [DBG] Start key discovery request
2017-11-13 16:38:20.102 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:20.103 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:20.104 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:38:20.106 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:38:20.108 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:38:20.114 -05:00 [DBG] Start authorize request
2017-11-13 16:38:20.115 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:38:20.116 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:38:20.143 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:20.145 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:38:20.146 -05:00 [DBG] No PKCE used.
2017-11-13 16:38:20.154 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:20.227 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:20.233 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:20.254 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:20.256 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:38:20.258 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbeweXf8GT98mKMFWzVU60h3jfh8EVw4EXEmzFi3FKJ20IPXEDKq17PwQZKviQ5BUllg59AkU3SGgBQIVAuf_G6x9g6BxOIFQep4hFqiw1zOqgBtX89wlvt9J_JIbUpbsz-gQJt6Of5FcwA-C35pPQ6tO_k_psTbTXA0ibROzmqSGtGRVLWZP5phIdj3ym8GCxQs6IuQewDondPy7dsWcGcmdoP62b1HfSYzyGFdKyLw1puoNvM1zB9O3qxUJL9Bp8P568NiUL3_Y-FVOxICu2I",
  "Nonce": "636462059000927844.ZjQxNmVhMTktZTAzZi00NzdkLTk5NjItNDczOWZkYjdiOGI0ODlmMTE1MGYtMjYzNy00NzczLThlMDgtOGRjN2IyMzIxMDg5",
  "SessionId": "f0e2c5d20b59f518d8ffdaa57d0f7c80",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462059000927844.ZjQxNmVhMTktZTAzZi00NzdkLTk5NjItNDczOWZkYjdiOGI0ODlmMTE1MGYtMjYzNy00NzczLThlMDgtOGRjN2IyMzIxMDg5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbeweXf8GT98mKMFWzVU60h3jfh8EVw4EXEmzFi3FKJ20IPXEDKq17PwQZKviQ5BUllg59AkU3SGgBQIVAuf_G6x9g6BxOIFQep4hFqiw1zOqgBtX89wlvt9J_JIbUpbsz-gQJt6Of5FcwA-C35pPQ6tO_k_psTbTXA0ibROzmqSGtGRVLWZP5phIdj3ym8GCxQs6IuQewDondPy7dsWcGcmdoP62b1HfSYzyGFdKyLw1puoNvM1zB9O3qxUJL9Bp8P568NiUL3_Y-FVOxICu2I",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:38:20.272 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:38:20.274 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:38:20.284 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:20.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:20.288 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:38:20.315 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:20.317 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:38:20.318 -05:00 [DBG] No PKCE used.
2017-11-13 16:38:20.326 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:20.404 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:20.412 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:20.481 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:20.482 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:38:20.503 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:20.510 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:20.584 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:22.831 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:22.833 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:22.836 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:38:22.857 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:22.859 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:38:22.859 -05:00 [DBG] No PKCE used.
2017-11-13 16:38:22.865 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:22.929 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:22.932 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:22.935 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:22.937 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:38:22.945 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:22.946 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:38:22.948 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:38:22.950 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:38:22.952 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:38:22.954 -05:00 [DBG] Start authorize callback request
2017-11-13 16:38:22.955 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:38:22.957 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:38:22.963 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:22.965 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:38:22.966 -05:00 [DBG] No PKCE used.
2017-11-13 16:38:22.968 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:22.973 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:22.976 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:22.980 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:22.981 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:38:22.983 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbeweXf8GT98mKMFWzVU60h3jfh8EVw4EXEmzFi3FKJ20IPXEDKq17PwQZKviQ5BUllg59AkU3SGgBQIVAuf_G6x9g6BxOIFQep4hFqiw1zOqgBtX89wlvt9J_JIbUpbsz-gQJt6Of5FcwA-C35pPQ6tO_k_psTbTXA0ibROzmqSGtGRVLWZP5phIdj3ym8GCxQs6IuQewDondPy7dsWcGcmdoP62b1HfSYzyGFdKyLw1puoNvM1zB9O3qxUJL9Bp8P568NiUL3_Y-FVOxICu2I",
  "Nonce": "636462059000927844.ZjQxNmVhMTktZTAzZi00NzdkLTk5NjItNDczOWZkYjdiOGI0ODlmMTE1MGYtMjYzNy00NzczLThlMDgtOGRjN2IyMzIxMDg5",
  "SessionId": "f0e2c5d20b59f518d8ffdaa57d0f7c80",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462059000927844.ZjQxNmVhMTktZTAzZi00NzdkLTk5NjItNDczOWZkYjdiOGI0ODlmMTE1MGYtMjYzNy00NzczLThlMDgtOGRjN2IyMzIxMDg5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbeweXf8GT98mKMFWzVU60h3jfh8EVw4EXEmzFi3FKJ20IPXEDKq17PwQZKviQ5BUllg59AkU3SGgBQIVAuf_G6x9g6BxOIFQep4hFqiw1zOqgBtX89wlvt9J_JIbUpbsz-gQJt6Of5FcwA-C35pPQ6tO_k_psTbTXA0ibROzmqSGtGRVLWZP5phIdj3ym8GCxQs6IuQewDondPy7dsWcGcmdoP62b1HfSYzyGFdKyLw1puoNvM1zB9O3qxUJL9Bp8P568NiUL3_Y-FVOxICu2I",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:38:23.000 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:38:23.001 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:38:23.004 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:38:23.008 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:38:23.009 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:38:23.024 -05:00 [DBG] iOqoTzSIbJfQJBmFQM0+ImJETHiGD0rQO4EiKju8mF0= not found in database
2017-11-13 16:38:23.028 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:38:23.029 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:38:23.030 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:38:23.035 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbeweXf8GT98mKMFWzVU60h3jfh8EVw4EXEmzFi3FKJ20IPXEDKq17PwQZKviQ5BUllg59AkU3SGgBQIVAuf_G6x9g6BxOIFQep4hFqiw1zOqgBtX89wlvt9J_JIbUpbsz-gQJt6Of5FcwA-C35pPQ6tO_k_psTbTXA0ibROzmqSGtGRVLWZP5phIdj3ym8GCxQs6IuQewDondPy7dsWcGcmdoP62b1HfSYzyGFdKyLw1puoNvM1zB9O3qxUJL9Bp8P568NiUL3_Y-FVOxICu2I",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:38:23.338 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:38:23.344 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:38:23.345 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:38:23.355 -05:00 [DBG] Start token request.
2017-11-13 16:38:23.364 -05:00 [DBG] Start client validation
2017-11-13 16:38:23.370 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:38:23.375 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:38:23.376 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:38:23.377 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:38:23.415 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:23.425 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:38:23.427 -05:00 [DBG] Client validation success
2017-11-13 16:38:23.433 -05:00 [DBG] Start token request validation
2017-11-13 16:38:23.443 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:38:23.458 -05:00 [DBG] iOqoTzSIbJfQJBmFQM0+ImJETHiGD0rQO4EiKju8mF0= found in database: true
2017-11-13 16:38:23.476 -05:00 [DBG] removing iOqoTzSIbJfQJBmFQM0+ImJETHiGD0rQO4EiKju8mF0= persisted grant from database
2017-11-13 16:38:23.567 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:38:23.573 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "509ad79f44ecd06e88906f9dec953a6f7442bedd073cf2e315d39bcc13ed86d7",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "509ad79f44ecd06e88906f9dec953a6f7442bedd073cf2e315d39bcc13ed86d7",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:38:23.616 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:23.624 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:23.703 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:23.717 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:38:23.718 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:38:23.804 -05:00 [DBG] Creating refresh token
2017-11-13 16:38:23.805 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:38:23.821 -05:00 [DBG] Na8/G3vm/K+94SQEiWF14DG0rD6y2uBwmoBf361HrE0= not found in database
2017-11-13 16:38:23.869 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:23.875 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:23.943 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:38:23.945 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:38:23.946 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:38:23.952 -05:00 [DBG] Token request success.
2017-11-13 16:38:23.963 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:38:23.965 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:38:23.966 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:38:23.973 -05:00 [DBG] Start userinfo request
2017-11-13 16:38:23.977 -05:00 [DBG] Bearer token found in header
2017-11-13 16:38:24.024 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:24.054 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:38:24.059 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609103,
    "exp": 1510612703,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510600901,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:38:24.072 -05:00 [DBG] Creating userinfo response
2017-11-13 16:38:24.076 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:38:24.087 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:38:24.089 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:38:24.096 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:38:24.098 -05:00 [DBG] End userinfo request
2017-11-13 16:40:19.774 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 16:40:19.776 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 16:40:19.778 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 16:40:19.779 -05:00 [DBG] Start discovery request
2017-11-13 16:40:19.796 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 16:40:19.958 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 16:40:19.960 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 16:40:19.962 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 16:40:19.964 -05:00 [DBG] Start key discovery request
2017-11-13 16:41:18.957 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 16:41:18.959 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 16:41:18.961 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 16:41:18.962 -05:00 [DBG] Start discovery request
2017-11-13 16:41:18.977 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 16:41:19.141 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 16:41:19.143 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 16:41:19.144 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 16:41:19.145 -05:00 [DBG] Start key discovery request
2017-11-13 16:41:19.174 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:41:19.176 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:41:19.177 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:41:19.179 -05:00 [DBG] Start authorize request
2017-11-13 16:41:19.179 -05:00 [DBG] No user present in authorize request
2017-11-13 16:41:19.180 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:41:19.205 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:19.207 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:41:19.208 -05:00 [DBG] No PKCE used.
2017-11-13 16:41:19.214 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:19.283 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:19.290 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:19.357 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:19.359 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:41:19.360 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
  "Nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:41:19.369 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:41:19.389 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:41:26.685 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 16:41:26.703 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:41:44.968 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:41:44.974 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:41:44.982 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:41:44.993 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:41:44.995 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:41:44.996 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 16:41:45.003 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:45.005 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:45.006 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:41:45.007 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:41:45.008 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:41:45.009 -05:00 [DBG] Start authorize callback request
2017-11-13 16:41:45.010 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:41:45.011 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:41:45.034 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:45.036 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:41:45.037 -05:00 [DBG] No PKCE used.
2017-11-13 16:41:45.043 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:45.108 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:45.115 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:45.178 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:45.179 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:41:45.180 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
  "Nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:41:45.193 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:41:45.194 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:41:45.201 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:45.202 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:45.204 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:41:45.226 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:45.227 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:41:45.229 -05:00 [DBG] No PKCE used.
2017-11-13 16:41:45.237 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:45.319 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:45.327 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:45.402 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:45.404 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:41:45.425 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:45.431 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:45.500 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:48.398 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:48.399 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:48.401 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:41:48.422 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:48.423 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:41:48.424 -05:00 [DBG] No PKCE used.
2017-11-13 16:41:48.430 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:48.491 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:48.494 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:48.498 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:48.499 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:41:48.505 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:48.507 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:41:48.508 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:41:48.509 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:41:48.510 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:41:48.511 -05:00 [DBG] Start authorize callback request
2017-11-13 16:41:48.512 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:41:48.512 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:41:48.517 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:48.518 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:41:48.519 -05:00 [DBG] No PKCE used.
2017-11-13 16:41:48.521 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:48.525 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:48.527 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:48.530 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:48.531 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:41:48.532 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
  "Nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:41:48.544 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:41:48.546 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:41:48.547 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:41:48.551 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:41:48.551 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:41:48.561 -05:00 [DBG] icSQh2ICUzwGhWcqhCyvStdCxni+4EVo7qkalm4Z7Tw= not found in database
2017-11-13 16:41:48.566 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:41:48.567 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:41:48.568 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:41:48.573 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiXlcYe23xGCinMlFiPgciEkpXXnYYE5u_kYyG-Zh4xvreuR75EQKRAPMEi9mq6n4Vub9QO1_W7HKzaA56OUMUQUdza9TwTjbL7i7dpA7bMiQol-MqNjF-2uw3za4CsydLnV8C5ihhYeJBcLgP90slqAP-cnxDikERDFU6hWUkBW1BJMgc9Bev4CRwepYuI5EGqBPin9CtZjIefVwR-W396r8aXSG1FFixhXAd7bj0risV_d5tddnVnbolY9mWhnX14u6UT_drlKOLbGRpglWF",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:41:48.577 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:41:48.578 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:41:48.861 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:41:48.863 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:41:48.864 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:41:48.868 -05:00 [DBG] Start token request.
2017-11-13 16:41:48.871 -05:00 [DBG] Start client validation
2017-11-13 16:41:48.872 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:41:48.873 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:41:48.874 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:41:48.876 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:41:48.932 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:48.933 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:41:48.934 -05:00 [DBG] Client validation success
2017-11-13 16:41:48.936 -05:00 [DBG] Start token request validation
2017-11-13 16:41:48.937 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:41:48.942 -05:00 [DBG] icSQh2ICUzwGhWcqhCyvStdCxni+4EVo7qkalm4Z7Tw= found in database: true
2017-11-13 16:41:48.963 -05:00 [DBG] removing icSQh2ICUzwGhWcqhCyvStdCxni+4EVo7qkalm4Z7Tw= persisted grant from database
2017-11-13 16:41:49.054 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:41:49.055 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "1dab7006f8dcd71adcd634f75fb0744cae6f408f4254abbb23cff03da6e20346",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "1dab7006f8dcd71adcd634f75fb0744cae6f408f4254abbb23cff03da6e20346",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:41:49.076 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:49.082 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:49.145 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:49.146 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:41:49.147 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:41:49.158 -05:00 [DBG] Creating refresh token
2017-11-13 16:41:49.159 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:41:49.168 -05:00 [DBG] m9n2stJmj9hgPX9zXXC5oOVpkv4yE9qC57lcn4FsQow= not found in database
2017-11-13 16:41:49.203 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:49.209 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:49.281 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:41:49.283 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:41:49.284 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:41:49.288 -05:00 [DBG] Token request success.
2017-11-13 16:41:49.295 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:41:49.297 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:41:49.298 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:41:49.300 -05:00 [DBG] Start userinfo request
2017-11-13 16:41:49.301 -05:00 [DBG] Bearer token found in header
2017-11-13 16:41:49.329 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:49.338 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:41:49.339 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609309,
    "exp": 1510612909,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:41:49.346 -05:00 [DBG] Creating userinfo response
2017-11-13 16:41:49.347 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:41:49.355 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:41:49.357 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:41:49.366 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:41:49.367 -05:00 [DBG] End userinfo request
2017-11-13 16:42:21.332 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:21.334 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:23.467 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:23.469 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:40.817 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:40.819 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:48.997 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:48.999 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:50.752 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:50.754 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:52.200 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:52.201 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:56.508 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:56.510 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:57.522 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:57.523 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:58.226 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:42:58.227 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:43:48.909 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 16:43:48.910 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 16:43:48.911 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 16:43:48.913 -05:00 [DBG] Start discovery request
2017-11-13 16:43:48.928 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 16:43:49.076 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 16:43:49.077 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 16:43:49.078 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 16:43:49.080 -05:00 [DBG] Start key discovery request
2017-11-13 16:43:49.107 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:43:49.108 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:43:49.109 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:43:49.111 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:43:49.112 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:43:49.118 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:43:49.124 -05:00 [DBG] Start end session request validation
2017-11-13 16:43:49.131 -05:00 [DBG] Start identity token validation
2017-11-13 16:43:49.152 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:43:49.154 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:43:49.157 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:43:49.164 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510609309,
    "exp": 1510609609,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462060791656941.ZmZhNGNkYjQtNWYzYi00ZDg3LWI3YmEtNDk0NzQ5ZWY0NTgyYWIxMWZmOTMtMGM2NC00YjY0LWI0YjctNWRlZjZkZGIwNGIz",
    "iat": 1510609309,
    "at_hash": "aOsEgwsOHjCDsJ1yHYvzkA",
    "sid": "464c4b33795421baddcafeceea2ee11b",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:43:49.173 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbzhtqDgZz9y6nLQ7pDmIB2myxD6LocYiu0INAE0LFpFIpelJCZT5dtHKGPURcdkz56GmnIshDxerjFIQdQDMcO_tdFgbtVmGpNm_yumnsm4paUhYW3ept3HLgU8LyGNY_-iWQAWq94HLg6CgPt96Vj",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MDkzMDksImV4cCI6MTUxMDYwOTYwOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDYwNzkxNjU2OTQxLlptWmhOR05rWWpRdE5XWXpZaTAwWkRnM0xXSTNZbUV0TkRrME56UTVaV1kwTlRneVlXSXhNV1ptT1RNdE1HTTJOQzAwWWpZMExXSTBZamN0TldSbFpqWmtaR0l3TkdJeiIsImlhdCI6MTUxMDYwOTMwOSwiYXRfaGFzaCI6ImFPc0Vnd3NPSGpDRHNKMXlIWXZ6a0EiLCJzaWQiOiI0NjRjNGIzMzc5NTQyMWJhZGRjYWZlY2VlYTJlZTExYiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYwOTMwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.YI6U6_m0SkUei21cWCKsCBcLxfENuXcG86p8NSuNdRlUD7VIHKGWj3ffIQzFN-NPpBc0fhPYBu3Qxthp_EvirT_CEAonGSJ31YzSu41G_kPIfEy6k4N9O-LBJxmL2HlGFaga8VHYuNosujAaGeJhb-QWYqxmwHCefv2fYBY0NXgYO2u745TYSDkJI09RPLMsBkuXRjA_jY8sOgluUUeXsHXM_wzCkJNQmzhsAJ8tE0JPMquahK9m3nfhBHzLSMFKwfS97SvRckilNHiErAJhmYjKn5Oc2QgGMF5AsRWf8qPrpdRsFTSOWKeLMSJQq5RVMnVhNfcJBA-B4LDucLZwqg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbzhtqDgZz9y6nLQ7pDmIB2myxD6LocYiu0INAE0LFpFIpelJCZT5dtHKGPURcdkz56GmnIshDxerjFIQdQDMcO_tdFgbtVmGpNm_yumnsm4paUhYW3ept3HLgU8LyGNY_-iWQAWq94HLg6CgPt96Vj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:43:49.183 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:43:49.201 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:43:49.202 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:10.230 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 16:44:10.259 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 16:44:10.260 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 16:44:10.261 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 16:44:10.261 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 16:44:10.418 -05:00 [DBG] Starting token cleanup
2017-11-13 16:44:14.594 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:14.613 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:14.620 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:44:14.628 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:44:14.630 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:44:14.638 -05:00 [DBG] Start authorize request
2017-11-13 16:44:14.654 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:14.665 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:15.590 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:15.599 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:15.600 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:15.723 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:16.118 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:16.166 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:16.335 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:16.344 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:16.408 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiMQhkxNEDb8puh-554vxUkS9yRRaxcyjSogFlyIItW1Pn-j4XAbBPXNe1NREn2Vby1oYOTu3nFAxLX01xfuvewGPaTfeV9KRoHwTM9ZOJzDuvO314hsMANMhzgpqv42FfWKJpMGMtUSU_zwCtRO_ADRYlk32jKoz9UtgfFpfx3MYDRgrxb76-cM8BVQeVrBVF4F0E-DWD_q4YPd6Kdu_ebSUkbgvBK39J3pxqK3h1PRSoBg7L8UUxtHFpgs5yZEglf3ufUoDlEZmrtj2wgsBR",
  "Nonce": "636462062544289709.N2EwMzQzOWMtODQwZC00ZDY1LTg0MzItNmU2ZDVkY2E0NGE3NzViODA5MGUtN2FkZC00MWE5LWIyMDktYzM0OTExMzBhNmU1",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462062544289709.N2EwMzQzOWMtODQwZC00ZDY1LTg0MzItNmU2ZDVkY2E0NGE3NzViODA5MGUtN2FkZC00MWE5LWIyMDktYzM0OTExMzBhNmU1",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaiMQhkxNEDb8puh-554vxUkS9yRRaxcyjSogFlyIItW1Pn-j4XAbBPXNe1NREn2Vby1oYOTu3nFAxLX01xfuvewGPaTfeV9KRoHwTM9ZOJzDuvO314hsMANMhzgpqv42FfWKJpMGMtUSU_zwCtRO_ADRYlk32jKoz9UtgfFpfx3MYDRgrxb76-cM8BVQeVrBVF4F0E-DWD_q4YPd6Kdu_ebSUkbgvBK39J3pxqK3h1PRSoBg7L8UUxtHFpgs5yZEglf3ufUoDlEZmrtj2wgsBR",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:16.539 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:44:16.540 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:44:16.582 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:16.586 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:16.859 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:17.348 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:17.350 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:17.352 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:17.453 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:17.759 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:17.872 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:18.153 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:18.154 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:18.608 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:18.689 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:18.986 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:26.700 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:26.704 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:26.763 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:27.012 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:27.013 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:27.014 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:27.062 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:27.245 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:27.288 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:27.459 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:27.461 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:27.498 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:27.501 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:27.503 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:44:27.507 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:44:27.509 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:44:27.517 -05:00 [DBG] Start authorize callback request
2017-11-13 16:44:27.541 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:27.542 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:27.724 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:27.725 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:27.727 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:27.766 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:27.933 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:27.973 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:28.110 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:28.112 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:28.114 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiMQhkxNEDb8puh-554vxUkS9yRRaxcyjSogFlyIItW1Pn-j4XAbBPXNe1NREn2Vby1oYOTu3nFAxLX01xfuvewGPaTfeV9KRoHwTM9ZOJzDuvO314hsMANMhzgpqv42FfWKJpMGMtUSU_zwCtRO_ADRYlk32jKoz9UtgfFpfx3MYDRgrxb76-cM8BVQeVrBVF4F0E-DWD_q4YPd6Kdu_ebSUkbgvBK39J3pxqK3h1PRSoBg7L8UUxtHFpgs5yZEglf3ufUoDlEZmrtj2wgsBR",
  "Nonce": "636462062544289709.N2EwMzQzOWMtODQwZC00ZDY1LTg0MzItNmU2ZDVkY2E0NGE3NzViODA5MGUtN2FkZC00MWE5LWIyMDktYzM0OTExMzBhNmU1",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462062544289709.N2EwMzQzOWMtODQwZC00ZDY1LTg0MzItNmU2ZDVkY2E0NGE3NzViODA5MGUtN2FkZC00MWE5LWIyMDktYzM0OTExMzBhNmU1",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaiMQhkxNEDb8puh-554vxUkS9yRRaxcyjSogFlyIItW1Pn-j4XAbBPXNe1NREn2Vby1oYOTu3nFAxLX01xfuvewGPaTfeV9KRoHwTM9ZOJzDuvO314hsMANMhzgpqv42FfWKJpMGMtUSU_zwCtRO_ADRYlk32jKoz9UtgfFpfx3MYDRgrxb76-cM8BVQeVrBVF4F0E-DWD_q4YPd6Kdu_ebSUkbgvBK39J3pxqK3h1PRSoBg7L8UUxtHFpgs5yZEglf3ufUoDlEZmrtj2wgsBR",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:28.153 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:44:28.159 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:44:28.166 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:28.235 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:44:28.242 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:44:28.327 -05:00 [DBG] OaGlSU0T1FuM9sFImSM7jxCYIhrdvZpTWFxswhg1ZKc= not found in database
2017-11-13 16:44:28.420 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:44:28.433 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:44:28.437 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:44:28.507 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaiMQhkxNEDb8puh-554vxUkS9yRRaxcyjSogFlyIItW1Pn-j4XAbBPXNe1NREn2Vby1oYOTu3nFAxLX01xfuvewGPaTfeV9KRoHwTM9ZOJzDuvO314hsMANMhzgpqv42FfWKJpMGMtUSU_zwCtRO_ADRYlk32jKoz9UtgfFpfx3MYDRgrxb76-cM8BVQeVrBVF4F0E-DWD_q4YPd6Kdu_ebSUkbgvBK39J3pxqK3h1PRSoBg7L8UUxtHFpgs5yZEglf3ufUoDlEZmrtj2wgsBR",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:44:28.840 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:44:28.851 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:44:28.853 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:44:28.871 -05:00 [DBG] Start token request.
2017-11-13 16:44:28.890 -05:00 [DBG] Start client validation
2017-11-13 16:44:28.911 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:44:28.920 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:44:28.924 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:44:28.925 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:44:29.139 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:29.148 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:44:29.149 -05:00 [DBG] Client validation success
2017-11-13 16:44:29.155 -05:00 [DBG] Start token request validation
2017-11-13 16:44:29.166 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:44:29.198 -05:00 [DBG] OaGlSU0T1FuM9sFImSM7jxCYIhrdvZpTWFxswhg1ZKc= found in database: true
2017-11-13 16:44:29.240 -05:00 [DBG] removing OaGlSU0T1FuM9sFImSM7jxCYIhrdvZpTWFxswhg1ZKc= persisted grant from database
2017-11-13 16:44:29.377 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:44:29.385 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "46eb636be69a982182b861cfd67297323b9ac47802fd8e8569075f22002b8351",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "46eb636be69a982182b861cfd67297323b9ac47802fd8e8569075f22002b8351",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:44:29.789 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:29.904 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:30.275 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:30.285 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:44:30.287 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:30.431 -05:00 [DBG] Creating refresh token
2017-11-13 16:44:30.432 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:44:30.500 -05:00 [DBG] 8EP3KCjb0Gr1A/g4VXqNjHHWqxP6VCbq+KMe8a//Fzo= not found in database
2017-11-13 16:44:30.871 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:30.928 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:31.139 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:31.141 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:44:31.142 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:44:31.149 -05:00 [DBG] Token request success.
2017-11-13 16:44:31.167 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:44:31.170 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:44:31.172 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:44:31.186 -05:00 [DBG] Start userinfo request
2017-11-13 16:44:31.190 -05:00 [DBG] Bearer token found in header
2017-11-13 16:44:31.434 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:31.755 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:31.760 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609470,
    "exp": 1510613070,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:44:31.779 -05:00 [DBG] Creating userinfo response
2017-11-13 16:44:31.784 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:44:31.847 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:31.849 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:44:31.914 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:44:31.918 -05:00 [DBG] End userinfo request
2017-11-13 16:44:37.868 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:37.871 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:37.875 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:44:37.878 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:44:37.881 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:44:37.890 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:37.897 -05:00 [DBG] Start end session request validation
2017-11-13 16:44:37.902 -05:00 [DBG] Start identity token validation
2017-11-13 16:44:38.099 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:38.100 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:44:38.104 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:44:38.131 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510609471,
    "exp": 1510609771,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462062544289709.N2EwMzQzOWMtODQwZC00ZDY1LTg0MzItNmU2ZDVkY2E0NGE3NzViODA5MGUtN2FkZC00MWE5LWIyMDktYzM0OTExMzBhNmU1",
    "iat": 1510609471,
    "at_hash": "fJXVTEyZiEmyM9uEaqPBmA",
    "sid": "464c4b33795421baddcafeceea2ee11b",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:44:38.141 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbU6orOtXLLpaeHPXTiEUGJWnG6ciVgEG3qQcL76xS7UB7UKKoe0cfWhUKxJl3PG7d7Qnu8805OhxCUFTdA6BTt9bCczMDEI68i-5yewgWLWv0ywalE3KABDnZ2xKAxy3-cDMNraXlbyimMkNUaLGqH",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MDk0NzEsImV4cCI6MTUxMDYwOTc3MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDYyNTQ0Mjg5NzA5Lk4yRXdNelF6T1dNdE9EUXdaQzAwWkRZMUxUZzBNekl0Tm1VMlpEVmtZMkUwTkdFM056VmlPREE1TUdVdE4yRmtaQzAwTVdFNUxXSXlNRGt0WXpNME9URXhNekJoTm1VMSIsImlhdCI6MTUxMDYwOTQ3MSwiYXRfaGFzaCI6ImZKWFZURXlaaUVteU05dUVhcVBCbUEiLCJzaWQiOiI0NjRjNGIzMzc5NTQyMWJhZGRjYWZlY2VlYTJlZTExYiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYwOTMwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.jo1IHWhBpls9RbhDaa8te2apQq1zF8iG3YymgaPtFsJYaKKQzuosE-tnjTvyxxgAHJMcU10f5sMoYQbi5YhE8bK6Wey5xSw6Of0_JjlV61-_cyHoCLmSwAATwISqMKCs8EO2Joh8aGIZRzSopzzAsvfzTsoWyRqUyw_H9svmhysaGflXqEH8uVW_Zsj4J0zqnC_JIXyEwaP3KltwvWxGDtIbBt11-O01M2NpLm1B7ExbTR7pjct4aCOi9aIvwzKLBxg8SnbBy8BNbRyfBiNAfhia4B7VouLSOsR5gTkMKCRVWfwFjhbtqqYgsUp-dkYSPc6-9IBSzXPpa1eaxRDahg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbU6orOtXLLpaeHPXTiEUGJWnG6ciVgEG3qQcL76xS7UB7UKKoe0cfWhUKxJl3PG7d7Qnu8805OhxCUFTdA6BTt9bCczMDEI68i-5yewgWLWv0ywalE3KABDnZ2xKAxy3-cDMNraXlbyimMkNUaLGqH",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:38.152 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:44:38.170 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:38.172 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:47.462 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:47.464 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:47.466 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:44:47.468 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:44:47.469 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:44:47.472 -05:00 [DBG] Start authorize request
2017-11-13 16:44:47.473 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:47.474 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:47.658 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:47.660 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:47.661 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:47.698 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:47.858 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:47.903 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:48.072 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:48.074 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:48.076 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaqr7AEEmZoVN5hZyJeJoCnka8Ltr3TKEREVCibXHi9EaaE4z4pKN1fFJkhro61d3zhAktjOQKA5gncJsMZdZ4IdtUAlJWoBn2YrcAUCksOgS-nJ8dZVTtKzO2VYTyT4zF9ZnK1WFz1fdJEZDHVZSNj_Pg0wjRTtcDMGG62kDvgt2Ur3NRWkxXtz52GNaeZFo6FVaFHtKhn5QXzO0tiTR_C0GUe_6lWn11NhaAFzxF19I8vOwOukF4PSMKxGwjUUzI7GYjQ9mDxWROApEv04U-C",
  "Nonce": "636462062874513723.NzFlZDk3NmYtZDZkOC00MzZjLTkyYzAtNmRkMTQ0NDZmMGU3Yjg4MGEyNTktZjk1OS00MTEzLWJkNmMtNTViYzQ3ZTQ4MjBj",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462062874513723.NzFlZDk3NmYtZDZkOC00MzZjLTkyYzAtNmRkMTQ0NDZmMGU3Yjg4MGEyNTktZjk1OS00MTEzLWJkNmMtNTViYzQ3ZTQ4MjBj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vaqr7AEEmZoVN5hZyJeJoCnka8Ltr3TKEREVCibXHi9EaaE4z4pKN1fFJkhro61d3zhAktjOQKA5gncJsMZdZ4IdtUAlJWoBn2YrcAUCksOgS-nJ8dZVTtKzO2VYTyT4zF9ZnK1WFz1fdJEZDHVZSNj_Pg0wjRTtcDMGG62kDvgt2Ur3NRWkxXtz52GNaeZFo6FVaFHtKhn5QXzO0tiTR_C0GUe_6lWn11NhaAFzxF19I8vOwOukF4PSMKxGwjUUzI7GYjQ9mDxWROApEv04U-C",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:48.114 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:44:48.115 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:44:48.126 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:48.130 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:48.150 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:48.403 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:48.404 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:48.405 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:48.463 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:48.669 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:48.724 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:48.925 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:48.927 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:49.173 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:49.219 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:49.404 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:51.711 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:51.714 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:51.737 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:52.003 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:52.005 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:52.006 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:52.054 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:52.234 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:52.281 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:52.480 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:52.482 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:52.493 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:52.497 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:52.500 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:44:52.501 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:44:52.503 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:44:52.506 -05:00 [DBG] Start authorize callback request
2017-11-13 16:44:52.508 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:52.509 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:44:52.711 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:52.712 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:44:52.713 -05:00 [DBG] No PKCE used.
2017-11-13 16:44:52.750 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:52.930 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:52.969 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:53.117 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:53.118 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:44:53.119 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaqr7AEEmZoVN5hZyJeJoCnka8Ltr3TKEREVCibXHi9EaaE4z4pKN1fFJkhro61d3zhAktjOQKA5gncJsMZdZ4IdtUAlJWoBn2YrcAUCksOgS-nJ8dZVTtKzO2VYTyT4zF9ZnK1WFz1fdJEZDHVZSNj_Pg0wjRTtcDMGG62kDvgt2Ur3NRWkxXtz52GNaeZFo6FVaFHtKhn5QXzO0tiTR_C0GUe_6lWn11NhaAFzxF19I8vOwOukF4PSMKxGwjUUzI7GYjQ9mDxWROApEv04U-C",
  "Nonce": "636462062874513723.NzFlZDk3NmYtZDZkOC00MzZjLTkyYzAtNmRkMTQ0NDZmMGU3Yjg4MGEyNTktZjk1OS00MTEzLWJkNmMtNTViYzQ3ZTQ4MjBj",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462062874513723.NzFlZDk3NmYtZDZkOC00MzZjLTkyYzAtNmRkMTQ0NDZmMGU3Yjg4MGEyNTktZjk1OS00MTEzLWJkNmMtNTViYzQ3ZTQ4MjBj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vaqr7AEEmZoVN5hZyJeJoCnka8Ltr3TKEREVCibXHi9EaaE4z4pKN1fFJkhro61d3zhAktjOQKA5gncJsMZdZ4IdtUAlJWoBn2YrcAUCksOgS-nJ8dZVTtKzO2VYTyT4zF9ZnK1WFz1fdJEZDHVZSNj_Pg0wjRTtcDMGG62kDvgt2Ur3NRWkxXtz52GNaeZFo6FVaFHtKhn5QXzO0tiTR_C0GUe_6lWn11NhaAFzxF19I8vOwOukF4PSMKxGwjUUzI7GYjQ9mDxWROApEv04U-C",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:53.154 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:44:53.155 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:44:53.159 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:53.188 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:44:53.189 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:44:53.231 -05:00 [DBG] LR8rom+HNWN5AQkjD0ll7YEgvEI4sNPqswxPINuL2n8= not found in database
2017-11-13 16:44:53.281 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:44:53.283 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:44:53.284 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:44:53.289 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaqr7AEEmZoVN5hZyJeJoCnka8Ltr3TKEREVCibXHi9EaaE4z4pKN1fFJkhro61d3zhAktjOQKA5gncJsMZdZ4IdtUAlJWoBn2YrcAUCksOgS-nJ8dZVTtKzO2VYTyT4zF9ZnK1WFz1fdJEZDHVZSNj_Pg0wjRTtcDMGG62kDvgt2Ur3NRWkxXtz52GNaeZFo6FVaFHtKhn5QXzO0tiTR_C0GUe_6lWn11NhaAFzxF19I8vOwOukF4PSMKxGwjUUzI7GYjQ9mDxWROApEv04U-C",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:44:53.553 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:44:53.555 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:44:53.556 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:44:53.559 -05:00 [DBG] Start token request.
2017-11-13 16:44:53.560 -05:00 [DBG] Start client validation
2017-11-13 16:44:53.562 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:44:53.563 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:44:53.564 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:44:53.565 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:44:53.773 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:53.774 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:44:53.775 -05:00 [DBG] Client validation success
2017-11-13 16:44:53.776 -05:00 [DBG] Start token request validation
2017-11-13 16:44:53.778 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:44:53.805 -05:00 [DBG] LR8rom+HNWN5AQkjD0ll7YEgvEI4sNPqswxPINuL2n8= found in database: true
2017-11-13 16:44:53.835 -05:00 [DBG] removing LR8rom+HNWN5AQkjD0ll7YEgvEI4sNPqswxPINuL2n8= persisted grant from database
2017-11-13 16:44:53.878 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:44:53.879 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "f370e4e0b05538d5ee01f0ad5eda84906f869d1aaf8e75398c0abbb0fb567ab2",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "f370e4e0b05538d5ee01f0ad5eda84906f869d1aaf8e75398c0abbb0fb567ab2",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:44:54.196 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:54.258 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:54.483 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:54.485 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:44:54.486 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:54.547 -05:00 [DBG] Creating refresh token
2017-11-13 16:44:54.548 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:44:54.586 -05:00 [DBG] /ahskjGPUF+4MFDBjA5644R/tfWEOzosNaYL2iWMtq4= not found in database
2017-11-13 16:44:54.946 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:55.011 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:55.219 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:44:55.220 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:44:55.221 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:44:55.226 -05:00 [DBG] Token request success.
2017-11-13 16:44:55.233 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:44:55.235 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:44:55.236 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:44:55.239 -05:00 [DBG] Start userinfo request
2017-11-13 16:44:55.240 -05:00 [DBG] Bearer token found in header
2017-11-13 16:44:55.669 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:55.980 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:55.981 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609494,
    "exp": 1510613094,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:44:55.988 -05:00 [DBG] Creating userinfo response
2017-11-13 16:44:55.989 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:44:56.045 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:44:56.047 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:44:56.106 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:44:56.109 -05:00 [DBG] End userinfo request
2017-11-13 16:44:57.494 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:57.497 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:57.499 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:44:57.500 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:44:57.502 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:44:57.506 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:44:57.508 -05:00 [DBG] Start end session request validation
2017-11-13 16:44:57.509 -05:00 [DBG] Start identity token validation
2017-11-13 16:44:57.696 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:44:57.697 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:44:57.700 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:44:57.726 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510609495,
    "exp": 1510609795,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462062874513723.NzFlZDk3NmYtZDZkOC00MzZjLTkyYzAtNmRkMTQ0NDZmMGU3Yjg4MGEyNTktZjk1OS00MTEzLWJkNmMtNTViYzQ3ZTQ4MjBj",
    "iat": 1510609495,
    "at_hash": "-RSL-1psiO5Wdv3rY-r_Wg",
    "sid": "464c4b33795421baddcafeceea2ee11b",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:44:57.733 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbwLmY2SmP12ibaR2Ji0ZX9pK7ZCYAN3vG4NETnIUYMTo1mUTRUEmgcE6cJQGbvyr-TOhKOZzewQIpYVbzw-4CCkawG2r3W_HVi2KLFEl5zyycp0XUmBRf27hlzgebOHhLUuM3K9DZsh6Fq21V8ACkW",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MDk0OTUsImV4cCI6MTUxMDYwOTc5NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDYyODc0NTEzNzIzLk56RmxaRGszTm1ZdFpEWmtPQzAwTXpaakxUa3lZekF0Tm1Sa01UUTBORFptTUdVM1lqZzRNR0V5TlRrdFpqazFPUzAwTVRFekxXSmtObU10TlRWaVl6UTNaVFE0TWpCaiIsImlhdCI6MTUxMDYwOTQ5NSwiYXRfaGFzaCI6Ii1SU0wtMXBzaU81V2R2M3JZLXJfV2ciLCJzaWQiOiI0NjRjNGIzMzc5NTQyMWJhZGRjYWZlY2VlYTJlZTExYiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYwOTMwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.gv6X9FzRW_M7jvTGtrDMjmG9CAg9kVBRaJ9nLK88zFgoCFYYRZKVPU61lK7VU7AmtO2x73-I-xl7H58_pUE8_l5_Di2_UxgYz_11oEc3bWGJrKQqGWE7_VYNWZU5iClBqIp7GIgXBDF3D1j7HBIHFq6tZ8lustlAppFnRTE2NQO4108-xYJAdQkFS2cLQTIrEHoLKeMae3rydpJXkMgv0Gnng77dFqx7rjKdf31MsMxBadKYHelQYai9dZdKT_uR6ng0rz_iCmG1bD2wW4XYaYkIo4kMxJd8hZOpa6rBu50lXPQhvXtTq6tMa_BSJ10grC1ajCuk20Zr_2UIumembg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbwLmY2SmP12ibaR2Ji0ZX9pK7ZCYAN3vG4NETnIUYMTo1mUTRUEmgcE6cJQGbvyr-TOhKOZzewQIpYVbzw-4CCkawG2r3W_HVi2KLFEl5zyycp0XUmBRf27hlzgebOHhLUuM3K9DZsh6Fq21V8ACkW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:44:57.745 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:44:57.755 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:44:57.757 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:45:38.449 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:45:38.452 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:09.261 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 16:52:09.288 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 16:52:09.289 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 16:52:09.290 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 16:52:09.290 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 16:52:09.372 -05:00 [DBG] Starting token cleanup
2017-11-13 16:52:13.753 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:13.768 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:13.773 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:52:13.780 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:52:13.781 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:52:13.785 -05:00 [DBG] Start authorize request
2017-11-13 16:52:13.796 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:13.801 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:14.314 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:14.324 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:14.326 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:14.374 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:14.577 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:14.590 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:14.593 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:14.601 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:14.657 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaAQ4K9ySUa0ZqpazSgHnlhi3zLllbaRepoHLoUzKK67GZCijwvqDHUaP5kLap0Sdu5t661JbUcMubPAGg0CtXLO11SOfllCOEx9kT8ARtBz2fU4ssJ-cgHnXNaZUWdFOPJ0yjQDRVijDtYM8P4CV-LKCpva8Niv16kE4mfzApH1YcK2TaGISvhxo2ArxkYVP8LS22t76zYgeAcB_1OHuWlY_vfwpuYgFHFzhIvxkj2DtE8oqaDw6JP_5H7b0UNrq4Va3E88NwzidJe-ua9XAfW",
  "Nonce": "636462067336542891.ZTM1NmNhNWUtNWZhMC00MzhmLWEwYzAtODk0NTM0YjkwNmU4ZjZkNGU1OWQtZTk1YS00ZDU3LWE0YjQtMzIyMjQxYWEyYmM0",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067336542891.ZTM1NmNhNWUtNWZhMC00MzhmLWEwYzAtODk0NTM0YjkwNmU4ZjZkNGU1OWQtZTk1YS00ZDU3LWE0YjQtMzIyMjQxYWEyYmM0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaAQ4K9ySUa0ZqpazSgHnlhi3zLllbaRepoHLoUzKK67GZCijwvqDHUaP5kLap0Sdu5t661JbUcMubPAGg0CtXLO11SOfllCOEx9kT8ARtBz2fU4ssJ-cgHnXNaZUWdFOPJ0yjQDRVijDtYM8P4CV-LKCpva8Niv16kE4mfzApH1YcK2TaGISvhxo2ArxkYVP8LS22t76zYgeAcB_1OHuWlY_vfwpuYgFHFzhIvxkj2DtE8oqaDw6JP_5H7b0UNrq4Va3E88NwzidJe-ua9XAfW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:14.731 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:52:14.733 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:52:14.748 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:14.750 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:14.863 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:14.870 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:14.871 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:14.871 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:14.874 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:14.878 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:14.880 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:14.884 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:14.885 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:14.890 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:14.896 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:14.957 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:25.561 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:25.563 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:25.595 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:25.601 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:25.603 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:25.603 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:25.606 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:25.610 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:25.612 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:25.616 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:25.617 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:25.642 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:25.643 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:25.645 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:52:25.647 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:52:25.648 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:52:25.654 -05:00 [DBG] Start authorize callback request
2017-11-13 16:52:25.677 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:25.678 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:25.683 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:25.683 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:25.684 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:25.686 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:25.690 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:25.693 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:25.697 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:25.698 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:25.699 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaAQ4K9ySUa0ZqpazSgHnlhi3zLllbaRepoHLoUzKK67GZCijwvqDHUaP5kLap0Sdu5t661JbUcMubPAGg0CtXLO11SOfllCOEx9kT8ARtBz2fU4ssJ-cgHnXNaZUWdFOPJ0yjQDRVijDtYM8P4CV-LKCpva8Niv16kE4mfzApH1YcK2TaGISvhxo2ArxkYVP8LS22t76zYgeAcB_1OHuWlY_vfwpuYgFHFzhIvxkj2DtE8oqaDw6JP_5H7b0UNrq4Va3E88NwzidJe-ua9XAfW",
  "Nonce": "636462067336542891.ZTM1NmNhNWUtNWZhMC00MzhmLWEwYzAtODk0NTM0YjkwNmU4ZjZkNGU1OWQtZTk1YS00ZDU3LWE0YjQtMzIyMjQxYWEyYmM0",
  "SessionId": "464c4b33795421baddcafeceea2ee11b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067336542891.ZTM1NmNhNWUtNWZhMC00MzhmLWEwYzAtODk0NTM0YjkwNmU4ZjZkNGU1OWQtZTk1YS00ZDU3LWE0YjQtMzIyMjQxYWEyYmM0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaAQ4K9ySUa0ZqpazSgHnlhi3zLllbaRepoHLoUzKK67GZCijwvqDHUaP5kLap0Sdu5t661JbUcMubPAGg0CtXLO11SOfllCOEx9kT8ARtBz2fU4ssJ-cgHnXNaZUWdFOPJ0yjQDRVijDtYM8P4CV-LKCpva8Niv16kE4mfzApH1YcK2TaGISvhxo2ArxkYVP8LS22t76zYgeAcB_1OHuWlY_vfwpuYgFHFzhIvxkj2DtE8oqaDw6JP_5H7b0UNrq4Va3E88NwzidJe-ua9XAfW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:25.714 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:52:25.720 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:52:25.725 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:25.743 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-13 16:52:25.749 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:52:25.784 -05:00 [DBG] p10LCqR9NWqz3p9pt/mclkZwG5jY7GDpwXe5pqwE+cI= not found in database
2017-11-13 16:52:25.825 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:52:25.835 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:52:25.839 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:52:25.880 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaAQ4K9ySUa0ZqpazSgHnlhi3zLllbaRepoHLoUzKK67GZCijwvqDHUaP5kLap0Sdu5t661JbUcMubPAGg0CtXLO11SOfllCOEx9kT8ARtBz2fU4ssJ-cgHnXNaZUWdFOPJ0yjQDRVijDtYM8P4CV-LKCpva8Niv16kE4mfzApH1YcK2TaGISvhxo2ArxkYVP8LS22t76zYgeAcB_1OHuWlY_vfwpuYgFHFzhIvxkj2DtE8oqaDw6JP_5H7b0UNrq4Va3E88NwzidJe-ua9XAfW",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:52:26.147 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:52:26.153 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:52:26.154 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:52:26.163 -05:00 [DBG] Start token request.
2017-11-13 16:52:26.170 -05:00 [DBG] Start client validation
2017-11-13 16:52:26.176 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:52:26.182 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:52:26.183 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:52:26.184 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:52:26.189 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:26.198 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:52:26.199 -05:00 [DBG] Client validation success
2017-11-13 16:52:26.204 -05:00 [DBG] Start token request validation
2017-11-13 16:52:26.215 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:52:26.230 -05:00 [DBG] p10LCqR9NWqz3p9pt/mclkZwG5jY7GDpwXe5pqwE+cI= found in database: true
2017-11-13 16:52:26.252 -05:00 [DBG] removing p10LCqR9NWqz3p9pt/mclkZwG5jY7GDpwXe5pqwE+cI= persisted grant from database
2017-11-13 16:52:26.261 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:52:26.266 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "a293fe3d30b632aa9acc7a40c0f352078b9f72542f6520751635e5036e6ba6b8",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "a293fe3d30b632aa9acc7a40c0f352078b9f72542f6520751635e5036e6ba6b8",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:52:26.287 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:26.290 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:26.295 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:26.305 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:52:26.306 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:26.372 -05:00 [DBG] Creating refresh token
2017-11-13 16:52:26.374 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:52:26.387 -05:00 [DBG] VQ0Az3MyLvsBEvmgIZr5Eb/wpDk5b6M2IpJ7df2B1DE= not found in database
2017-11-13 16:52:26.394 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:26.397 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:26.400 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:26.401 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:52:26.402 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:52:26.409 -05:00 [DBG] Token request success.
2017-11-13 16:52:26.419 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:52:26.422 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:52:26.423 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:52:26.431 -05:00 [DBG] Start userinfo request
2017-11-13 16:52:26.435 -05:00 [DBG] Bearer token found in header
2017-11-13 16:52:26.465 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:26.477 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:26.482 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609946,
    "exp": 1510613546,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:52:26.496 -05:00 [DBG] Creating userinfo response
2017-11-13 16:52:26.500 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:52:26.505 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:26.509 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:52:26.513 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:52:26.514 -05:00 [DBG] End userinfo request
2017-11-13 16:52:29.381 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:29.383 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:29.383 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:52:29.385 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:52:29.387 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:52:29.392 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:29.400 -05:00 [DBG] Start end session request validation
2017-11-13 16:52:29.405 -05:00 [DBG] Start identity token validation
2017-11-13 16:52:29.427 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:29.428 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:52:29.432 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:52:29.439 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510609946,
    "exp": 1510610246,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462067336542891.ZTM1NmNhNWUtNWZhMC00MzhmLWEwYzAtODk0NTM0YjkwNmU4ZjZkNGU1OWQtZTk1YS00ZDU3LWE0YjQtMzIyMjQxYWEyYmM0",
    "iat": 1510609946,
    "at_hash": "QXRW_p57ZdRTIgM0ywFWPg",
    "sid": "464c4b33795421baddcafeceea2ee11b",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609304,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:52:29.450 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKo1DhlhQuu-bKvBDdmU2BSjXoll8AyJsMP-BfSLp3t2CKPlceCff6d7dWpH5sQfnYsOZRAtD8CUeRGuv3c0cTZOjQ5gitAkuJIgAIYL8wXiXP_tdsiSEs23fytuKNGqJiv5pDbB_JFtZ8QD81J7Tl",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MDk5NDYsImV4cCI6MTUxMDYxMDI0NiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDY3MzM2NTQyODkxLlpUTTFObU5oTldVdE5XWmhNQzAwTXpobUxXRXdZekF0T0RrME5UTTBZamt3Tm1VNFpqWmtOR1UxT1dRdFpUazFZUzAwWkRVM0xXRTBZalF0TXpJeU1qUXhZV0V5WW1NMCIsImlhdCI6MTUxMDYwOTk0NiwiYXRfaGFzaCI6IlFYUldfcDU3WmRSVElnTTB5d0ZXUGciLCJzaWQiOiI0NjRjNGIzMzc5NTQyMWJhZGRjYWZlY2VlYTJlZTExYiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYwOTMwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.KA8C8dt50lzybd5FrRM5QaXaeHztLx4PXZ-Ad6O7eg-sqiiRL8wwaeirt3nCAARoRnFX0gsYYpVOeHDtbRpGaDoEcfIW9C-9i2PJmf3urp70sTASk8XM0TcGsWtjPSmKHHHyW304q5y99-SAH5OeMzTz0FHVMaYqQTPKIXvK1MVdrw3phGzVw6ZP-J024K9iyWB89aM4svHNRoKxI0TYEOGLw6LWwARt575o_WH3aNAjT6lfGLQ780V2kFkTwnb-MapzvWRV_HuRJ7T6d_hbG5OX_eZYYf6DYlLkSXU0MxkBvCblhImsvZ3gffaItUcoCPqsCjGjpyimEGztfi8prw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKo1DhlhQuu-bKvBDdmU2BSjXoll8AyJsMP-BfSLp3t2CKPlceCff6d7dWpH5sQfnYsOZRAtD8CUeRGuv3c0cTZOjQ5gitAkuJIgAIYL8wXiXP_tdsiSEs23fytuKNGqJiv5pDbB_JFtZ8QD81J7Tl",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:29.461 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:52:29.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:29.479 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:29.521 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:52:29.523 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:52:29.525 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:52:29.527 -05:00 [INF] User logged out.
2017-11-13 16:52:29.802 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 16:52:29.807 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 16:52:29.809 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 16:52:29.814 -05:00 [DBG] Processing signout callback request
2017-11-13 16:52:29.860 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:29.861 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 16:52:29.863 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 16:52:29.864 -05:00 [INF] Successful signout callback.
2017-11-13 16:52:29.865 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 16:52:29.866 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 16:52:42.665 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:52:42.667 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:52:42.668 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:52:42.669 -05:00 [DBG] Start authorize request
2017-11-13 16:52:42.670 -05:00 [DBG] No user present in authorize request
2017-11-13 16:52:42.670 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:42.699 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:42.700 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:42.701 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:42.707 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:42.770 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:42.774 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:42.778 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:42.779 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:42.780 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYuZyLpRZ_jGIVTH_bhhjddO6mKau2iFWlVDKwY__MdFPS7ESxjfkjlI0gMRHX4I5J8Cf_ueWoKWjuJyYc-RT9EApHwtilx_Y5kyoeZFLgVVKbgzHIXYzeXyvWXMs54ewwLER0WlD8620r5DGSOiTVdsidmO8enMtDEgTPdcrav2-XWNfBnhEpnsPtjpW98hI__CcIpXl9nTWKGKVPs5q5Tz0oRDmrC5OKV-YqMuRerTb0SjWfa6s8Ce7caX5gP2RwzV2OoeJo1Aqxh7OZb5yIa",
  "Nonce": "636462067626604064.MmIxM2E0NmQtMTQ5My00NWE5LWE3N2EtN2IwMzViNjA5MmMxNmQ1YjUyNTctNTY3NS00YjNhLTljZjYtM2YyNDkwZmEyZTcx",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067626604064.MmIxM2E0NmQtMTQ5My00NWE5LWE3N2EtN2IwMzViNjA5MmMxNmQ1YjUyNTctNTY3NS00YjNhLTljZjYtM2YyNDkwZmEyZTcx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYuZyLpRZ_jGIVTH_bhhjddO6mKau2iFWlVDKwY__MdFPS7ESxjfkjlI0gMRHX4I5J8Cf_ueWoKWjuJyYc-RT9EApHwtilx_Y5kyoeZFLgVVKbgzHIXYzeXyvWXMs54ewwLER0WlD8620r5DGSOiTVdsidmO8enMtDEgTPdcrav2-XWNfBnhEpnsPtjpW98hI__CcIpXl9nTWKGKVPs5q5Tz0oRDmrC5OKV-YqMuRerTb0SjWfa6s8Ce7caX5gP2RwzV2OoeJo1Aqxh7OZb5yIa",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:42.789 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:52:42.800 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:52:44.850 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 16:52:44.870 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:52:50.291 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:52:52.978 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:52:52.980 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:52:52.981 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:52:52.982 -05:00 [DBG] Start authorize request
2017-11-13 16:52:52.982 -05:00 [DBG] No user present in authorize request
2017-11-13 16:52:52.983 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:52.989 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:52.989 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:52.990 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:52.993 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:52.998 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:53.001 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:53.004 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:53.005 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:53.006 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
  "Nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:53.016 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:52:53.022 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:52:53.947 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 16:52:54.368 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 16:52:54.380 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 16:52:54.405 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:52:54.414 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:52:54.418 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:52:54.420 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 16:52:54.426 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:54.427 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:54.428 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:52:54.429 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:52:54.430 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:52:54.432 -05:00 [DBG] Start authorize callback request
2017-11-13 16:52:54.432 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:54.433 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:54.438 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:54.439 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:54.439 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:54.443 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:54.448 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:54.450 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:54.455 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:54.457 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:54.458 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
  "Nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
  "SessionId": "a805a4bbea1f2e00c96466f581a36659",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:54.470 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:52:54.471 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:52:54.477 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:54.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:54.479 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:54.484 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:54.485 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:54.485 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:54.487 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:54.492 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:54.494 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:54.497 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:54.498 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:54.502 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:54.507 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:54.573 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.227 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:59.229 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:59.231 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:59.237 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.238 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:59.239 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:59.242 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.248 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.252 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.256 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.258 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:59.264 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:59.265 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:52:59.266 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:52:59.267 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:52:59.268 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:52:59.269 -05:00 [DBG] Start authorize callback request
2017-11-13 16:52:59.270 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:59.271 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:52:59.278 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.279 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:52:59.280 -05:00 [DBG] No PKCE used.
2017-11-13 16:52:59.282 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.286 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.288 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.292 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.294 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:52:59.295 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
  "Nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
  "SessionId": "a805a4bbea1f2e00c96466f581a36659",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:52:59.306 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:52:59.307 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:52:59.309 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:52:59.312 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:59.320 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 16:52:59.323 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:52:59.332 -05:00 [DBG] LfjWq82cTqk2jsH7nW4yW6ACxwvQ8T08Brj1ny6Ngps= not found in database
2017-11-13 16:52:59.336 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:52:59.337 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:52:59.338 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:52:59.343 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbRSLk7OLAgblJxs0GUErGmzmmhu1B5jv_iegcaEqm_hO8xzpUULdr4Ia8WrieHQw45iUhmOA_gfN77F7XVEOmWlP46vLtzNpltjLc_NOdJYW5k1TAZ4_6OXHLmYP5DL0FQKINpgQfEnLUv-NJmSPmHgSnHGlxftJOHNdgID1cZm23bczVfQbc6x5H9hHbNoVdD4ZU3-su92xFNQ9UFA34BOmKaTuORCwA_y5CJLcySjmyWqVfONsJhkNhkk-0jFg_4IWa_Qo4PriA24xs-aA58",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:52:59.352 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:52:59.353 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:52:59.583 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:52:59.585 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:52:59.586 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:52:59.588 -05:00 [DBG] Start token request.
2017-11-13 16:52:59.589 -05:00 [DBG] Start client validation
2017-11-13 16:52:59.591 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:52:59.592 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:52:59.593 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:52:59.594 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:52:59.601 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.603 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:52:59.604 -05:00 [DBG] Client validation success
2017-11-13 16:52:59.605 -05:00 [DBG] Start token request validation
2017-11-13 16:52:59.605 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:52:59.609 -05:00 [DBG] LfjWq82cTqk2jsH7nW4yW6ACxwvQ8T08Brj1ny6Ngps= found in database: true
2017-11-13 16:52:59.621 -05:00 [DBG] removing LfjWq82cTqk2jsH7nW4yW6ACxwvQ8T08Brj1ny6Ngps= persisted grant from database
2017-11-13 16:52:59.630 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:52:59.631 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "0543fe61859c1a2b2c403d6f8fcd11ebbb725909e97e67d808e553c80a5e46df",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "0543fe61859c1a2b2c403d6f8fcd11ebbb725909e97e67d808e553c80a5e46df",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:52:59.641 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.644 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.649 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.651 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:52:59.652 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:52:59.659 -05:00 [DBG] Creating refresh token
2017-11-13 16:52:59.661 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:52:59.670 -05:00 [DBG] 7HI8LoSmvcggTgAABeR1E6sOoAvpEXmD4CNkiutDZp4= not found in database
2017-11-13 16:52:59.678 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.681 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.685 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:52:59.687 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:52:59.688 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:52:59.696 -05:00 [DBG] Token request success.
2017-11-13 16:52:59.700 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:52:59.702 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:52:59.704 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:52:59.707 -05:00 [DBG] Start userinfo request
2017-11-13 16:52:59.708 -05:00 [DBG] Bearer token found in header
2017-11-13 16:52:59.718 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.727 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:52:59.729 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510609979,
    "exp": 1510613579,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609974,
    "idp": "Facebook",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:52:59.737 -05:00 [DBG] Creating userinfo response
2017-11-13 16:52:59.740 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:52:59.744 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:52:59.747 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:52:59.751 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:52:59.752 -05:00 [DBG] End userinfo request
2017-11-13 16:53:01.820 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:01.822 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:58.408 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:58.410 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:58.416 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:53:58.423 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:58.424 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:53:58.425 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:54:00.496 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:00.498 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:00.515 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 16:54:00.522 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:00.524 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:00.526 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:54:14.350 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.351 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.362 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:54:14.366 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 16:54:14.373 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:54:14.377 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 16:54:14.384 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:54:14.385 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:54:14.386 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 16:54:14.392 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.393 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.395 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:54:14.401 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.402 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:14.404 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:54:16.675 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.677 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.690 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:54:16.695 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:54:16.696 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:54:16.697 -05:00 [INF] User logged in.
2017-11-13 16:54:16.707 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.709 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.711 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:54:16.716 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.717 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:16.718 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:54:17.824 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.826 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.839 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:54:17.841 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:54:17.842 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:54:17.843 -05:00 [INF] User logged in.
2017-11-13 16:54:17.849 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.850 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.851 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:54:17.856 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.857 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:54:17.858 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:55:19.591 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:19.593 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:25.814 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:25.816 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:25.818 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:55:25.823 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:25.825 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:25.826 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:55:28.000 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.002 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.005 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 16:55:28.279 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 16:55:28.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.287 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.288 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 16:55:28.293 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:55:28.299 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:55:28.301 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:55:28.302 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 16:55:28.308 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.309 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.310 -05:00 [INF] AuthenticationScheme: idsrv was challenged.
2017-11-13 16:55:28.316 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.317 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:55:28.318 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:55:59.166 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 16:55:59.191 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 16:55:59.193 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 16:55:59.194 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 16:55:59.194 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 16:55:59.270 -05:00 [DBG] Starting token cleanup
2017-11-13 16:56:04.016 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:04.029 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:04.168 -05:00 [DBG] 8 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:04.705 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:04.746 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:04.952 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:35.358 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:35.360 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:35.363 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:56:35.367 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:56:35.368 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:56:35.374 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:35.382 -05:00 [DBG] Start end session request validation
2017-11-13 16:56:35.387 -05:00 [DBG] Start identity token validation
2017-11-13 16:56:35.417 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:35.419 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:56:35.447 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:56:35.509 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510609979,
    "exp": 1510610279,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462067729722052.MjFjNTQ1ODUtZjVhNS00ZjdhLTk1ZmYtYTgyZjQxOTNjY2Q2ODIzY2RlMjMtNTA2Ni00YjRkLWJjM2QtZWRmMTZmYjRiMTIx",
    "iat": 1510609979,
    "at_hash": "Auvc55dPOqeD1Om0NgVuxw",
    "sid": "a805a4bbea1f2e00c96466f581a36659",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510609974,
    "idp": "Facebook",
    "amr": "external"
  }
}
2017-11-13 16:56:35.533 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYo3GVxdLqPaZV3JC7K3VbQkcV6qzJrUEUwdvlh3722mqqCwKTA5uyOKKPx0z75xcV3zN6PveT3zoJC4Dd7lXqHqBy_Ti3nCONtN97B3oDChywfATnf7tPRwVdemcHS1PbjZSqzLMUQ6Ubo5mAbVRKS",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MDk5NzksImV4cCI6MTUxMDYxMDI3OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDY3NzI5NzIyMDUyLk1qRmpOVFExT0RVdFpqVmhOUzAwWmpkaExUazFabVl0WVRneVpqUXhPVE5qWTJRMk9ESXpZMlJsTWpNdE5UQTJOaTAwWWpSa0xXSmpNMlF0WldSbU1UWm1ZalJpTVRJeCIsImlhdCI6MTUxMDYwOTk3OSwiYXRfaGFzaCI6IkF1dmM1NWRQT3FlRDFPbTBOZ1Z1eHciLCJzaWQiOiJhODA1YTRiYmVhMWYyZTAwYzk2NDY2ZjU4MWEzNjY1OSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYwOTk3NCwiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Vkq5UuHdu0HWzEap2yJzoZ-0CWfAhOzMUnDiTxCjtf8PF729FdpC-A8Erq1nNAIPYqjCgLkarLOFvgTjE2RxLxoeRMcIg8mLZy2GBiWBx50zcBjcpCIwBWM_nMIKS4KyfDpwn5aFiOQbhnWYF8FUg9mZvUgGByl7YwEIqKVU4a8PHTXUYF9tcCDy0y_KunHGFEgSMTNPPUOP25e73CmREYfYXx0UUg17yFLsPWkarbzc5_aeZKhZJzKDkFuBk7kBgjgdegl7ulkuKGNFsedvq7PpwPHFTar-sWiP0P8i5MdWqNKJUumqUv1AJY_pPie7zNnJZqnPHqlcf8dFPi7bqw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYo3GVxdLqPaZV3JC7K3VbQkcV6qzJrUEUwdvlh3722mqqCwKTA5uyOKKPx0z75xcV3zN6PveT3zoJC4Dd7lXqHqBy_Ti3nCONtN97B3oDChywfATnf7tPRwVdemcHS1PbjZSqzLMUQ6Ubo5mAbVRKS",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:35.542 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:56:35.565 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:35.567 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:35.638 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:56:35.640 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:56:35.641 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:56:35.642 -05:00 [INF] User logged out.
2017-11-13 16:56:37.714 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 16:56:37.726 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:56:41.873 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:56:41.877 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:56:41.879 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:56:41.885 -05:00 [DBG] Start authorize request
2017-11-13 16:56:41.891 -05:00 [DBG] No user present in authorize request
2017-11-13 16:56:41.897 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:41.907 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:41.911 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:41.914 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:41.928 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:41.991 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:42.003 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:42.008 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:42.017 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:42.027 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
  "Nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:42.044 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:56:42.052 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:56:44.073 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:56:44.131 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:56:44.137 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:56:44.138 -05:00 [INF] User logged in.
2017-11-13 16:56:44.145 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:44.146 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:44.148 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:56:44.150 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:56:44.151 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:56:44.157 -05:00 [DBG] Start authorize callback request
2017-11-13 16:56:44.161 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:44.162 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:44.168 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:44.169 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:44.170 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:44.172 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:44.176 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:44.178 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:44.181 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:44.183 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:44.184 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
  "Nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
  "SessionId": "db23addc643d7235949dfd34d56c6ab7",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:44.206 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:56:44.207 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:56:44.213 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:44.214 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:44.231 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:44.237 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:44.238 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:44.239 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:44.241 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:44.245 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:44.247 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:44.252 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:44.253 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:44.258 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:44.260 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:44.264 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.297 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:46.299 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:46.312 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:46.319 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.320 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:46.321 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:46.324 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.329 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.331 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.335 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.336 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:46.352 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:46.353 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:46.354 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:56:46.356 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:56:46.357 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:56:46.358 -05:00 [DBG] Start authorize callback request
2017-11-13 16:56:46.361 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:46.362 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:46.369 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.371 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:46.372 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:46.375 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.379 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.382 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.386 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.388 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:46.391 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
  "Nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
  "SessionId": "db23addc643d7235949dfd34d56c6ab7",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:46.404 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:56:46.410 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:56:46.413 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:56:46.419 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:46.438 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 16:56:46.470 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:56:46.484 -05:00 [DBG] W6+/NDF1MFYj+9DKIiNOS9KolijMTHxVZpYgKYlDAP4= not found in database
2017-11-13 16:56:46.497 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:56:46.507 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:56:46.510 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:56:46.542 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbip70vSssKdGM4nyJ7G_SnkQP3c6GDKh2HJbnpBw9sWZosz12AthaMrZTdzv6_iUAnu1J07CrbNm_UzlZsueoCOl5LAJS46pgbV2bdWOnFMqLvGJgMxaMvi3NM8ln2z3LMBL4Ev3HZ3TzhoaZ6xXRPHGBDoCTj2SkO4K-iKIi_covUowXMWNiCpevpdzj-JDLo6HIxrue9RF_aVRMlyouiPdiGVszZgGGvJ9QVXDrPf4UrnKG2l5F8ylNxb3pOhP7X4kuWQuy0ymF-AMZCV3Qs",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:56:46.557 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:56:46.559 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:56:46.645 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:56:46.650 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:56:46.652 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:56:46.659 -05:00 [DBG] Start token request.
2017-11-13 16:56:46.666 -05:00 [DBG] Start client validation
2017-11-13 16:56:46.671 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:56:46.674 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:56:46.676 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:56:46.677 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:56:46.682 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.690 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:56:46.691 -05:00 [DBG] Client validation success
2017-11-13 16:56:46.697 -05:00 [DBG] Start token request validation
2017-11-13 16:56:46.709 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:56:46.719 -05:00 [DBG] W6+/NDF1MFYj+9DKIiNOS9KolijMTHxVZpYgKYlDAP4= found in database: true
2017-11-13 16:56:46.733 -05:00 [DBG] removing W6+/NDF1MFYj+9DKIiNOS9KolijMTHxVZpYgKYlDAP4= persisted grant from database
2017-11-13 16:56:46.740 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:56:46.745 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "5ff796186d4b68f919e354965ccacbe7e542e42e98ff30b95bb602b79c0daaa2",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "5ff796186d4b68f919e354965ccacbe7e542e42e98ff30b95bb602b79c0daaa2",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:56:46.764 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.767 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.770 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.781 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:56:46.783 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:46.798 -05:00 [DBG] Creating refresh token
2017-11-13 16:56:46.799 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:56:46.812 -05:00 [DBG] R5x3cq8y48WXlBT2jzVyzqam0eOn2vlcDVumGzWx3YI= not found in database
2017-11-13 16:56:46.819 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.820 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.824 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:46.826 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:56:46.827 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:56:46.833 -05:00 [DBG] Token request success.
2017-11-13 16:56:46.842 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:56:46.845 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:56:46.846 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:56:46.852 -05:00 [DBG] Start userinfo request
2017-11-13 16:56:46.856 -05:00 [DBG] Bearer token found in header
2017-11-13 16:56:46.872 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.883 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:46.884 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510610206,
    "exp": 1510613806,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610204,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:56:46.896 -05:00 [DBG] Creating userinfo response
2017-11-13 16:56:46.900 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:56:46.905 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:46.908 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:56:46.912 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:56:46.914 -05:00 [DBG] End userinfo request
2017-11-13 16:56:50.598 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:50.600 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:50.601 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:56:50.602 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:56:50.604 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:56:50.605 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:50.606 -05:00 [DBG] Start end session request validation
2017-11-13 16:56:50.607 -05:00 [DBG] Start identity token validation
2017-11-13 16:56:50.643 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:50.644 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:56:50.648 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:56:50.653 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510610206,
    "exp": 1510610506,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462070018677514.MDc5MWQxNjYtMjU1Zi00NzM1LWE5NzEtNzc4Y2Y4YmRiZTI4NGFjNzU4YTUtY2JiYy00NmFlLWIzNzgtZTdkNGNjMjJkY2E0",
    "iat": 1510610206,
    "at_hash": "WqIePdZwTt1FY2eXleuWeA",
    "sid": "db23addc643d7235949dfd34d56c6ab7",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610204,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:56:50.658 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbeZSRu4DTps-op1sR0xfO3Gt627yUsaf60DN-lD_k8r1Z1VqfACHF0HIwrijTrkNFtYjftULvF0tb_NBWaO3ztQCMvcHOe9bZ5Tz32Jqh7sMkUJWlpf106eo00Qwji_1J0bC6bwe8D-_iyYWSoUvuX",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTAyMDYsImV4cCI6MTUxMDYxMDUwNiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDcwMDE4Njc3NTE0Lk1EYzVNV1F4TmpZdE1qVTFaaTAwTnpNMUxXRTVOekV0TnpjNFkyWTRZbVJpWlRJNE5HRmpOelU0WVRVdFkySmlZeTAwTm1GbExXSXpOemd0WlRka05HTmpNakprWTJFMCIsImlhdCI6MTUxMDYxMDIwNiwiYXRfaGFzaCI6IldxSWVQZFp3VHQxRlkyZVhsZXVXZUEiLCJzaWQiOiJkYjIzYWRkYzY0M2Q3MjM1OTQ5ZGZkMzRkNTZjNmFiNyIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMDIwNCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.eBsZGqsDZHwYFhVrffLEaDxetPDPMGe0yZ8EZUYA0j0OvxEQnO81u0HuLnJreuVDdC4shiZGSnVeH8mbkfhBdLJfpvod_XAFFAcltLGrytZu_fXnddq33iJgDtRnjDiRtTM8H5X2XcJfQzs_mmgVQVYWqQdd_V6ZmiwSAiiMvbGFjeJyCozv2TMQNhM8sLHLbrHPUZfpyyNTqR7mkMWK1_6jB9NQ_xkBJgYStIcVOEoXf82_r6bYMOcYlv1fTtPtu8e-keAoo7-hWowpPGyzpxUIsHSqxFocVz3trosALBBWTSdQaNng5tfBHkK6sJXwelTTROdM-sj5aQaWCFw14g",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbeZSRu4DTps-op1sR0xfO3Gt627yUsaf60DN-lD_k8r1Z1VqfACHF0HIwrijTrkNFtYjftULvF0tb_NBWaO3ztQCMvcHOe9bZ5Tz32Jqh7sMkUJWlpf106eo00Qwji_1J0bC6bwe8D-_iyYWSoUvuX",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:50.666 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:56:50.672 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:50.674 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:50.679 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:56:50.680 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:56:50.682 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:56:50.683 -05:00 [INF] User logged out.
2017-11-13 16:56:50.758 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 16:56:50.761 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 16:56:50.762 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 16:56:50.767 -05:00 [DBG] Processing signout callback request
2017-11-13 16:56:50.803 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:50.804 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 16:56:50.805 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 16:56:50.806 -05:00 [INF] Successful signout callback.
2017-11-13 16:56:50.807 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 16:56:50.808 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 16:56:52.074 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:56:52.075 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:56:52.077 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:56:52.078 -05:00 [DBG] Start authorize request
2017-11-13 16:56:52.080 -05:00 [DBG] No user present in authorize request
2017-11-13 16:56:52.081 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:52.108 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:52.109 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:52.110 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:52.117 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:52.180 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:52.183 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:52.187 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:52.188 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:52.189 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
  "Nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:52.198 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:56:52.205 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:56:53.458 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:56:53.464 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:56:53.466 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:56:53.467 -05:00 [INF] User logged in.
2017-11-13 16:56:53.473 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:53.475 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:53.476 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:56:53.477 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:56:53.478 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:56:53.479 -05:00 [DBG] Start authorize callback request
2017-11-13 16:56:53.480 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:56:53.481 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:53.507 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:53.508 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:53.509 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:53.518 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:53.594 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:53.601 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:53.661 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:53.663 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:53.665 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
  "Nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
  "SessionId": "767d7d7ec3ade2b463c80fd679cd5d46",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:56:53.677 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:56:53.678 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:56:53.684 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:53.686 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:56:53.687 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:56:53.715 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:53.716 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:56:53.717 -05:00 [DBG] No PKCE used.
2017-11-13 16:56:53.724 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:53.803 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:53.810 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:53.878 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:56:53.880 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:56:53.900 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:56:53.907 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:56:53.978 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.011 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:39.013 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:39.015 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:39.041 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.042 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:39.043 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:39.050 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.129 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.132 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.137 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.138 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:39.145 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:39.146 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:39.147 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:58:39.148 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:58:39.150 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:58:39.151 -05:00 [DBG] Start authorize callback request
2017-11-13 16:58:39.152 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:39.153 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:39.158 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.159 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:39.160 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:39.163 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.168 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.171 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.174 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.175 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:39.176 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
  "Nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
  "SessionId": "767d7d7ec3ade2b463c80fd679cd5d46",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:58:39.189 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:58:39.190 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:58:39.192 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:58:39.194 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:39.200 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 16:58:39.204 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:58:39.213 -05:00 [DBG] gDp3oaGHSAEmQQagLD++fN9WgGrtvY0pH+8lQskbz1M= not found in database
2017-11-13 16:58:39.215 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:58:39.216 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:58:39.217 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:58:39.221 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vagw9VsnDB6vO2R19XtA6D9qKfYmi1bXdnuQ6pI7kyrnsf0DI80AEJNj9pdyNY_69FxtVWV9WI2dAdU7FUmzbGVUUCTXMNWKtbd2YJbjQcVooDgIKV0Babb9_7HTqlx-zAFNbupIljw9gLOnpiHwG_02cWMGY7YRwQoqVf_xPcuPtFCoJKrDjp-NFAQoWYL0heFR37jdtdKUF-ijmotlm-n6hRZ6HgENkEbg3bdK3gsimq5GTRYDjUfeqJYdxrBtTd5iRX977dD7soqMEr8vTby",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:58:39.226 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:58:39.226 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:58:39.328 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:58:39.330 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:58:39.332 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:58:39.333 -05:00 [DBG] Start token request.
2017-11-13 16:58:39.334 -05:00 [DBG] Start client validation
2017-11-13 16:58:39.336 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:58:39.337 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:58:39.338 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:58:39.339 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:58:39.345 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.346 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:58:39.347 -05:00 [DBG] Client validation success
2017-11-13 16:58:39.348 -05:00 [DBG] Start token request validation
2017-11-13 16:58:39.349 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:58:39.353 -05:00 [DBG] gDp3oaGHSAEmQQagLD++fN9WgGrtvY0pH+8lQskbz1M= found in database: true
2017-11-13 16:58:39.366 -05:00 [DBG] removing gDp3oaGHSAEmQQagLD++fN9WgGrtvY0pH+8lQskbz1M= persisted grant from database
2017-11-13 16:58:39.372 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:58:39.373 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "ceee16738db991d57a1f094fd524e7027ad951ff073368b4a0e962c68970e244",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "ceee16738db991d57a1f094fd524e7027ad951ff073368b4a0e962c68970e244",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:58:39.382 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.390 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.480 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.481 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:58:39.482 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:39.493 -05:00 [DBG] Creating refresh token
2017-11-13 16:58:39.495 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:58:39.506 -05:00 [DBG] +nx7MA7eZ30zveiYYL64te89ICZ76NAfgcmCGWUMwCw= not found in database
2017-11-13 16:58:39.512 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.514 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.518 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:39.519 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:58:39.520 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:58:39.525 -05:00 [DBG] Token request success.
2017-11-13 16:58:39.527 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:58:39.529 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:58:39.530 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:58:39.531 -05:00 [DBG] Start userinfo request
2017-11-13 16:58:39.531 -05:00 [DBG] Bearer token found in header
2017-11-13 16:58:39.538 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.544 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:39.546 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510610319,
    "exp": 1510613919,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610213,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:58:39.553 -05:00 [DBG] Creating userinfo response
2017-11-13 16:58:39.554 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:58:39.557 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:39.559 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:58:39.562 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:58:39.564 -05:00 [DBG] End userinfo request
2017-11-13 16:58:48.546 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:48.548 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:48.548 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:58:48.549 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:58:48.551 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:58:48.552 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:48.553 -05:00 [DBG] Start end session request validation
2017-11-13 16:58:48.553 -05:00 [DBG] Start identity token validation
2017-11-13 16:58:48.575 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:48.577 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:58:48.580 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:58:48.584 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510610319,
    "exp": 1510610619,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462070120681960.MWI4MmEwOGUtMzZhZS00NjQ5LTg2OGUtMmUzODA1YTcwYTE3N2IwY2ZlOTEtYzBhMS00Zjc1LThjZjMtNGE2NGZjNmQ0ZjI4",
    "iat": 1510610319,
    "at_hash": "IFap588wkCt5RAEP8TghnA",
    "sid": "767d7d7ec3ade2b463c80fd679cd5d46",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610213,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:58:48.591 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaaBxDO_2QDMmObcrtP5D5_FcDe7vdEZmC3zSD5y3m_RMtrbzxJaTBeAlnkXaKX119TsREFAerX7A85eSH-9erOiYtvDfTl12TZUJFhyRKIGX4UfSTxeUFB1Cu_zEhc2a5CQB5hjyNhx84vbMYAXSEF",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTAzMTksImV4cCI6MTUxMDYxMDYxOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDcwMTIwNjgxOTYwLk1XSTRNbUV3T0dVdE16WmhaUzAwTmpRNUxUZzJPR1V0TW1Vek9EQTFZVGN3WVRFM04ySXdZMlpsT1RFdFl6QmhNUzAwWmpjMUxUaGpaak10TkdFMk5HWmpObVEwWmpJNCIsImlhdCI6MTUxMDYxMDMxOSwiYXRfaGFzaCI6IklGYXA1ODh3a0N0NVJBRVA4VGdobkEiLCJzaWQiOiI3NjdkN2Q3ZWMzYWRlMmI0NjNjODBmZDY3OWNkNWQ0NiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMDIxMywiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.qR34OhWwMbA9sZSInWr6PzTIqcg8FrhXgUU6_98ANlVLi0llmxBETgx_G1vxMrTVnuZPS7O597VGkivzbCRyBEPI4obz0Wz7lS1a_ZepDrQ6tMh3En8arZvZxh_WUPEhU4Cicyo682peZXMcM2ka1_L6QpQsi_h-GxAFbUqC7xCsqPXRl7uwHIp1SgWGQeLc-Z161tepS35sE_5FDuMUlT0AUkjBFItrv_ntlGZaVIS8QzyLGKGXVYiah2Z0d2jvWKw2BYhr4yz-LRAjLNsvf82BXm-PBTc_Dens2DvMsgtFpDQ1JqadoE7rQuBdEQO5WSXbzFHZexBn_QGohlgTVQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaaBxDO_2QDMmObcrtP5D5_FcDe7vdEZmC3zSD5y3m_RMtrbzxJaTBeAlnkXaKX119TsREFAerX7A85eSH-9erOiYtvDfTl12TZUJFhyRKIGX4UfSTxeUFB1Cu_zEhc2a5CQB5hjyNhx84vbMYAXSEF",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:58:48.599 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:58:48.605 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:48.606 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:48.608 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:58:48.609 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:58:48.610 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:58:48.611 -05:00 [INF] User logged out.
2017-11-13 16:58:48.707 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 16:58:48.709 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 16:58:48.710 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 16:58:48.712 -05:00 [DBG] Processing signout callback request
2017-11-13 16:58:48.748 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:48.749 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 16:58:48.750 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 16:58:48.751 -05:00 [INF] Successful signout callback.
2017-11-13 16:58:48.752 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 16:58:48.753 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 16:58:50.902 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:58:50.904 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:58:50.905 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:58:50.906 -05:00 [DBG] Start authorize request
2017-11-13 16:58:50.907 -05:00 [DBG] No user present in authorize request
2017-11-13 16:58:50.908 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:50.929 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:50.931 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:50.931 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:50.938 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:51.012 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:51.019 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:51.083 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:51.085 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:51.086 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
  "Nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:58:51.096 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:58:51.103 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:58:52.990 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:58:52.996 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:58:52.997 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:58:52.998 -05:00 [INF] User logged in.
2017-11-13 16:58:53.005 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:53.006 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:53.007 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:58:53.008 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:58:53.009 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:58:53.010 -05:00 [DBG] Start authorize callback request
2017-11-13 16:58:53.011 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:53.012 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:53.031 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:53.033 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:53.034 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:53.040 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:53.109 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:53.115 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:53.181 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:53.183 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:53.185 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
  "Nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
  "SessionId": "bd1de8d4354c7275817feaa0dfe3283e",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:58:53.197 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:58:53.198 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:58:53.205 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:53.206 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:53.207 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:53.228 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:53.230 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:53.230 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:53.236 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:53.319 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:53.326 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:53.406 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:53.407 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:53.429 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:53.436 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:53.501 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:54.672 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:54.674 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:54.676 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:54.704 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:54.706 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:54.706 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:54.713 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:54.779 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:54.783 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:54.787 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:54.788 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:54.795 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:54.796 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:58:54.798 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:58:54.799 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:58:54.800 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:58:54.802 -05:00 [DBG] Start authorize callback request
2017-11-13 16:58:54.803 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:54.804 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:58:54.834 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:54.835 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:58:54.837 -05:00 [DBG] No PKCE used.
2017-11-13 16:58:54.844 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:54.920 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:54.926 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:54.990 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:54.992 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:58:54.993 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
  "Nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
  "SessionId": "bd1de8d4354c7275817feaa0dfe3283e",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:58:55.006 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:58:55.007 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:58:55.009 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:58:55.011 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:55.017 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 16:58:55.021 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:58:55.029 -05:00 [DBG] zbIF9LNnKMB0Kydge8PBJ4+b+malnuOLiFh+n93q7qw= not found in database
2017-11-13 16:58:55.033 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:58:55.033 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:58:55.035 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:58:55.039 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYybqMQq6jrwsJ1RsMNQs92_-x2hdemRlM2tOU00tuDx2YYyvfSQT7QuKIJH182XVpvb_VTBR2LIZMHuShoaUXeERKObx0uWi6pSvndok4P1TR1E2GMucczXs4l5hV-1H5T438AhJwoyPAAdfpQhQ45sJrgSEYJcwdtKszR6Ot1P1YN5xMqHG4rOMRNwaa5voswxc2zrQVPZZOIKngKYytW4W5D-2FL3RkcwsWgpkcYknPKJbxUrV4FgienisMJUmaoccqVPd1gb0T2BxdhKMJr",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:58:55.043 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:58:55.045 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:58:55.123 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:58:55.125 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:58:55.126 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:58:55.127 -05:00 [DBG] Start token request.
2017-11-13 16:58:55.128 -05:00 [DBG] Start client validation
2017-11-13 16:58:55.129 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:58:55.129 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:58:55.130 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:58:55.131 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:58:55.159 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:55.160 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:58:55.161 -05:00 [DBG] Client validation success
2017-11-13 16:58:55.162 -05:00 [DBG] Start token request validation
2017-11-13 16:58:55.163 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:58:55.166 -05:00 [DBG] zbIF9LNnKMB0Kydge8PBJ4+b+malnuOLiFh+n93q7qw= found in database: true
2017-11-13 16:58:55.179 -05:00 [DBG] removing zbIF9LNnKMB0Kydge8PBJ4+b+malnuOLiFh+n93q7qw= persisted grant from database
2017-11-13 16:58:55.187 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:58:55.188 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4869f4262a5290fb66e82f24e78e3140b787b541c1f77c91b1e6d6ca4607e00e",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "4869f4262a5290fb66e82f24e78e3140b787b541c1f77c91b1e6d6ca4607e00e",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:58:55.218 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:55.225 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:55.296 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:55.297 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:58:55.299 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:58:55.311 -05:00 [DBG] Creating refresh token
2017-11-13 16:58:55.312 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:58:55.323 -05:00 [DBG] qSSlmYp3bw++Gq1nJrA6XB8SiYnbfvrMyRwIwd6ABzU= not found in database
2017-11-13 16:58:55.355 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:55.362 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:55.434 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:58:55.435 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:58:55.436 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:58:55.441 -05:00 [DBG] Token request success.
2017-11-13 16:58:55.443 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:58:55.444 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:58:55.445 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:58:55.447 -05:00 [DBG] Start userinfo request
2017-11-13 16:58:55.448 -05:00 [DBG] Bearer token found in header
2017-11-13 16:58:55.469 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:55.481 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:58:55.482 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510610335,
    "exp": 1510613935,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610332,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:58:55.489 -05:00 [DBG] Creating userinfo response
2017-11-13 16:58:55.490 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:58:55.496 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:58:55.497 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:58:55.503 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:58:55.504 -05:00 [DBG] End userinfo request
2017-11-13 16:59:05.555 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:05.556 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:05.557 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:59:05.558 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:59:05.559 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:59:05.561 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:05.561 -05:00 [DBG] Start end session request validation
2017-11-13 16:59:05.562 -05:00 [DBG] Start identity token validation
2017-11-13 16:59:05.583 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:05.584 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:59:05.588 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:59:05.593 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510610335,
    "exp": 1510610635,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462071308955055.Y2MxYWY0ODQtNDI3OS00YWFjLTk4N2YtOTZjODJlMDFlYWE5YjJjNzNiNTctZWNiMS00OWIwLWI0NDYtN2MwZGRkMDQ2YWJi",
    "iat": 1510610335,
    "at_hash": "YTPOWkgtos0DgZZOmbVa9A",
    "sid": "bd1de8d4354c7275817feaa0dfe3283e",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610332,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:59:05.599 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY_PQDY941AfY9hwoyPTvMINlxlhkodTpwIGv18QGFY3Wkynuym_e-ZaSGeN3TLoGk1YypZkAv3JRbNn5JMWw-yFGHraPONKWlJBA1loub0d5QqTTHHqeG3gTMSTe0LftTGe8YLQd7V6kFdnQcVvsEC",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTAzMzUsImV4cCI6MTUxMDYxMDYzNSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDcxMzA4OTU1MDU1LlkyTXhZV1kwT0RRdE5ESTNPUzAwWVdGakxUazROMll0T1Raak9ESmxNREZsWVdFNVlqSmpOek5pTlRjdFpXTmlNUzAwT1dJd0xXSTBORFl0TjJNd1pHUmtNRFEyWVdKaSIsImlhdCI6MTUxMDYxMDMzNSwiYXRfaGFzaCI6IllUUE9Xa2d0b3MwRGdaWk9tYlZhOUEiLCJzaWQiOiJiZDFkZThkNDM1NGM3Mjc1ODE3ZmVhYTBkZmUzMjgzZSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMDMzMiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.ABrH9CTY3V2DFLvK4Tg5luv6Kw5uMIysK8ISgTV4OB5_5puJnDVEgjnqrp8w02Snu0gAyZwb-42V8rizxinhxLc9LScYpdkHiIiS1tu1QzS0AGWp_rz7O6uhYNeuslr3lybVtvTTLsvsQURDVzWZpjg-HgDEHMM4kkq9PB_Q93dZutaEpAGS3Id52J2tUJLA1TNAbXThaHokGLWx4v7P3sHkLEsxGDgGb9QzmCkaYcC6tva87MsT_jUQPJWFcT3kdM-lxZ9Hd-3WayvHs9kOwPWYgohEXcBncQL8LAVPkAZf9aGwtf7TofPz0wqFfUITbLDpl9_0vE-Jy5NpbJ6DtQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VY_PQDY941AfY9hwoyPTvMINlxlhkodTpwIGv18QGFY3Wkynuym_e-ZaSGeN3TLoGk1YypZkAv3JRbNn5JMWw-yFGHraPONKWlJBA1loub0d5QqTTHHqeG3gTMSTe0LftTGe8YLQd7V6kFdnQcVvsEC",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:59:05.608 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:59:05.614 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:05.615 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:05.617 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:59:05.618 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:59:05.619 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:59:05.620 -05:00 [INF] User logged out.
2017-11-13 16:59:05.712 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 16:59:05.714 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 16:59:05.715 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 16:59:05.716 -05:00 [DBG] Processing signout callback request
2017-11-13 16:59:05.748 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:05.749 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 16:59:05.750 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 16:59:05.751 -05:00 [INF] Successful signout callback.
2017-11-13 16:59:05.752 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 16:59:05.753 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 16:59:07.407 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 16:59:07.408 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 16:59:07.409 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 16:59:07.410 -05:00 [DBG] Start authorize request
2017-11-13 16:59:07.411 -05:00 [DBG] No user present in authorize request
2017-11-13 16:59:07.411 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:59:07.432 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:07.433 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:59:07.434 -05:00 [DBG] No PKCE used.
2017-11-13 16:59:07.440 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:07.502 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:07.505 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:07.511 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:07.512 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:59:07.513 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
  "Nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:59:07.523 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 16:59:07.529 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:59:11.333 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 16:59:11.339 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:59:11.340 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:59:11.342 -05:00 [INF] User logged in.
2017-11-13 16:59:11.348 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:11.349 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:11.350 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:59:11.351 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:59:11.352 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:59:11.353 -05:00 [DBG] Start authorize callback request
2017-11-13 16:59:11.353 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:11.354 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:59:11.375 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:11.376 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:59:11.378 -05:00 [DBG] No PKCE used.
2017-11-13 16:59:11.384 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:11.452 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:11.458 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:11.525 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:11.526 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:59:11.527 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
  "Nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
  "SessionId": "28eb34288edc57167edd394e787b62bc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:59:11.540 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:59:11.541 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 16:59:11.546 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:11.548 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:11.549 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:59:11.570 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:11.571 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:59:11.572 -05:00 [DBG] No PKCE used.
2017-11-13 16:59:11.578 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:11.644 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:11.653 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:11.729 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:11.731 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:59:11.757 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:11.763 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:11.833 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:13.961 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:13.962 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:13.965 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:59:13.994 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:13.995 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:59:13.996 -05:00 [DBG] No PKCE used.
2017-11-13 16:59:14.005 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.070 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.077 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.141 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.143 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:59:14.150 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:14.152 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:14.153 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 16:59:14.154 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 16:59:14.155 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 16:59:14.157 -05:00 [DBG] Start authorize callback request
2017-11-13 16:59:14.158 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:14.158 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 16:59:14.182 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.184 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 16:59:14.184 -05:00 [DBG] No PKCE used.
2017-11-13 16:59:14.192 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.284 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.292 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.359 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.361 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 16:59:14.362 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
  "Nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
  "SessionId": "28eb34288edc57167edd394e787b62bc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:59:14.375 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 16:59:14.376 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:59:14.378 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 16:59:14.380 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:14.386 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 16:59:14.390 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 16:59:14.398 -05:00 [DBG] xXkEuDEKHcWVsECNYjSL14XaI+5KAsDfbpEAbBh2PUQ= not found in database
2017-11-13 16:59:14.401 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 16:59:14.402 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:59:14.403 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:59:14.407 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-n8nbmiqYxp9trRWpCJj1_OvedQtiJxGr4FY1yYW_0JT4ncGgL3Ip1R6XeGpDOcFbrq0MopRzE-1V5o4hLusPm8mHRc10JQghMGEPDaQDPNZNOItkCO2E16lrhe9dh2aewJc1849CiEpNgY8_NBRuXxvXqUEAc1P4WYNiqe4G3I4DyFL-Ur2dNlM8OLNcFJoOaJxOKt0zo9a8O8KBNkghcwEoOo673KiE3n9Vw4h6HGo1CHeZ2q3VKI6PelorDyVQ-tcjT4k9Bi1Fx1UdUGE_",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 16:59:14.411 -05:00 [DBG] Augmenting SignInContext
2017-11-13 16:59:14.412 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 16:59:14.509 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 16:59:14.511 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 16:59:14.512 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 16:59:14.514 -05:00 [DBG] Start token request.
2017-11-13 16:59:14.515 -05:00 [DBG] Start client validation
2017-11-13 16:59:14.515 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 16:59:14.516 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 16:59:14.517 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 16:59:14.518 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 16:59:14.550 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.551 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 16:59:14.552 -05:00 [DBG] Client validation success
2017-11-13 16:59:14.553 -05:00 [DBG] Start token request validation
2017-11-13 16:59:14.554 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 16:59:14.558 -05:00 [DBG] xXkEuDEKHcWVsECNYjSL14XaI+5KAsDfbpEAbBh2PUQ= found in database: true
2017-11-13 16:59:14.570 -05:00 [DBG] removing xXkEuDEKHcWVsECNYjSL14XaI+5KAsDfbpEAbBh2PUQ= persisted grant from database
2017-11-13 16:59:14.578 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 16:59:14.579 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "40813ed270344a3d02c2390cfba1b59e1bd1a4c36e2c573257c0ee347c201731",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "40813ed270344a3d02c2390cfba1b59e1bd1a4c36e2c573257c0ee347c201731",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 16:59:14.616 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.624 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.685 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.686 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 16:59:14.687 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:14.695 -05:00 [DBG] Creating refresh token
2017-11-13 16:59:14.697 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 16:59:14.707 -05:00 [DBG] VjVPkM7swWdgK7opuOYqGDy0s4KTsTJrBbUSgieHdwc= not found in database
2017-11-13 16:59:14.731 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.737 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.804 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 16:59:14.805 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 16:59:14.807 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 16:59:14.811 -05:00 [DBG] Token request success.
2017-11-13 16:59:14.814 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 16:59:14.815 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 16:59:14.816 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 16:59:14.817 -05:00 [DBG] Start userinfo request
2017-11-13 16:59:14.818 -05:00 [DBG] Bearer token found in header
2017-11-13 16:59:14.843 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.867 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:14.868 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510610354,
    "exp": 1510613954,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610351,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 16:59:14.875 -05:00 [DBG] Creating userinfo response
2017-11-13 16:59:14.876 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 16:59:14.882 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 16:59:14.884 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 16:59:14.889 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 16:59:14.891 -05:00 [DBG] End userinfo request
2017-11-13 16:59:27.971 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:27.972 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:27.973 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 16:59:27.974 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 16:59:27.975 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 16:59:27.977 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 16:59:27.978 -05:00 [DBG] Start end session request validation
2017-11-13 16:59:27.978 -05:00 [DBG] Start identity token validation
2017-11-13 16:59:27.999 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:28.000 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 16:59:28.003 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 16:59:28.007 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510610354,
    "exp": 1510610654,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462071474001165.YjcyZTI3YTMtMzlhYi00ZmI4LWIzZGEtMDdjMTJlYjMxOGM1ZjI5YWVhMTMtNDc3Mi00NGQxLTlhMzAtN2U1MzNkZTcxYjc5",
    "iat": 1510610354,
    "at_hash": "jFbRq62GJh_B2MVhretqXQ",
    "sid": "28eb34288edc57167edd394e787b62bc",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510610351,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 16:59:28.013 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYncU6k0WNFkvNgTKcyId71SwcqyCtX-LC0c_mnoDtUtCbnJcY_GbdyvWuffd8slgkjuFig-DGFIdTjbshpZXmMyVKWSG9_Rfkcz1AriBPXoxG5CAgHWm_upFow8owoRpBKqVdOjwnhiQYzXSIdXkQg",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTAzNTQsImV4cCI6MTUxMDYxMDY1NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDcxNDc0MDAxMTY1LllqY3laVEkzWVRNdE16bGhZaTAwWm1JNExXSXpaR0V0TURkak1USmxZak14T0dNMVpqSTVZV1ZoTVRNdE5EYzNNaTAwTkdReExUbGhNekF0TjJVMU16TmtaVGN4WWpjNSIsImlhdCI6MTUxMDYxMDM1NCwiYXRfaGFzaCI6ImpGYlJxNjJHSmhfQjJNVmhyZXRxWFEiLCJzaWQiOiIyOGViMzQyODhlZGM1NzE2N2VkZDM5NGU3ODdiNjJiYyIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMDM1MSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.NV4XOgCbqWJguEYdh2aXm4k69SVsEuMbbzSb0b6iC8d_RMIWR2aXSPKnkfoCB5GuVfQSgjLiFfGFuAFhZ6l5vA6Si0dNGU7WYWqFhmQd_mRFzJRBsVTI7AwovJON4jKxy98SVCMfr6Hlb0AHbXTr8oFTUPC-Y87jJhmXf85QMCootn2Hu5JdNS_ld_PQx9p99b9xUMEKf25AcPBkYV5BsuGmonnDSMfjZpb3dSmE8i5duBZKK0ljkf7KAciWJ940Ieqt92Mal6K-83a-Oo6mqziHXRv1QIHLzp2zI2K1eZQ6hk9WV9dJG4o1hJ9S7DwvG0_yw6IGsAKXflkU79srXg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYncU6k0WNFkvNgTKcyId71SwcqyCtX-LC0c_mnoDtUtCbnJcY_GbdyvWuffd8slgkjuFig-DGFIdTjbshpZXmMyVKWSG9_Rfkcz1AriBPXoxG5CAgHWm_upFow8owoRpBKqVdOjwnhiQYzXSIdXkQg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 16:59:28.021 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 16:59:28.027 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:28.028 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 16:59:28.030 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 16:59:28.031 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 16:59:28.032 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 16:59:28.033 -05:00 [INF] User logged out.
2017-11-13 16:59:28.113 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 16:59:28.115 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 16:59:28.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 16:59:28.118 -05:00 [DBG] Processing signout callback request
2017-11-13 16:59:28.148 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 16:59:28.150 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 16:59:28.151 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 16:59:28.152 -05:00 [INF] Successful signout callback.
2017-11-13 16:59:28.153 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 16:59:28.154 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:00:50.131 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 17:00:50.135 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 17:00:50.138 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 17:00:50.143 -05:00 [DBG] Start discovery request
2017-11-13 17:00:50.209 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 17:04:36.493 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:04:36.499 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:04:36.500 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:04:36.502 -05:00 [INF] User logged in.
2017-11-13 17:04:36.510 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:04:36.512 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:01.068 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:01.070 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:02.149 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:02.150 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:03.791 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:03.793 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:05.325 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:05:05.326 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:06:59.506 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:06:59.534 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:06:59.535 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:06:59.536 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:06:59.536 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:06:59.625 -05:00 [DBG] Starting token cleanup
2017-11-13 17:06:59.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:06:59.948 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:06.146 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:06.148 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:07.360 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:07.361 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:56.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:07:56.114 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:55.773 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:55.774 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:57.855 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:57.856 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:59.445 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:08:59.447 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:10:03.078 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:10:03.079 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:10:04.619 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:10:04.620 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:16:44.904 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:16:44.931 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:16:44.932 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:16:44.933 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:16:44.933 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:16:45.011 -05:00 [DBG] Starting token cleanup
2017-11-13 17:16:49.801 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:16:49.815 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:16:56.613 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:16:56.615 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:16:56.652 -05:00 [DBG] 4 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:16:57.237 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:16:57.279 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:16:57.489 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:18:29.987 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:18:30.013 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:18:30.014 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:18:30.014 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:18:30.015 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:18:30.097 -05:00 [DBG] Starting token cleanup
2017-11-13 17:18:31.228 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:31.245 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:31.415 -05:00 [DBG] 4 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:18:32.079 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:18:32.125 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:18:32.360 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:18:37.554 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:37.556 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:38.696 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:38.696 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:18:38.701 -05:00 [DBG] 4 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:18:38.736 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:18:38.742 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:18:38.839 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:10.380 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:10.382 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:10.442 -05:00 [DBG] removing 4 persisted grants from database for subject cf559f42-d46a-4dea-9390-b50e0f71a84e, clientId mvc.hybrid
2017-11-13 17:20:10.479 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:10.480 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:10.486 -05:00 [DBG] 0 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:20:35.149 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:35.151 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:35.189 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:20:35.191 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:20:35.193 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:20:35.194 -05:00 [INF] User logged out.
2017-11-13 17:20:39.672 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:20:39.678 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:20:39.682 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:20:39.687 -05:00 [DBG] Start authorize request
2017-11-13 17:20:39.694 -05:00 [DBG] No user present in authorize request
2017-11-13 17:20:39.699 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:20:39.728 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:20:39.733 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:20:39.735 -05:00 [DBG] No PKCE used.
2017-11-13 17:20:39.750 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:39.818 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:39.835 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:39.903 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:39.914 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:20:39.963 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
  "Nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:20:39.982 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:20:39.998 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:20:42.677 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:20:42.740 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:20:42.746 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:20:42.748 -05:00 [INF] User logged in.
2017-11-13 17:20:42.757 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:42.758 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:42.759 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:20:42.761 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:20:42.762 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:20:42.769 -05:00 [DBG] Start authorize callback request
2017-11-13 17:20:42.774 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:20:42.775 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:20:42.798 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:20:42.800 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:20:42.801 -05:00 [DBG] No PKCE used.
2017-11-13 17:20:42.807 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:42.873 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:42.877 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:42.881 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:42.883 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:20:42.884 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
  "Nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
  "SessionId": "7085666ac867bb3b33ff91ad88ff46af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:20:42.909 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:20:42.910 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:20:42.917 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:42.919 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:20:42.936 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:20:42.960 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:20:42.961 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:20:42.962 -05:00 [DBG] No PKCE used.
2017-11-13 17:20:42.968 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:43.040 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:43.047 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:43.120 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:20:43.121 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:20:43.143 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:20:43.149 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:20:43.215 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:21:26.054 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:21:26.083 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:21:26.084 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:21:26.085 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:21:26.085 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:21:26.262 -05:00 [DBG] Starting token cleanup
2017-11-13 17:21:27.497 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:21:27.515 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:22:23.682 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:22:24.523 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:22:24.532 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:22:24.534 -05:00 [DBG] No PKCE used.
2017-11-13 17:22:24.638 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:22:25.057 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:22:25.141 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:22:25.327 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:22:25.338 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:23:26.283 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:26.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:26.293 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:23:26.299 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:23:26.301 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:23:26.312 -05:00 [DBG] Start authorize callback request
2017-11-13 17:23:26.349 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:23:26.350 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:23:26.544 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:26.546 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:23:26.547 -05:00 [DBG] No PKCE used.
2017-11-13 17:23:26.591 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:26.745 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:23:26.786 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:26.952 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:23:26.954 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:23:26.977 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
  "Nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
  "SessionId": "7085666ac867bb3b33ff91ad88ff46af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:23:27.103 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:23:27.111 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:23:27.117 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:23:27.125 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:23:27.179 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 17:23:27.269 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:23:27.329 -05:00 [DBG] 8SapWQuoP5UpbkF43RGXHITMhROKyl8j6awVSy45F6Y= not found in database
2017-11-13 17:23:27.362 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:23:27.373 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:23:27.377 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:23:27.436 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZoN9qTQO_K8x8NUgiYI3wg_OsV1GRnR2V4vqH8afLjZ0CusWvmilb_PvEspwwP5QjlgjhX0qNeA_Penf56ky7SpWhNTFgQrUI8Zqt5WBg9C5yvVJvQtyOxi1gQiKASr6Ai2-QYwR0D5CtjdzAfvD_lbwGnXilsMi0B_TOVzmRhNQka8JutG6AANJPlizGtXhniO6u66N-l1wETCVTm8iBlvY-0e0ag4nmp5SaM6tfUURC8QyqIlvak0LlcZWwAFrZKQMjgFjzzaPYScUTmuSjZ",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:23:27.462 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:23:27.471 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:23:27.770 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:23:27.777 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:23:27.779 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:23:27.792 -05:00 [DBG] Start token request.
2017-11-13 17:23:27.800 -05:00 [DBG] Start client validation
2017-11-13 17:23:27.808 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:23:27.812 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:23:27.814 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:23:27.815 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:23:28.008 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:28.018 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:23:28.019 -05:00 [DBG] Client validation success
2017-11-13 17:23:28.024 -05:00 [DBG] Start token request validation
2017-11-13 17:23:28.036 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:23:28.078 -05:00 [DBG] 8SapWQuoP5UpbkF43RGXHITMhROKyl8j6awVSy45F6Y= found in database: true
2017-11-13 17:23:28.118 -05:00 [DBG] removing 8SapWQuoP5UpbkF43RGXHITMhROKyl8j6awVSy45F6Y= persisted grant from database
2017-11-13 17:23:28.171 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:23:28.177 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "1e98bdb9099715db4e4930e2f665f2e1f966f47e8282edb2fb9c5923036566e5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "1e98bdb9099715db4e4930e2f665f2e1f966f47e8282edb2fb9c5923036566e5",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:23:28.544 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:28.623 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:28.837 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:23:28.851 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:23:28.853 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:23:28.983 -05:00 [DBG] Creating refresh token
2017-11-13 17:23:28.984 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:23:29.034 -05:00 [DBG] CjqglvCCpM80pDYxJ09Hy5cO3c22UISi9btwov5cwZk= not found in database
2017-11-13 17:23:29.410 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:29.487 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:29.727 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:23:29.729 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:23:29.731 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:23:29.741 -05:00 [DBG] Token request success.
2017-11-13 17:23:29.763 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:23:29.766 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:23:29.769 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:23:29.781 -05:00 [DBG] Start userinfo request
2017-11-13 17:23:29.787 -05:00 [DBG] Bearer token found in header
2017-11-13 17:23:30.307 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:30.666 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:30.671 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510611808,
    "exp": 1510615408,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510611642,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:23:30.686 -05:00 [DBG] Creating userinfo response
2017-11-13 17:23:30.691 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:23:30.758 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:30.760 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:23:30.836 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:23:30.840 -05:00 [DBG] End userinfo request
2017-11-13 17:23:42.788 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:42.794 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:48.532 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:48.536 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:23:48.623 -05:00 [DBG] 2 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:23:48.888 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:23:48.931 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:23:49.097 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:12.601 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:12.605 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:16.241 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:25:16.245 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:25:16.248 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:25:16.252 -05:00 [INF] User logged out.
2017-11-13 17:25:16.645 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:25:16.649 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:25:16.652 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:25:16.663 -05:00 [DBG] Processing signout callback request
2017-11-13 17:25:16.890 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:16.891 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:25:16.892 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:25:16.893 -05:00 [INF] Successful signout callback.
2017-11-13 17:25:16.896 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:25:16.897 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:25:18.929 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:25:20.484 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:25:20.560 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:25:20.562 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:25:20.565 -05:00 [INF] User logged in.
2017-11-13 17:25:20.582 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:20.585 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:38.513 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:25:38.539 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:25:38.539 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:25:38.540 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:25:38.540 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:25:38.617 -05:00 [DBG] Starting token cleanup
2017-11-13 17:25:43.581 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:43.594 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:43.747 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:25:43.749 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:25:43.749 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:25:43.750 -05:00 [INF] User logged out.
2017-11-13 17:25:51.002 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:25:51.007 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:25:51.009 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:25:51.015 -05:00 [DBG] Processing signout request for anonymous
2017-11-13 17:25:51.021 -05:00 [DBG] Start end session request validation
2017-11-13 17:25:51.026 -05:00 [DBG] Start identity token validation
2017-11-13 17:25:51.559 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:51.564 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:25:51.593 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:25:51.660 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510611809,
    "exp": 1510612109,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462084396620085.NjZiM2I1ZjYtNDExMy00Zjc1LWI0N2UtYzc5N2ZmM2Y2MDBhNzc1NWIzZWMtMGY3Mi00NWVkLTg1MmItYjYzOTJjZThjNzRj",
    "iat": 1510611809,
    "at_hash": "w1ciAGERSBN3uKCqd0cYDw",
    "sid": "7085666ac867bb3b33ff91ad88ff46af",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510611642,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:25:51.680 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaxb6TTgjH9XGm2dvQygiF2fLhUdyzn9F1WYKKMNk63Ov0xfuQL-7BEfQQ5xmcYtVaPkIpjiZVDa8F-cbFbUbUFyvWAOHV3-y1crz33FfTATfuof8RnlFn0zRcVI-sj-pllSGrfq4_E5ztGXmxFBYFX",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTE4MDksImV4cCI6MTUxMDYxMjEwOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDg0Mzk2NjIwMDg1Lk5qWmlNMkkxWmpZdE5ERXhNeTAwWmpjMUxXSTBOMlV0WXpjNU4yWm1NMlkyTURCaE56YzFOV0l6WldNdE1HWTNNaTAwTldWa0xUZzFNbUl0WWpZek9USmpaVGhqTnpSaiIsImlhdCI6MTUxMDYxMTgwOSwiYXRfaGFzaCI6IncxY2lBR0VSU0JOM3VLQ3FkMGNZRHciLCJzaWQiOiI3MDg1NjY2YWM4NjdiYjNiMzNmZjkxYWQ4OGZmNDZhZiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMTY0MiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Z2IuZJnd74Bikf6jSh56_sAAlGHeHoHCT7ABBt2sWYYZSv4MSi0ILQCkcUnTOvvPpl2Wwg5Mt-TRY2zf2Lpg9vccK94CQxAgdYuE3PJKjIgy7AzToFZoCqZ5kydQg6cr3KM6iZyRNSKZq6nEoAr_eMBx0a6mScxj9z2aHmCg6_rUAZaBFTNqgMEE037a40fM2Ee64DRGPVx1I5r1yxyToni5QODl-YzLvzE5y4ESA-ktoLEMpvvrs23pN9gzgHN7HJ299JS8lBrF04ADPz71GdBu4mh5HHevmM9Uf8-ef90prXOhpbzMkOm0_T5wk12gN5x7Ye_mFHe8fPATY15WbQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vaxb6TTgjH9XGm2dvQygiF2fLhUdyzn9F1WYKKMNk63Ov0xfuQL-7BEfQQ5xmcYtVaPkIpjiZVDa8F-cbFbUbUFyvWAOHV3-y1crz33FfTATfuof8RnlFn0zRcVI-sj-pllSGrfq4_E5ztGXmxFBYFX",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:25:51.691 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:25:51.760 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:25:51.762 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:25:51.763 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:25:51.764 -05:00 [INF] User logged out.
2017-11-13 17:25:53.386 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:25:53.390 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:25:53.392 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:25:53.398 -05:00 [DBG] Start authorize request
2017-11-13 17:25:53.403 -05:00 [DBG] No user present in authorize request
2017-11-13 17:25:53.410 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:25:53.424 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:53.430 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:25:53.432 -05:00 [DBG] No PKCE used.
2017-11-13 17:25:53.483 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:53.699 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:53.712 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:53.717 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:53.726 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:25:53.735 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaS0rhSx-AoUvyR2WpLEec7knf5MR_mEZ9_H45Cxcps4e9BdqK9SbyyyyBdJXoHwW4_An93K6_2WbuDSJKgAMLdczNCFNG0wBdZNBfbxtbSCrZ9qr--U4CU6Emuz9BuyRthS6y3CjQFFYd4c3cV2vkEfJLjYVLd3t4omb9Rd6IDQnxisTcqZr5Zigds4hRS5i5HlPszF1h4r5JlYc_-klV0bGoXrEohjHKlJoEb81SpKc2Q35q_36qj641FcUKn1WAYyZXDOGTrQM4GxGdRLOf5",
  "Nonce": "636462087533663056.Yjg5MDY1ODQtZjhhMy00OTgzLWI0OTAtZmFmMmJhMGViOGI3NDMwMmU2NDgtMWRlOC00OGY5LThlMjEtMGM0OWIxZjIxZDUy",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462087533663056.Yjg5MDY1ODQtZjhhMy00OTgzLWI0OTAtZmFmMmJhMGViOGI3NDMwMmU2NDgtMWRlOC00OGY5LThlMjEtMGM0OWIxZjIxZDUy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaS0rhSx-AoUvyR2WpLEec7knf5MR_mEZ9_H45Cxcps4e9BdqK9SbyyyyBdJXoHwW4_An93K6_2WbuDSJKgAMLdczNCFNG0wBdZNBfbxtbSCrZ9qr--U4CU6Emuz9BuyRthS6y3CjQFFYd4c3cV2vkEfJLjYVLd3t4omb9Rd6IDQnxisTcqZr5Zigds4hRS5i5HlPszF1h4r5JlYc_-klV0bGoXrEohjHKlJoEb81SpKc2Q35q_36qj641FcUKn1WAYyZXDOGTrQM4GxGdRLOf5",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:25:53.753 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:25:53.769 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:25:55.829 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:25:55.890 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:25:55.897 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:25:55.898 -05:00 [INF] User logged in.
2017-11-13 17:25:55.905 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:55.907 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:55.908 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:25:55.909 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:25:55.911 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:25:55.917 -05:00 [DBG] Start authorize callback request
2017-11-13 17:25:55.923 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:25:55.924 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:25:55.929 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:55.931 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:25:55.932 -05:00 [DBG] No PKCE used.
2017-11-13 17:25:55.934 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:55.938 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:55.940 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:55.945 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:55.946 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:25:55.948 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaS0rhSx-AoUvyR2WpLEec7knf5MR_mEZ9_H45Cxcps4e9BdqK9SbyyyyBdJXoHwW4_An93K6_2WbuDSJKgAMLdczNCFNG0wBdZNBfbxtbSCrZ9qr--U4CU6Emuz9BuyRthS6y3CjQFFYd4c3cV2vkEfJLjYVLd3t4omb9Rd6IDQnxisTcqZr5Zigds4hRS5i5HlPszF1h4r5JlYc_-klV0bGoXrEohjHKlJoEb81SpKc2Q35q_36qj641FcUKn1WAYyZXDOGTrQM4GxGdRLOf5",
  "Nonce": "636462087533663056.Yjg5MDY1ODQtZjhhMy00OTgzLWI0OTAtZmFmMmJhMGViOGI3NDMwMmU2NDgtMWRlOC00OGY5LThlMjEtMGM0OWIxZjIxZDUy",
  "SessionId": "d386fe6b51d457ab5ad327585a9bb784",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462087533663056.Yjg5MDY1ODQtZjhhMy00OTgzLWI0OTAtZmFmMmJhMGViOGI3NDMwMmU2NDgtMWRlOC00OGY5LThlMjEtMGM0OWIxZjIxZDUy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaS0rhSx-AoUvyR2WpLEec7knf5MR_mEZ9_H45Cxcps4e9BdqK9SbyyyyBdJXoHwW4_An93K6_2WbuDSJKgAMLdczNCFNG0wBdZNBfbxtbSCrZ9qr--U4CU6Emuz9BuyRthS6y3CjQFFYd4c3cV2vkEfJLjYVLd3t4omb9Rd6IDQnxisTcqZr5Zigds4hRS5i5HlPszF1h4r5JlYc_-klV0bGoXrEohjHKlJoEb81SpKc2Q35q_36qj641FcUKn1WAYyZXDOGTrQM4GxGdRLOf5",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:25:55.967 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:25:55.968 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:25:55.975 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:55.976 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:25:55.992 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:25:55.998 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:55.998 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:25:55.999 -05:00 [DBG] No PKCE used.
2017-11-13 17:25:56.001 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:56.006 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:56.008 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:56.011 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:25:56.012 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:25:56.017 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:25:56.023 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:25:56.085 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:46.489 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:46.491 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:46.494 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:28:46.495 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:28:46.496 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:28:46.498 -05:00 [INF] User logged out.
2017-11-13 17:28:51.329 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:28:51.331 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:28:51.333 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:28:51.336 -05:00 [DBG] Start authorize request
2017-11-13 17:28:51.337 -05:00 [DBG] No user present in authorize request
2017-11-13 17:28:51.338 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:28:51.369 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:51.371 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:28:51.371 -05:00 [DBG] No PKCE used.
2017-11-13 17:28:51.380 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:51.442 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:51.445 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:51.449 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:51.450 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:28:51.451 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZpq2_9AF25Oac4KtGgZKDeS4nd-oRbMjivmZDrrdgdSOmESoqS4BY23aOHwG5MBf8-Q_AOO8NhcXzPNn9qdB5PYdLulUlSqaZ1_zv3pnEtjaiRDdkn1gkp8RP7LdWluGS8ja7VyWj5tKESHM373owNoTZnYFexvymX-dem_EwfPpUlBtZYPiJ_tQOmW8DmaViGCrZ8WEs_yibgWWDJSUhB_Uory9UeUkg7laufwBOjg3cB99uAHc7pfot7A7OWqs4oYP3tArHWiW21jFCydJm4",
  "Nonce": "636462089313202392.OWY0MTQ1YjctZTc4ZC00NmMwLWJmYmQtOGFkNzA1YzY0ODI2ZDAyNTY4NzAtMDhjYy00ZDQyLTg4NTYtNzNhN2FiZGNmZTJl",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089313202392.OWY0MTQ1YjctZTc4ZC00NmMwLWJmYmQtOGFkNzA1YzY0ODI2ZDAyNTY4NzAtMDhjYy00ZDQyLTg4NTYtNzNhN2FiZGNmZTJl",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZpq2_9AF25Oac4KtGgZKDeS4nd-oRbMjivmZDrrdgdSOmESoqS4BY23aOHwG5MBf8-Q_AOO8NhcXzPNn9qdB5PYdLulUlSqaZ1_zv3pnEtjaiRDdkn1gkp8RP7LdWluGS8ja7VyWj5tKESHM373owNoTZnYFexvymX-dem_EwfPpUlBtZYPiJ_tQOmW8DmaViGCrZ8WEs_yibgWWDJSUhB_Uory9UeUkg7laufwBOjg3cB99uAHc7pfot7A7OWqs4oYP3tArHWiW21jFCydJm4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:28:51.461 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:28:51.467 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:28:52.904 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:28:52.912 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:28:52.914 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:28:52.916 -05:00 [INF] User logged in.
2017-11-13 17:28:52.924 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:52.926 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:52.928 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:28:52.929 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:28:52.930 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:28:52.932 -05:00 [DBG] Start authorize callback request
2017-11-13 17:28:52.932 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:28:52.933 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:28:52.939 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:52.940 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:28:52.941 -05:00 [DBG] No PKCE used.
2017-11-13 17:28:52.944 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:52.949 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:52.951 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:52.955 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:52.956 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:28:52.958 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZpq2_9AF25Oac4KtGgZKDeS4nd-oRbMjivmZDrrdgdSOmESoqS4BY23aOHwG5MBf8-Q_AOO8NhcXzPNn9qdB5PYdLulUlSqaZ1_zv3pnEtjaiRDdkn1gkp8RP7LdWluGS8ja7VyWj5tKESHM373owNoTZnYFexvymX-dem_EwfPpUlBtZYPiJ_tQOmW8DmaViGCrZ8WEs_yibgWWDJSUhB_Uory9UeUkg7laufwBOjg3cB99uAHc7pfot7A7OWqs4oYP3tArHWiW21jFCydJm4",
  "Nonce": "636462089313202392.OWY0MTQ1YjctZTc4ZC00NmMwLWJmYmQtOGFkNzA1YzY0ODI2ZDAyNTY4NzAtMDhjYy00ZDQyLTg4NTYtNzNhN2FiZGNmZTJl",
  "SessionId": "6616b544d7d289ad62ed6666c50b0cd1",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089313202392.OWY0MTQ1YjctZTc4ZC00NmMwLWJmYmQtOGFkNzA1YzY0ODI2ZDAyNTY4NzAtMDhjYy00ZDQyLTg4NTYtNzNhN2FiZGNmZTJl",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZpq2_9AF25Oac4KtGgZKDeS4nd-oRbMjivmZDrrdgdSOmESoqS4BY23aOHwG5MBf8-Q_AOO8NhcXzPNn9qdB5PYdLulUlSqaZ1_zv3pnEtjaiRDdkn1gkp8RP7LdWluGS8ja7VyWj5tKESHM373owNoTZnYFexvymX-dem_EwfPpUlBtZYPiJ_tQOmW8DmaViGCrZ8WEs_yibgWWDJSUhB_Uory9UeUkg7laufwBOjg3cB99uAHc7pfot7A7OWqs4oYP3tArHWiW21jFCydJm4",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:28:52.972 -05:00 [DBG] Client is configured to not require consent, no consent is required
2017-11-13 17:28:52.980 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:28:53.021 -05:00 [DBG] qna8ATQ4feRPdPzPVKkmfeedlQ+bz4ej0pT6NL5boZw= not found in database
2017-11-13 17:28:53.063 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:28:53.073 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:28:53.076 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:28:53.107 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZpq2_9AF25Oac4KtGgZKDeS4nd-oRbMjivmZDrrdgdSOmESoqS4BY23aOHwG5MBf8-Q_AOO8NhcXzPNn9qdB5PYdLulUlSqaZ1_zv3pnEtjaiRDdkn1gkp8RP7LdWluGS8ja7VyWj5tKESHM373owNoTZnYFexvymX-dem_EwfPpUlBtZYPiJ_tQOmW8DmaViGCrZ8WEs_yibgWWDJSUhB_Uory9UeUkg7laufwBOjg3cB99uAHc7pfot7A7OWqs4oYP3tArHWiW21jFCydJm4",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:28:53.120 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:28:53.122 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:28:53.210 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:28:53.217 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:28:53.219 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:28:53.226 -05:00 [DBG] Start token request.
2017-11-13 17:28:53.235 -05:00 [DBG] Start client validation
2017-11-13 17:28:53.243 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:28:53.248 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:28:53.249 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:28:53.250 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:28:53.255 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:53.264 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:28:53.266 -05:00 [DBG] Client validation success
2017-11-13 17:28:53.272 -05:00 [DBG] Start token request validation
2017-11-13 17:28:53.282 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:28:53.300 -05:00 [DBG] qna8ATQ4feRPdPzPVKkmfeedlQ+bz4ej0pT6NL5boZw= found in database: true
2017-11-13 17:28:53.325 -05:00 [DBG] removing qna8ATQ4feRPdPzPVKkmfeedlQ+bz4ej0pT6NL5boZw= persisted grant from database
2017-11-13 17:28:53.333 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:28:53.338 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "51b0bac4404bf4b8d973a0f98a21efc4b5ad6c538c1e59332d89404e5cd6b71f",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "51b0bac4404bf4b8d973a0f98a21efc4b5ad6c538c1e59332d89404e5cd6b71f",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:28:53.359 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:53.366 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:53.429 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:53.439 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:28:53.441 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:28:53.455 -05:00 [DBG] Creating refresh token
2017-11-13 17:28:53.457 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:28:53.470 -05:00 [DBG] Zra2+AUaGI+NAMQk6oqFzdQCVWaSm81FZPASc49fFBk= not found in database
2017-11-13 17:28:53.478 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:53.481 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:53.485 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:53.486 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:28:53.487 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:28:53.494 -05:00 [DBG] Token request success.
2017-11-13 17:28:53.503 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:28:53.506 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:28:53.507 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:28:53.514 -05:00 [DBG] Start userinfo request
2017-11-13 17:28:53.518 -05:00 [DBG] Bearer token found in header
2017-11-13 17:28:53.533 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:53.545 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:53.547 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612133,
    "exp": 1510615733,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612132,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:28:53.562 -05:00 [DBG] Creating userinfo response
2017-11-13 17:28:53.566 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:28:53.572 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:53.574 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:28:53.579 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:28:53.581 -05:00 [DBG] End userinfo request
2017-11-13 17:28:56.234 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:56.235 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:56.236 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:28:56.237 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:28:56.238 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:28:56.240 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:28:56.240 -05:00 [DBG] Start end session request validation
2017-11-13 17:28:56.241 -05:00 [DBG] Start identity token validation
2017-11-13 17:28:56.249 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:56.250 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:28:56.254 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:28:56.258 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612133,
    "exp": 1510612433,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462089313202392.OWY0MTQ1YjctZTc4ZC00NmMwLWJmYmQtOGFkNzA1YzY0ODI2ZDAyNTY4NzAtMDhjYy00ZDQyLTg4NTYtNzNhN2FiZGNmZTJl",
    "iat": 1510612133,
    "at_hash": "qb2UUnYZyorY2aLC9UJaEA",
    "sid": "6616b544d7d289ad62ed6666c50b0cd1",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612132,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:28:56.264 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYtoVjmqAB4bJ3m575OEHg8k3khG7lqxwLYMTZrzueDYDXbkr84UQ-BLUv6lEHNwYqZF5gTx2bSsrVfnkl4F4Pl6JjDwU4zWJtYBrRn7rM9WZGE3oScEWZBVa5XNI0xNCnLB7OfYgU3JJ7SFif3Wtme",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTIxMzMsImV4cCI6MTUxMDYxMjQzMywiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDg5MzEzMjAyMzkyLk9XWTBNVFExWWpjdFpUYzRaQzAwTm1Nd0xXSm1ZbVF0T0dGa056QTFZelkwT0RJMlpEQXlOVFk0TnpBdE1EaGpZeTAwWkRReUxUZzROVFl0TnpOaE4yRmlaR05tWlRKbCIsImlhdCI6MTUxMDYxMjEzMywiYXRfaGFzaCI6InFiMlVVbllaeW9yWTJhTEM5VUphRUEiLCJzaWQiOiI2NjE2YjU0NGQ3ZDI4OWFkNjJlZDY2NjZjNTBiMGNkMSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjEzMiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.VtNxWUxld8x5GaqL-wFmozSFy0io9U_D2crORglTUUMt1l2KLd-E_Jy4JNVTWDxQU0miBD5wsLtP0yCfPQr6A5p8ne1OR6e8hw7pc0yJy51tIEAzRAYWhSdWYivkAl6S_SazD3-8UsORlHO8uz19vM2YhYUkE-QKHgtbFMl9MU1zzNiEcXOtlK7fKU9Wau7dFtyJik6w5ICwZIBNKW8c79YdCYNBX-NTPRj8NX_PZuG95CNuHMIYShxFsX7ZdFxwC_9rdHkz4LAmt5vB2TEt5l2KtfimEZbdVfhWFnnBubta2yNx_GkRnCPkNKVvgxfy-zwfXlrwmNf3-4F8HuKIbg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYtoVjmqAB4bJ3m575OEHg8k3khG7lqxwLYMTZrzueDYDXbkr84UQ-BLUv6lEHNwYqZF5gTx2bSsrVfnkl4F4Pl6JjDwU4zWJtYBrRn7rM9WZGE3oScEWZBVa5XNI0xNCnLB7OfYgU3JJ7SFif3Wtme",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:28:56.272 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:28:56.280 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:56.283 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:56.288 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:28:56.289 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:28:56.290 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:28:56.291 -05:00 [INF] User logged out.
2017-11-13 17:28:56.357 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:28:56.361 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:28:56.363 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:28:56.372 -05:00 [DBG] Processing signout callback request
2017-11-13 17:28:56.392 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:56.393 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:28:56.395 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:28:56.395 -05:00 [INF] Successful signout callback.
2017-11-13 17:28:56.396 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:28:56.396 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:28:58.048 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:28:58.050 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:28:58.051 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:28:58.052 -05:00 [DBG] Start authorize request
2017-11-13 17:28:58.053 -05:00 [DBG] No user present in authorize request
2017-11-13 17:28:58.054 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:28:58.059 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:58.061 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:28:58.062 -05:00 [DBG] No PKCE used.
2017-11-13 17:28:58.065 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:58.069 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:58.073 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:58.077 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:58.079 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:28:58.080 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZntlWRkLhPILON5C3q16MGggrfPUrwiN8VHDfJ2o_KNFtsXZCsXGJyfx20Qra0f1sVvMLHQ4YsDO9PFz8ebuE3h2samG2SBuZp20lupp4TvHTEcSt0GIxHU09O_Cs2a4uO9E6QNTviBbJKHImX38TtAWQ07dPxmobc4mXI1ADt_pik40oLmlu6ywZsYMJWJU2nVDec7OrrjrTuqSQx9pCImFP9n67LiNIJpjmANUvraooHtBVjQnpN3gtNlXpk7L_bX4rLnB0RTpzK7dWecONk",
  "Nonce": "636462089380409818.M2I4NDY0YTQtYmE1Ny00NDUyLWJlMWUtYTMzMGIyOGQ4YmMwNzMzM2I3OGYtMTQ1OC00MDA2LThhNTItYjY2MGIyMzhmYWZl",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089380409818.M2I4NDY0YTQtYmE1Ny00NDUyLWJlMWUtYTMzMGIyOGQ4YmMwNzMzM2I3OGYtMTQ1OC00MDA2LThhNTItYjY2MGIyMzhmYWZl",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZntlWRkLhPILON5C3q16MGggrfPUrwiN8VHDfJ2o_KNFtsXZCsXGJyfx20Qra0f1sVvMLHQ4YsDO9PFz8ebuE3h2samG2SBuZp20lupp4TvHTEcSt0GIxHU09O_Cs2a4uO9E6QNTviBbJKHImX38TtAWQ07dPxmobc4mXI1ADt_pik40oLmlu6ywZsYMJWJU2nVDec7OrrjrTuqSQx9pCImFP9n67LiNIJpjmANUvraooHtBVjQnpN3gtNlXpk7L_bX4rLnB0RTpzK7dWecONk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:28:58.089 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:28:58.097 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:28:59.187 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:28:59.191 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:28:59.192 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:28:59.193 -05:00 [INF] User logged in.
2017-11-13 17:28:59.200 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:59.202 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:28:59.203 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:28:59.204 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:28:59.205 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:28:59.207 -05:00 [DBG] Start authorize callback request
2017-11-13 17:28:59.207 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:28:59.208 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:28:59.214 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.215 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:28:59.216 -05:00 [DBG] No PKCE used.
2017-11-13 17:28:59.218 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:59.222 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:59.224 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:59.228 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:59.229 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:28:59.231 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZntlWRkLhPILON5C3q16MGggrfPUrwiN8VHDfJ2o_KNFtsXZCsXGJyfx20Qra0f1sVvMLHQ4YsDO9PFz8ebuE3h2samG2SBuZp20lupp4TvHTEcSt0GIxHU09O_Cs2a4uO9E6QNTviBbJKHImX38TtAWQ07dPxmobc4mXI1ADt_pik40oLmlu6ywZsYMJWJU2nVDec7OrrjrTuqSQx9pCImFP9n67LiNIJpjmANUvraooHtBVjQnpN3gtNlXpk7L_bX4rLnB0RTpzK7dWecONk",
  "Nonce": "636462089380409818.M2I4NDY0YTQtYmE1Ny00NDUyLWJlMWUtYTMzMGIyOGQ4YmMwNzMzM2I3OGYtMTQ1OC00MDA2LThhNTItYjY2MGIyMzhmYWZl",
  "SessionId": "6a8093fc88a307f858d33d5b1dba0a9f",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089380409818.M2I4NDY0YTQtYmE1Ny00NDUyLWJlMWUtYTMzMGIyOGQ4YmMwNzMzM2I3OGYtMTQ1OC00MDA2LThhNTItYjY2MGIyMzhmYWZl",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZntlWRkLhPILON5C3q16MGggrfPUrwiN8VHDfJ2o_KNFtsXZCsXGJyfx20Qra0f1sVvMLHQ4YsDO9PFz8ebuE3h2samG2SBuZp20lupp4TvHTEcSt0GIxHU09O_Cs2a4uO9E6QNTviBbJKHImX38TtAWQ07dPxmobc4mXI1ADt_pik40oLmlu6ywZsYMJWJU2nVDec7OrrjrTuqSQx9pCImFP9n67LiNIJpjmANUvraooHtBVjQnpN3gtNlXpk7L_bX4rLnB0RTpzK7dWecONk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:28:59.241 -05:00 [DBG] Client is configured to not require consent, no consent is required
2017-11-13 17:28:59.242 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:28:59.252 -05:00 [DBG] fkNtuBjBQs2rOmCoMizkJu/n53x/aX612AgNRR+8UMI= not found in database
2017-11-13 17:28:59.255 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:28:59.255 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:28:59.256 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:28:59.261 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZntlWRkLhPILON5C3q16MGggrfPUrwiN8VHDfJ2o_KNFtsXZCsXGJyfx20Qra0f1sVvMLHQ4YsDO9PFz8ebuE3h2samG2SBuZp20lupp4TvHTEcSt0GIxHU09O_Cs2a4uO9E6QNTviBbJKHImX38TtAWQ07dPxmobc4mXI1ADt_pik40oLmlu6ywZsYMJWJU2nVDec7OrrjrTuqSQx9pCImFP9n67LiNIJpjmANUvraooHtBVjQnpN3gtNlXpk7L_bX4rLnB0RTpzK7dWecONk",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:28:59.266 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:28:59.267 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:28:59.358 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:28:59.361 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:28:59.362 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:28:59.363 -05:00 [DBG] Start token request.
2017-11-13 17:28:59.365 -05:00 [DBG] Start client validation
2017-11-13 17:28:59.365 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:28:59.367 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:28:59.368 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:28:59.370 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:28:59.379 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.381 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:28:59.382 -05:00 [DBG] Client validation success
2017-11-13 17:28:59.385 -05:00 [DBG] Start token request validation
2017-11-13 17:28:59.387 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:28:59.389 -05:00 [DBG] fkNtuBjBQs2rOmCoMizkJu/n53x/aX612AgNRR+8UMI= found in database: true
2017-11-13 17:28:59.406 -05:00 [DBG] removing fkNtuBjBQs2rOmCoMizkJu/n53x/aX612AgNRR+8UMI= persisted grant from database
2017-11-13 17:28:59.411 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:28:59.414 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "65cc9127e66101300c3c0fb9d5392064c8e6338278fa11cbfa72da74fb70e418",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "65cc9127e66101300c3c0fb9d5392064c8e6338278fa11cbfa72da74fb70e418",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:28:59.424 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.427 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:59.432 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:59.434 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:28:59.435 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:28:59.441 -05:00 [DBG] Creating refresh token
2017-11-13 17:28:59.442 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:28:59.459 -05:00 [DBG] 2mTMg8BV/R9w0w0K+pp9sJOLLa1D2JcWZMK5+kBplkE= not found in database
2017-11-13 17:28:59.467 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.472 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:59.482 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:28:59.485 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:28:59.488 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:28:59.497 -05:00 [DBG] Token request success.
2017-11-13 17:28:59.501 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:28:59.503 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:28:59.504 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:28:59.506 -05:00 [DBG] Start userinfo request
2017-11-13 17:28:59.507 -05:00 [DBG] Bearer token found in header
2017-11-13 17:28:59.516 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.523 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:28:59.524 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612139,
    "exp": 1510615739,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612139,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:28:59.532 -05:00 [DBG] Creating userinfo response
2017-11-13 17:28:59.533 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:28:59.536 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:28:59.537 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:28:59.540 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:28:59.542 -05:00 [DBG] End userinfo request
2017-11-13 17:29:00.306 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:00.307 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:00.308 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:29:00.309 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:29:00.310 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:29:00.312 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:00.313 -05:00 [DBG] Start end session request validation
2017-11-13 17:29:00.313 -05:00 [DBG] Start identity token validation
2017-11-13 17:29:00.319 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:00.321 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:29:00.324 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:29:00.326 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612139,
    "exp": 1510612439,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462089380409818.M2I4NDY0YTQtYmE1Ny00NDUyLWJlMWUtYTMzMGIyOGQ4YmMwNzMzM2I3OGYtMTQ1OC00MDA2LThhNTItYjY2MGIyMzhmYWZl",
    "iat": 1510612139,
    "at_hash": "9R7sTqWaeLFIQIZQ4CG8Ig",
    "sid": "6a8093fc88a307f858d33d5b1dba0a9f",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612139,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:29:00.332 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaL9c6Qq1QwMW_7HbT0_KSCm26fhqO_rG-F86K5Mmpk61oYWhWSDvbsVqPiaMBkSeYxrVlI4G03rpRVBmpT7gYKu9Ir13n-X-EHv-zqEqOHzVFfjcPnFgAyTqR5EznMH3_4kaGP9tpcAk5YATviarAA",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTIxMzksImV4cCI6MTUxMDYxMjQzOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDg5MzgwNDA5ODE4Lk0ySTRORFkwWVRRdFltRTFOeTAwTkRVeUxXSmxNV1V0WVRNek1HSXlPR1E0WW1Nd056TXpNMkkzT0dZdE1UUTFPQzAwTURBMkxUaGhOVEl0WWpZMk1HSXlNemhtWVdabCIsImlhdCI6MTUxMDYxMjEzOSwiYXRfaGFzaCI6IjlSN3NUcVdhZUxGSVFJWlE0Q0c4SWciLCJzaWQiOiI2YTgwOTNmYzg4YTMwN2Y4NThkMzNkNWIxZGJhMGE5ZiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjEzOSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.u4bx0HTOa36fsjh-Rn2gphhHOvWk0LSqob0qlH-fvUBBWQg8Ebctiqve0nzeyQhJLdj6DUj9aCfv2NuvDWBsgfHzg1n8Yu_udGPY0IYtSwtdOIc3IJvF6HXHgDj49t7dpcb3M2DcvXxzLXh8QGhDVKN3lkkgV6bZk95a0YERvC4U32hs8BQWX7-SZHYkfpFFjwzc0yws_mULdT63U7REEkAK-mKdmGYabLtGRHCy6InyjRzO-K68d8jmgGmWKEHof_pRfdpELxyHIhm-Lp359SDXi0qDFtS-npThv4KoHl3B1h7GzBaG6HjvA-R_EtbikJshbz_hm0LnJY_ghKHLZQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaL9c6Qq1QwMW_7HbT0_KSCm26fhqO_rG-F86K5Mmpk61oYWhWSDvbsVqPiaMBkSeYxrVlI4G03rpRVBmpT7gYKu9Ir13n-X-EHv-zqEqOHzVFfjcPnFgAyTqR5EznMH3_4kaGP9tpcAk5YATviarAA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:00.341 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:29:00.347 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:00.348 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:00.350 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:29:00.351 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:00.352 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:29:00.352 -05:00 [INF] User logged out.
2017-11-13 17:29:00.420 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:29:00.422 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:29:00.423 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:29:00.424 -05:00 [DBG] Processing signout callback request
2017-11-13 17:29:00.434 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:00.435 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:29:00.437 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:29:00.438 -05:00 [INF] Successful signout callback.
2017-11-13 17:29:00.440 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:29:00.441 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:29:03.680 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:29:03.681 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:29:03.682 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:29:03.684 -05:00 [DBG] Start authorize request
2017-11-13 17:29:03.684 -05:00 [DBG] No user present in authorize request
2017-11-13 17:29:03.685 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:29:03.689 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:03.690 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:29:03.691 -05:00 [DBG] No PKCE used.
2017-11-13 17:29:03.693 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:03.699 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:03.701 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:03.705 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:03.707 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:29:03.708 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ1iGrsEw0o-FNIbSaeBujRxkkvwZhfWJL7MERGgvJHXq5bk9bGuJuZBsEsbAbU9gTXP5x3a2Wk4U2RGhiG8gxuyRt34u8MjJ2vLS3Q9MOpAJeb6TOiyOnkscrBOxJiIDm8qoLu59AS9boqO73hBB1OUI3XmlEryyRJXKqztnCEST76m_2R5CrAB3EzQj_6KHM9VavEahRx-JokT1drI1mi1YN7Es-fRsGPHn9IyAek11mR2rnu-HUMg6NKJ1A41VEwks7uE6fLX0XdrgxsBEhK",
  "Nonce": "636462089436726654.NDQ1OGE2OWEtZmY2Ny00NThiLWFiN2MtMDQzOGMxOWNiMDgyODZkNTMzN2YtOWU5NS00Nzg0LWFmMjAtMmJmOGI1YzBhN2Jk",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089436726654.NDQ1OGE2OWEtZmY2Ny00NThiLWFiN2MtMDQzOGMxOWNiMDgyODZkNTMzN2YtOWU5NS00Nzg0LWFmMjAtMmJmOGI1YzBhN2Jk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ1iGrsEw0o-FNIbSaeBujRxkkvwZhfWJL7MERGgvJHXq5bk9bGuJuZBsEsbAbU9gTXP5x3a2Wk4U2RGhiG8gxuyRt34u8MjJ2vLS3Q9MOpAJeb6TOiyOnkscrBOxJiIDm8qoLu59AS9boqO73hBB1OUI3XmlEryyRJXKqztnCEST76m_2R5CrAB3EzQj_6KHM9VavEahRx-JokT1drI1mi1YN7Es-fRsGPHn9IyAek11mR2rnu-HUMg6NKJ1A41VEwks7uE6fLX0XdrgxsBEhK",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:03.720 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:29:03.727 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:05.188 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:29:05.191 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:29:05.192 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:29:05.193 -05:00 [INF] User logged in.
2017-11-13 17:29:05.201 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:05.203 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:05.204 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:29:05.205 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:29:05.207 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:29:05.209 -05:00 [DBG] Start authorize callback request
2017-11-13 17:29:05.210 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:05.211 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:29:05.217 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.218 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:29:05.218 -05:00 [DBG] No PKCE used.
2017-11-13 17:29:05.221 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:05.226 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:05.229 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:05.235 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:05.237 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:29:05.238 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ1iGrsEw0o-FNIbSaeBujRxkkvwZhfWJL7MERGgvJHXq5bk9bGuJuZBsEsbAbU9gTXP5x3a2Wk4U2RGhiG8gxuyRt34u8MjJ2vLS3Q9MOpAJeb6TOiyOnkscrBOxJiIDm8qoLu59AS9boqO73hBB1OUI3XmlEryyRJXKqztnCEST76m_2R5CrAB3EzQj_6KHM9VavEahRx-JokT1drI1mi1YN7Es-fRsGPHn9IyAek11mR2rnu-HUMg6NKJ1A41VEwks7uE6fLX0XdrgxsBEhK",
  "Nonce": "636462089436726654.NDQ1OGE2OWEtZmY2Ny00NThiLWFiN2MtMDQzOGMxOWNiMDgyODZkNTMzN2YtOWU5NS00Nzg0LWFmMjAtMmJmOGI1YzBhN2Jk",
  "SessionId": "a6a43e2ea82861ec825214c9502def58",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089436726654.NDQ1OGE2OWEtZmY2Ny00NThiLWFiN2MtMDQzOGMxOWNiMDgyODZkNTMzN2YtOWU5NS00Nzg0LWFmMjAtMmJmOGI1YzBhN2Jk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ1iGrsEw0o-FNIbSaeBujRxkkvwZhfWJL7MERGgvJHXq5bk9bGuJuZBsEsbAbU9gTXP5x3a2Wk4U2RGhiG8gxuyRt34u8MjJ2vLS3Q9MOpAJeb6TOiyOnkscrBOxJiIDm8qoLu59AS9boqO73hBB1OUI3XmlEryyRJXKqztnCEST76m_2R5CrAB3EzQj_6KHM9VavEahRx-JokT1drI1mi1YN7Es-fRsGPHn9IyAek11mR2rnu-HUMg6NKJ1A41VEwks7uE6fLX0XdrgxsBEhK",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:05.251 -05:00 [DBG] Client is configured to not require consent, no consent is required
2017-11-13 17:29:05.252 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:29:05.262 -05:00 [DBG] pTxWNLN1bOafCNE0SwzQW2DGTK8S9fcsPMYCkOiw9ok= not found in database
2017-11-13 17:29:05.265 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:29:05.266 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:29:05.267 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:29:05.273 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ1iGrsEw0o-FNIbSaeBujRxkkvwZhfWJL7MERGgvJHXq5bk9bGuJuZBsEsbAbU9gTXP5x3a2Wk4U2RGhiG8gxuyRt34u8MjJ2vLS3Q9MOpAJeb6TOiyOnkscrBOxJiIDm8qoLu59AS9boqO73hBB1OUI3XmlEryyRJXKqztnCEST76m_2R5CrAB3EzQj_6KHM9VavEahRx-JokT1drI1mi1YN7Es-fRsGPHn9IyAek11mR2rnu-HUMg6NKJ1A41VEwks7uE6fLX0XdrgxsBEhK",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:29:05.277 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:29:05.278 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:29:05.356 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:29:05.359 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:29:05.360 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:29:05.362 -05:00 [DBG] Start token request.
2017-11-13 17:29:05.363 -05:00 [DBG] Start client validation
2017-11-13 17:29:05.364 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:29:05.364 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:29:05.366 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:29:05.368 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:29:05.377 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.378 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:29:05.379 -05:00 [DBG] Client validation success
2017-11-13 17:29:05.380 -05:00 [DBG] Start token request validation
2017-11-13 17:29:05.381 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:29:05.383 -05:00 [DBG] pTxWNLN1bOafCNE0SwzQW2DGTK8S9fcsPMYCkOiw9ok= found in database: true
2017-11-13 17:29:05.393 -05:00 [DBG] removing pTxWNLN1bOafCNE0SwzQW2DGTK8S9fcsPMYCkOiw9ok= persisted grant from database
2017-11-13 17:29:05.397 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:29:05.398 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "efb6a8c9c6fce6d918a017ed628f0fd90b1b434b676a6eacd71dba76f1653f49",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "efb6a8c9c6fce6d918a017ed628f0fd90b1b434b676a6eacd71dba76f1653f49",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:29:05.407 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.411 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:05.416 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:05.417 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:29:05.418 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:05.424 -05:00 [DBG] Creating refresh token
2017-11-13 17:29:05.426 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:29:05.435 -05:00 [DBG] q9XKuPjB1u++jzr5w5Vt9doY6Ql0kMKvM9jAKyKJXTQ= not found in database
2017-11-13 17:29:05.441 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.445 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:05.449 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:05.451 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:29:05.452 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:29:05.457 -05:00 [DBG] Token request success.
2017-11-13 17:29:05.462 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:29:05.465 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:29:05.466 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:29:05.467 -05:00 [DBG] Start userinfo request
2017-11-13 17:29:05.468 -05:00 [DBG] Bearer token found in header
2017-11-13 17:29:05.476 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.483 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:05.485 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612145,
    "exp": 1510615745,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612145,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:29:05.494 -05:00 [DBG] Creating userinfo response
2017-11-13 17:29:05.496 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:29:05.498 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:05.500 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:29:05.502 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:29:05.504 -05:00 [DBG] End userinfo request
2017-11-13 17:29:06.144 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:06.146 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:07.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:07.648 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:07.672 -05:00 [DBG] 5 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:07.699 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:07.702 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:07.707 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:09.065 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:09.067 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:09.084 -05:00 [DBG] removing 5 persisted grants from database for subject cf559f42-d46a-4dea-9390-b50e0f71a84e, clientId mvc.hybrid
2017-11-13 17:29:09.115 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:09.116 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:09.118 -05:00 [DBG] 0 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:10.496 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:10.498 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:10.500 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:29:10.501 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:10.502 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:29:10.502 -05:00 [INF] User logged out.
2017-11-13 17:29:10.564 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:29:10.565 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:29:10.566 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:29:10.568 -05:00 [DBG] Processing signout callback request
2017-11-13 17:29:10.573 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:10.574 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:29:10.574 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:29:10.575 -05:00 [INF] Successful signout callback.
2017-11-13 17:29:10.575 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:29:10.577 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:29:15.522 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:29:15.524 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:29:15.525 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:29:15.526 -05:00 [DBG] Processing signout request for anonymous
2017-11-13 17:29:15.527 -05:00 [DBG] Start end session request validation
2017-11-13 17:29:15.528 -05:00 [DBG] Start identity token validation
2017-11-13 17:29:15.535 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:15.537 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:29:15.540 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:29:15.544 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612145,
    "exp": 1510612445,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462089436726654.NDQ1OGE2OWEtZmY2Ny00NThiLWFiN2MtMDQzOGMxOWNiMDgyODZkNTMzN2YtOWU5NS00Nzg0LWFmMjAtMmJmOGI1YzBhN2Jk",
    "iat": 1510612145,
    "at_hash": "YNONpko3t0uh8mxBBeV04g",
    "sid": "a6a43e2ea82861ec825214c9502def58",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612145,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:29:15.550 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va2tTbhApbdf89MAVBhX0X2NSebNEjonr7pbpn7tEVAtNR7UJPX-Eur2Qwo-Qcb0N9fckxh7wZPQUumpGCQ_E5JmNOFRwpBEZMFLIDL6NNyMePUnfCuWCFYh11HmslrZRVp8gDb-8hk-bKc6QJr8fHA",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTIxNDUsImV4cCI6MTUxMDYxMjQ0NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDg5NDM2NzI2NjU0Lk5EUTFPR0UyT1dFdFptWTJOeTAwTlRoaUxXRmlOMk10TURRek9HTXhPV05pTURneU9EWmtOVE16TjJZdE9XVTVOUzAwTnpnMExXRm1NakF0TW1KbU9HSTFZekJoTjJKayIsImlhdCI6MTUxMDYxMjE0NSwiYXRfaGFzaCI6IllOT05wa28zdDB1aDhteEJCZVYwNGciLCJzaWQiOiJhNmE0M2UyZWE4Mjg2MWVjODI1MjE0Yzk1MDJkZWY1OCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjE0NSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Vhwx3JU6Sv6BbDOsa_PVHlX7wQbT3y2znylDobB3IUAMOsdZslpnYSt708UVFeX-g4Qum_xpixyATmKLQUBFRvlt7cdAZBcMj9SWqCJcaU9acAmOe3eYG84UIcPCCrrZuJAl9qOpaJCJdKXU3BD35Y9PpuEARLYnhQ_C-hRj8VdpKaI17e6NChTIcu8D7EKSCUimS-Fgl1GAfk5bXanGeNQbyU2jSXt2jLBctpDrdTORrKnJr5pn2Mv2rMZyOkTldPtEvACnYYBlWBo49uJul-WCErUPXeeTKS6Vj63J0bRoNYfu1vMnnOvg10sOeallAX4L6Vw-Qc_2_ELrvhkI6A",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va2tTbhApbdf89MAVBhX0X2NSebNEjonr7pbpn7tEVAtNR7UJPX-Eur2Qwo-Qcb0N9fckxh7wZPQUumpGCQ_E5JmNOFRwpBEZMFLIDL6NNyMePUnfCuWCFYh11HmslrZRVp8gDb-8hk-bKc6QJr8fHA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:15.558 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:29:15.565 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:29:15.567 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:15.568 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:29:15.568 -05:00 [INF] User logged out.
2017-11-13 17:29:16.750 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:29:16.751 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:29:16.752 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:29:16.753 -05:00 [DBG] Start authorize request
2017-11-13 17:29:16.754 -05:00 [DBG] No user present in authorize request
2017-11-13 17:29:16.754 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:29:16.759 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:16.760 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:29:16.761 -05:00 [DBG] No PKCE used.
2017-11-13 17:29:16.765 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:16.770 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:16.774 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:16.778 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:16.779 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:29:16.780 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZP4gR1lZN1JzF83pkdcarEs1NXL3rN3XnZYiWMcfynsTG31p9raIrEkmatP5XuRIxFkVE2-NALQW5wYWYL3TzzQTK9rH9L3cJv5RUXm-yUFsmIkEItbt4OU9RPuF-uteFgnwreha2EBPNqPek-NM6S8mptNQpX3dAgoOAQNEpArgW3l_XPzMg6RufOzBacw4ZhxU_NAHJgplB6-iF96lkvZlzbyTgUrs-YQTKewnY-uKjjkKLDQCZeGQwSrBph7rPIkl7sdyagpJsNkQ1PCJ1j",
  "Nonce": "636462089567437230.YTM5ZTIwMjctYjY4My00YTBkLTlhZDktODI3NGRkNzQ4ZDljZThlZjY0ZTgtNWUzYS00MjE3LWFlZjgtNzlhZjJlNzdjYjFi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089567437230.YTM5ZTIwMjctYjY4My00YTBkLTlhZDktODI3NGRkNzQ4ZDljZThlZjY0ZTgtNWUzYS00MjE3LWFlZjgtNzlhZjJlNzdjYjFi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZP4gR1lZN1JzF83pkdcarEs1NXL3rN3XnZYiWMcfynsTG31p9raIrEkmatP5XuRIxFkVE2-NALQW5wYWYL3TzzQTK9rH9L3cJv5RUXm-yUFsmIkEItbt4OU9RPuF-uteFgnwreha2EBPNqPek-NM6S8mptNQpX3dAgoOAQNEpArgW3l_XPzMg6RufOzBacw4ZhxU_NAHJgplB6-iF96lkvZlzbyTgUrs-YQTKewnY-uKjjkKLDQCZeGQwSrBph7rPIkl7sdyagpJsNkQ1PCJ1j",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:16.789 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:29:16.795 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:25.162 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:29:25.168 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:29:25.169 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:29:25.170 -05:00 [INF] User logged in.
2017-11-13 17:29:25.176 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:25.178 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:25.179 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:29:25.180 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:29:25.182 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:29:25.183 -05:00 [DBG] Start authorize callback request
2017-11-13 17:29:25.184 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:25.185 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:29:25.189 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.190 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:29:25.191 -05:00 [DBG] No PKCE used.
2017-11-13 17:29:25.194 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:25.198 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:25.201 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:25.204 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:25.205 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:29:25.206 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZP4gR1lZN1JzF83pkdcarEs1NXL3rN3XnZYiWMcfynsTG31p9raIrEkmatP5XuRIxFkVE2-NALQW5wYWYL3TzzQTK9rH9L3cJv5RUXm-yUFsmIkEItbt4OU9RPuF-uteFgnwreha2EBPNqPek-NM6S8mptNQpX3dAgoOAQNEpArgW3l_XPzMg6RufOzBacw4ZhxU_NAHJgplB6-iF96lkvZlzbyTgUrs-YQTKewnY-uKjjkKLDQCZeGQwSrBph7rPIkl7sdyagpJsNkQ1PCJ1j",
  "Nonce": "636462089567437230.YTM5ZTIwMjctYjY4My00YTBkLTlhZDktODI3NGRkNzQ4ZDljZThlZjY0ZTgtNWUzYS00MjE3LWFlZjgtNzlhZjJlNzdjYjFi",
  "SessionId": "f7a1f68e90d0d08bfa19522ba619d104",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462089567437230.YTM5ZTIwMjctYjY4My00YTBkLTlhZDktODI3NGRkNzQ4ZDljZThlZjY0ZTgtNWUzYS00MjE3LWFlZjgtNzlhZjJlNzdjYjFi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZP4gR1lZN1JzF83pkdcarEs1NXL3rN3XnZYiWMcfynsTG31p9raIrEkmatP5XuRIxFkVE2-NALQW5wYWYL3TzzQTK9rH9L3cJv5RUXm-yUFsmIkEItbt4OU9RPuF-uteFgnwreha2EBPNqPek-NM6S8mptNQpX3dAgoOAQNEpArgW3l_XPzMg6RufOzBacw4ZhxU_NAHJgplB6-iF96lkvZlzbyTgUrs-YQTKewnY-uKjjkKLDQCZeGQwSrBph7rPIkl7sdyagpJsNkQ1PCJ1j",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:25.218 -05:00 [DBG] Client is configured to not require consent, no consent is required
2017-11-13 17:29:25.218 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:29:25.227 -05:00 [DBG] yop27eDsFx67ujDzdGFehzgsA8UiRJpDvxnHzLYpA3I= not found in database
2017-11-13 17:29:25.230 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:29:25.231 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:29:25.232 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:29:25.236 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZP4gR1lZN1JzF83pkdcarEs1NXL3rN3XnZYiWMcfynsTG31p9raIrEkmatP5XuRIxFkVE2-NALQW5wYWYL3TzzQTK9rH9L3cJv5RUXm-yUFsmIkEItbt4OU9RPuF-uteFgnwreha2EBPNqPek-NM6S8mptNQpX3dAgoOAQNEpArgW3l_XPzMg6RufOzBacw4ZhxU_NAHJgplB6-iF96lkvZlzbyTgUrs-YQTKewnY-uKjjkKLDQCZeGQwSrBph7rPIkl7sdyagpJsNkQ1PCJ1j",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:29:25.241 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:29:25.242 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:29:25.325 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:29:25.327 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:29:25.328 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:29:25.329 -05:00 [DBG] Start token request.
2017-11-13 17:29:25.330 -05:00 [DBG] Start client validation
2017-11-13 17:29:25.331 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:29:25.331 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:29:25.332 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:29:25.333 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:29:25.342 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.344 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:29:25.345 -05:00 [DBG] Client validation success
2017-11-13 17:29:25.346 -05:00 [DBG] Start token request validation
2017-11-13 17:29:25.347 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:29:25.352 -05:00 [DBG] yop27eDsFx67ujDzdGFehzgsA8UiRJpDvxnHzLYpA3I= found in database: true
2017-11-13 17:29:25.364 -05:00 [DBG] removing yop27eDsFx67ujDzdGFehzgsA8UiRJpDvxnHzLYpA3I= persisted grant from database
2017-11-13 17:29:25.368 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:29:25.369 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "4500b9d060c4fa70ea517821cdddef3d98bab1bac128eeb51e6b32d1ba71859b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "4500b9d060c4fa70ea517821cdddef3d98bab1bac128eeb51e6b32d1ba71859b",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:29:25.378 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.381 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:25.387 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:25.388 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:29:25.389 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:25.394 -05:00 [DBG] Creating refresh token
2017-11-13 17:29:25.396 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:29:25.405 -05:00 [DBG] Rmi7bBKtDbIiGKwWnRTf+dOyVc/6ZQlMD3B+dvjXvNI= not found in database
2017-11-13 17:29:25.411 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.416 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:25.422 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:29:25.424 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:29:25.425 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:29:25.431 -05:00 [DBG] Token request success.
2017-11-13 17:29:25.434 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:29:25.435 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:29:25.436 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:29:25.437 -05:00 [DBG] Start userinfo request
2017-11-13 17:29:25.438 -05:00 [DBG] Bearer token found in header
2017-11-13 17:29:25.445 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.452 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:25.455 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612165,
    "exp": 1510615765,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612165,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:29:25.462 -05:00 [DBG] Creating userinfo response
2017-11-13 17:29:25.463 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:29:25.466 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:29:25.467 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:29:25.469 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:29:25.470 -05:00 [DBG] End userinfo request
2017-11-13 17:29:28.626 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:28.627 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:28.628 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:29:28.629 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:29:28.630 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:29:28.632 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:29:28.633 -05:00 [DBG] Start end session request validation
2017-11-13 17:29:28.634 -05:00 [DBG] Start identity token validation
2017-11-13 17:29:28.639 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:28.640 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:29:28.642 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:29:28.646 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612165,
    "exp": 1510612465,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462089567437230.YTM5ZTIwMjctYjY4My00YTBkLTlhZDktODI3NGRkNzQ4ZDljZThlZjY0ZTgtNWUzYS00MjE3LWFlZjgtNzlhZjJlNzdjYjFi",
    "iat": 1510612165,
    "at_hash": "QUyQrr3F0_9gjrEoWAcAWw",
    "sid": "f7a1f68e90d0d08bfa19522ba619d104",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612165,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:29:28.652 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbMwGcNF2Rg6FAEjWFtOuUBeOLRfPUZbctmxW07NJFfOD42tQfax_BUPAZeEVAICldcGPVuST0fVCWFShIxjML8yjjTYfLMs8Za_p9vb5XuqKuJC10XNpA7WoiNXFRQYnmgGT8c9C9AujJToZoQKxAU",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTIxNjUsImV4cCI6MTUxMDYxMjQ2NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDg5NTY3NDM3MjMwLllUTTVaVEl3TWpjdFlqWTRNeTAwWVRCa0xUbGhaRGt0T0RJM05HUmtOelE0WkRsalpUaGxaalkwWlRndE5XVXpZUzAwTWpFM0xXRmxaamd0TnpsaFpqSmxOemRqWWpGaSIsImlhdCI6MTUxMDYxMjE2NSwiYXRfaGFzaCI6IlFVeVFycjNGMF85Z2pyRW9XQWNBV3ciLCJzaWQiOiJmN2ExZjY4ZTkwZDBkMDhiZmExOTUyMmJhNjE5ZDEwNCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjE2NSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.H7qfQfTZtR9vSfoHTJTQGNwGenltomuom1w0YjfeBi_zLeq3XCuyjl6yydPc9mGGvaTaZC5QlfnLgl3bEu5XFRevDNzPKoHstopMk2Ku7YBe5RTgUwWrOASGJlhlpajIb3134lXQ_vZxj_8MpL3sWL7Eke27k0OQTcr9mg2ImoIUuRu9e4OpZe2PyuOShN3tbQYP83ondA6MqCIoUiNccJOkP9_B302b839_Ai6FpoPtIQA_TNZcNoGPav_O6Xx5fdX5DUxjgpJihfd1LkJsZ5jN_9jvEZp-1uOm9sxZdTS9JJM2qVdQHdHefJDprQAO7JPqkqw4WsdkmSFwxAJtlA",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbMwGcNF2Rg6FAEjWFtOuUBeOLRfPUZbctmxW07NJFfOD42tQfax_BUPAZeEVAICldcGPVuST0fVCWFShIxjML8yjjTYfLMs8Za_p9vb5XuqKuJC10XNpA7WoiNXFRQYnmgGT8c9C9AujJToZoQKxAU",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:29:28.660 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:29:28.666 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:28.667 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:29:28.669 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:29:28.670 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:29:28.671 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:29:28.671 -05:00 [INF] User logged out.
2017-11-13 17:29:28.741 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:29:28.743 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:29:28.745 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:29:28.747 -05:00 [DBG] Processing signout callback request
2017-11-13 17:29:28.754 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:29:28.755 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:29:28.757 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:29:28.757 -05:00 [INF] Successful signout callback.
2017-11-13 17:29:28.758 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:29:28.759 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:32:57.114 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:32:57.117 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:32:57.119 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:32:57.121 -05:00 [DBG] Start authorize request
2017-11-13 17:32:57.121 -05:00 [DBG] No user present in authorize request
2017-11-13 17:32:57.122 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:32:57.146 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:32:57.147 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:32:57.148 -05:00 [DBG] No PKCE used.
2017-11-13 17:32:57.154 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:57.217 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:57.220 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:57.224 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:57.226 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:32:57.227 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb5cNRMCo-ZDjDymsTLHPwY3_-pI-VfTVBOvZb7docyqXPAHNlpEMCZgYKDjGh_4pihYhjHirAaRKZqyGYWw34Q1D422iF6RzP8vB75k6F6QRcXRb2bBdq5vNLv88OO0R1mzB7YM-6g2RE0Aj-15ir98utSx1X0R-h4k4gIdtVDf07LdQ93pPAzfySh_6LVgQMv9SP-FnC8ILiCA2NMJxxwRTMohRgr4E8LLBg4wpkIa62E_QKtP-vvCAX1aPEduyrqsO6xQlnve2jMkK6robA_",
  "Nonce": "636462091770899191.NDNiZmYwYjMtZmZkOC00Mzk5LWI0M2UtMWEyMmUwMzZiMjBkNTk3ZWE5ZGUtODZlMy00ODZlLTlkZjctMGI5YmJiZTY1NzVj",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462091770899191.NDNiZmYwYjMtZmZkOC00Mzk5LWI0M2UtMWEyMmUwMzZiMjBkNTk3ZWE5ZGUtODZlMy00ODZlLTlkZjctMGI5YmJiZTY1NzVj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb5cNRMCo-ZDjDymsTLHPwY3_-pI-VfTVBOvZb7docyqXPAHNlpEMCZgYKDjGh_4pihYhjHirAaRKZqyGYWw34Q1D422iF6RzP8vB75k6F6QRcXRb2bBdq5vNLv88OO0R1mzB7YM-6g2RE0Aj-15ir98utSx1X0R-h4k4gIdtVDf07LdQ93pPAzfySh_6LVgQMv9SP-FnC8ILiCA2NMJxxwRTMohRgr4E8LLBg4wpkIa62E_QKtP-vvCAX1aPEduyrqsO6xQlnve2jMkK6robA_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:32:57.236 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:32:57.243 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:32:58.928 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:32:58.934 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:32:58.935 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:32:58.936 -05:00 [INF] User logged in.
2017-11-13 17:32:58.944 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:32:58.945 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:32:58.946 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:32:58.947 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:32:58.948 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:32:58.949 -05:00 [DBG] Start authorize callback request
2017-11-13 17:32:58.950 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:32:58.951 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:32:58.957 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:32:58.959 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:32:58.959 -05:00 [DBG] No PKCE used.
2017-11-13 17:32:58.962 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:58.966 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:58.968 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:58.973 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:58.974 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:32:58.975 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb5cNRMCo-ZDjDymsTLHPwY3_-pI-VfTVBOvZb7docyqXPAHNlpEMCZgYKDjGh_4pihYhjHirAaRKZqyGYWw34Q1D422iF6RzP8vB75k6F6QRcXRb2bBdq5vNLv88OO0R1mzB7YM-6g2RE0Aj-15ir98utSx1X0R-h4k4gIdtVDf07LdQ93pPAzfySh_6LVgQMv9SP-FnC8ILiCA2NMJxxwRTMohRgr4E8LLBg4wpkIa62E_QKtP-vvCAX1aPEduyrqsO6xQlnve2jMkK6robA_",
  "Nonce": "636462091770899191.NDNiZmYwYjMtZmZkOC00Mzk5LWI0M2UtMWEyMmUwMzZiMjBkNTk3ZWE5ZGUtODZlMy00ODZlLTlkZjctMGI5YmJiZTY1NzVj",
  "SessionId": "05d1932c25f97097629a1194ddce0c72",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462091770899191.NDNiZmYwYjMtZmZkOC00Mzk5LWI0M2UtMWEyMmUwMzZiMjBkNTk3ZWE5ZGUtODZlMy00ODZlLTlkZjctMGI5YmJiZTY1NzVj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb5cNRMCo-ZDjDymsTLHPwY3_-pI-VfTVBOvZb7docyqXPAHNlpEMCZgYKDjGh_4pihYhjHirAaRKZqyGYWw34Q1D422iF6RzP8vB75k6F6QRcXRb2bBdq5vNLv88OO0R1mzB7YM-6g2RE0Aj-15ir98utSx1X0R-h4k4gIdtVDf07LdQ93pPAzfySh_6LVgQMv9SP-FnC8ILiCA2NMJxxwRTMohRgr4E8LLBg4wpkIa62E_QKtP-vvCAX1aPEduyrqsO6xQlnve2jMkK6robA_",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:32:58.986 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:32:58.987 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:32:58.993 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:32:58.994 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:32:58.995 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:32:59.000 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:32:59.002 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:32:59.003 -05:00 [DBG] No PKCE used.
2017-11-13 17:32:59.005 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:59.010 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:59.011 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:59.015 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:32:59.016 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:32:59.020 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:32:59.026 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:32:59.088 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:33:26.410 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:33:26.437 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:33:26.438 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:33:26.438 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:33:26.439 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:33:26.522 -05:00 [DBG] Starting token cleanup
2017-11-13 17:33:44.619 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 17:33:44.629 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 17:33:44.631 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 17:33:44.634 -05:00 [DBG] Start discovery request
2017-11-13 17:33:45.048 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 17:33:45.258 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 17:33:45.260 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 17:33:45.261 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 17:33:45.266 -05:00 [DBG] Start key discovery request
2017-11-13 17:33:45.322 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:33:45.323 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:33:45.324 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:33:45.329 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:33:45.330 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:33:45.334 -05:00 [DBG] Start authorize request
2017-11-13 17:33:45.344 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:33:45.349 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:33:45.592 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:33:45.599 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:33:45.601 -05:00 [DBG] No PKCE used.
2017-11-13 17:33:45.626 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:33:45.661 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:33:45.673 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:33:45.678 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:33:45.686 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:33:45.700 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYMWwT7adFx80Q4XVmXh-C1V2mgr-R3ZgFOaD_L6ZMo3MPXp73MrAWTclqIw4INPPOsK4n5ucPy0993Nv4AM1PtLs1A0_PmIoa4wYL7UWjScd9ejau4iY6OVVAUeisF5DOIfUPsoWRTOylIHWp4bDgytu4BVg9v5c1RR4ef-Hg_V45oF7QMf7L4v5j5_ShWCagBYtEqqGEAX1DruC8NT0Vtr_TlFo0dqYYHWF8axOl-Sgf4xqkNzHGU2pRx-Fq2YsUj1F6Y3SnARvLgVm2mgja3",
  "Nonce": "636462092253089541.YmIxM2MxM2YtMjM1OS00YjdkLTlkZjUtOTczODg1ZDFjZDQzYTg1MTgyODQtM2QxOC00ODlhLWI1NDktODI0OWRhYzgxNmE2",
  "SessionId": "05d1932c25f97097629a1194ddce0c72",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092253089541.YmIxM2MxM2YtMjM1OS00YjdkLTlkZjUtOTczODg1ZDFjZDQzYTg1MTgyODQtM2QxOC00ODlhLWI1NDktODI0OWRhYzgxNmE2",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYMWwT7adFx80Q4XVmXh-C1V2mgr-R3ZgFOaD_L6ZMo3MPXp73MrAWTclqIw4INPPOsK4n5ucPy0993Nv4AM1PtLs1A0_PmIoa4wYL7UWjScd9ejau4iY6OVVAUeisF5DOIfUPsoWRTOylIHWp4bDgytu4BVg9v5c1RR4ef-Hg_V45oF7QMf7L4v5j5_ShWCagBYtEqqGEAX1DruC8NT0Vtr_TlFo0dqYYHWF8axOl-Sgf4xqkNzHGU2pRx-Fq2YsUj1F6Y3SnARvLgVm2mgja3",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:33:45.767 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:33:45.768 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:33:45.795 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:33:45.797 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:33:45.907 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:33:45.913 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:33:45.914 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:33:45.915 -05:00 [DBG] No PKCE used.
2017-11-13 17:33:45.917 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:33:45.921 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:33:45.924 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:33:45.927 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:33:45.928 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:33:45.934 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:33:45.936 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:33:45.941 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:02.643 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:34:02.645 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:34:02.646 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:34:02.648 -05:00 [DBG] Start authorize request
2017-11-13 17:34:02.649 -05:00 [DBG] No user present in authorize request
2017-11-13 17:34:02.650 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:02.679 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:02.680 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:02.681 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:02.689 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:02.753 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:02.756 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:02.760 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:02.761 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:02.762 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
  "Nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:02.772 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:34:02.796 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:34:05.618 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 17:34:05.634 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:34:15.717 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:34:15.722 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:34:15.730 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:34:15.733 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 17:34:15.788 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:34:15.793 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:34:15.794 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 17:34:15.800 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:15.802 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:15.802 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:34:15.804 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:34:15.806 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:34:15.811 -05:00 [DBG] Start authorize callback request
2017-11-13 17:34:15.816 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:15.817 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:15.823 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:15.824 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:15.825 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:15.828 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:15.832 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:15.834 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:15.838 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:15.839 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:15.840 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
  "Nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
  "SessionId": "c54c6ed630f06dda421fe2a48dde1400",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:15.852 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:34:15.853 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:34:15.875 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:15.876 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:15.878 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:15.883 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:15.884 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:15.884 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:15.887 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:15.891 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:15.893 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:15.897 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:15.898 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:15.902 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:15.907 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:15.972 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:17.507 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:17.509 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:17.524 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:17.533 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:17.534 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:17.535 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:17.538 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:17.542 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:17.544 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:17.547 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:17.548 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:17.567 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:17.568 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:17.569 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:34:17.570 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:34:17.572 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:34:17.573 -05:00 [DBG] Start authorize callback request
2017-11-13 17:34:17.596 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:17.598 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:17.603 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:17.604 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:17.605 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:17.608 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:17.613 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:17.615 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:17.618 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:17.619 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:17.621 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
  "Nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
  "SessionId": "c54c6ed630f06dda421fe2a48dde1400",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092426344424.Y2MyZjAxOGMtYmE4OS00OGQ0LWJhYzAtODVkYmY0YzU0OWIyYmFmZWRiMDQtYjZjZS00ZmZhLWJmZjItOTI4MTVhOWI1OTc0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:17.634 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:34:17.639 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:34:17.643 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:34:17.648 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:17.679 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 17:34:17.723 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:34:17.745 -05:00 [DBG] wUrcRwNFcyUztEwYAJE8ewc9yFZ0fHR3d2obWUTc6cE= not found in database
2017-11-13 17:34:17.751 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:34:17.760 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:34:17.763 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:34:17.801 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY6POQOpM2lZ759vaI9DG-rK_9W7X7bGRNx-J4VXRlU_6JKt8isURsNeKLRvnOZoMB-WMyd9aSum8R3c7g3jLKT9Z59KjNaIPjXqlAbFCB2giteB1pJ5hVUydz79cpwHVNtYdQb_qsMqaLPT3uFRSLtnsKb6DUsaDSsCoCir5brGZhRhIXKjlDwoLlmy3UBQWz6DyD-SMsrpSu8cZ5yZBjKsIRfCoSxTW73KXnpuAfPGdBjk_jyaT3GBH4untJViNdA7K_rWfxV-4Vt0MS5i7rb",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:34:17.819 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:34:17.821 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:34:18.102 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:34:18.107 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:34:18.108 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:34:18.116 -05:00 [DBG] Start token request.
2017-11-13 17:34:18.123 -05:00 [DBG] Start client validation
2017-11-13 17:34:18.129 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:34:18.133 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:34:18.135 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:34:18.136 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:34:18.141 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:18.150 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:34:18.152 -05:00 [DBG] Client validation success
2017-11-13 17:34:18.159 -05:00 [DBG] Start token request validation
2017-11-13 17:34:18.171 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:34:18.187 -05:00 [DBG] wUrcRwNFcyUztEwYAJE8ewc9yFZ0fHR3d2obWUTc6cE= found in database: true
2017-11-13 17:34:18.210 -05:00 [DBG] removing wUrcRwNFcyUztEwYAJE8ewc9yFZ0fHR3d2obWUTc6cE= persisted grant from database
2017-11-13 17:34:18.216 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:34:18.222 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "21576bae03f5cd704b8076f22ebf21bd5b1193c80901e8c818e4c3ebdd93b500",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "21576bae03f5cd704b8076f22ebf21bd5b1193c80901e8c818e4c3ebdd93b500",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:34:18.241 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:18.243 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:18.247 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:18.257 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:34:18.259 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:18.274 -05:00 [DBG] Creating refresh token
2017-11-13 17:34:18.276 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:34:18.290 -05:00 [DBG] EnyfWXO7mxXEtQ+lLkbss21uJ8PNO5W86PZO6DuM0GU= not found in database
2017-11-13 17:34:18.297 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:18.299 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:18.302 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:18.303 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:34:18.304 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:34:18.311 -05:00 [DBG] Token request success.
2017-11-13 17:34:18.323 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:34:18.325 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:34:18.326 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:34:18.332 -05:00 [DBG] Start userinfo request
2017-11-13 17:34:18.336 -05:00 [DBG] Bearer token found in header
2017-11-13 17:34:18.363 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:18.375 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:18.379 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612458,
    "exp": 1510616058,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612455,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:34:18.391 -05:00 [DBG] Creating userinfo response
2017-11-13 17:34:18.395 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:34:18.400 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:18.402 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:34:18.406 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:34:18.407 -05:00 [DBG] End userinfo request
2017-11-13 17:34:38.670 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:34:38.673 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:34:38.674 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:34:38.675 -05:00 [DBG] Start authorize request
2017-11-13 17:34:38.676 -05:00 [DBG] No user present in authorize request
2017-11-13 17:34:38.676 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:38.699 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:38.701 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:38.702 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:38.709 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:38.775 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:38.778 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:38.782 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:38.784 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:38.785 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
  "Nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:38.794 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:34:38.800 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:34:40.921 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 17:34:41.427 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 17:34:41.441 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 17:34:41.469 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:34:41.479 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:34:41.480 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:34:41.481 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 17:34:41.489 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:41.490 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:41.491 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:34:41.492 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:34:41.493 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:34:41.494 -05:00 [DBG] Start authorize callback request
2017-11-13 17:34:41.495 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:41.496 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:41.520 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:41.521 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:41.522 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:41.528 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:41.590 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:41.597 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:41.601 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:41.602 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:41.603 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
  "Nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
  "SessionId": "89b95f4caaba25931379d3e2ff9991c6",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:41.616 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:34:41.617 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:34:41.623 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:41.625 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:41.626 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:41.653 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:41.655 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:41.656 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:41.663 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:41.758 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:41.768 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:41.836 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:41.838 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:41.860 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:41.866 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:41.937 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:43.660 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:43.661 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:43.663 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:43.687 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:43.688 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:43.689 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:43.695 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:43.762 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:43.765 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:43.769 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:43.770 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:43.776 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:43.777 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:34:43.778 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:34:43.779 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:34:43.780 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:34:43.781 -05:00 [DBG] Start authorize callback request
2017-11-13 17:34:43.782 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:43.783 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:34:43.788 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:43.789 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:34:43.790 -05:00 [DBG] No PKCE used.
2017-11-13 17:34:43.792 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:43.796 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:43.798 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:43.801 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:43.802 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:34:43.803 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
  "Nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
  "SessionId": "89b95f4caaba25931379d3e2ff9991c6",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462092786642814.MzAwNWYyNWQtMTM3MS00NWM0LWFhZDgtZjQwYWMzMTM3Zjg2ZWQ3M2E3NmYtZDU0Zi00MDUxLTk2MTItZjE0NTA1M2JjYjk4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:34:43.815 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:34:43.817 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:34:43.818 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:34:43.820 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:43.827 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:34:43.832 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:34:43.841 -05:00 [DBG] Ka5G6IQixdbgAEW6OBi5NdWe4woPDYzH080YT5yXneY= not found in database
2017-11-13 17:34:43.845 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:34:43.845 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:34:43.847 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:34:43.851 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VarLqBZL3FKf8S45C3yxtt3vz-DfIZG-GI4UCV0_7QzqBj0j2jkYmg2tnvbUu2O06jiWqGh-GZDUpzMYzmShbCJx1YNDznob8SYSfZVnte6zMd14RMhgzU35wfEc3efaWxoAfynBfXrx0RN30SM3d-3Ywp_9Qg3KG2b3i65Emnd7dS7B49QNgPe2Ektk3VlTrYYRgL-YHvzdXuK__DCqTNY4sSYixt4ltIQGoJobbmKwjPSFg9hrvw7JDvGzE45lqehkehKVVUTd-rqLWjzUy83",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:34:43.856 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:34:43.858 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:34:44.084 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:34:44.085 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:34:44.086 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:34:44.087 -05:00 [DBG] Start token request.
2017-11-13 17:34:44.088 -05:00 [DBG] Start client validation
2017-11-13 17:34:44.089 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:34:44.090 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:34:44.092 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:34:44.096 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:34:44.134 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:44.135 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:34:44.136 -05:00 [DBG] Client validation success
2017-11-13 17:34:44.137 -05:00 [DBG] Start token request validation
2017-11-13 17:34:44.138 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:34:44.143 -05:00 [DBG] Ka5G6IQixdbgAEW6OBi5NdWe4woPDYzH080YT5yXneY= found in database: true
2017-11-13 17:34:44.157 -05:00 [DBG] removing Ka5G6IQixdbgAEW6OBi5NdWe4woPDYzH080YT5yXneY= persisted grant from database
2017-11-13 17:34:44.165 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:34:44.167 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "338ad93303c365cf2a3b5208613fa33298c6c1a94563c84b0d4af978f6f42034",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "338ad93303c365cf2a3b5208613fa33298c6c1a94563c84b0d4af978f6f42034",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:34:44.205 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:44.219 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:44.294 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:44.296 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:34:44.297 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:34:44.305 -05:00 [DBG] Creating refresh token
2017-11-13 17:34:44.306 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:34:44.316 -05:00 [DBG] JhYwbv9rZ7mGcVk9SFkU1G5eFfLDDjHdwlqbMtf85SA= not found in database
2017-11-13 17:34:44.337 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:44.344 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:44.411 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:34:44.412 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:34:44.414 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:34:44.419 -05:00 [DBG] Token request success.
2017-11-13 17:34:44.422 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:34:44.423 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:34:44.425 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:34:44.426 -05:00 [DBG] Start userinfo request
2017-11-13 17:34:44.427 -05:00 [DBG] Bearer token found in header
2017-11-13 17:34:44.461 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:44.497 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:34:44.498 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612484,
    "exp": 1510616084,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612481,
    "idp": "Facebook",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:34:44.506 -05:00 [DBG] Creating userinfo response
2017-11-13 17:34:44.507 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:34:44.514 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:34:44.516 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:34:44.521 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:34:44.522 -05:00 [DBG] End userinfo request
2017-11-13 17:35:03.176 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:35:03.178 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:35:03.179 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:35:03.180 -05:00 [DBG] Start authorize request
2017-11-13 17:35:03.181 -05:00 [DBG] No user present in authorize request
2017-11-13 17:35:03.182 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:03.207 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:03.209 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:03.209 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:03.215 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:03.277 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:03.282 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:03.349 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:03.351 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:03.352 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
  "Nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:03.363 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:35:03.370 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:35:06.344 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 17:35:06.619 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 17:35:06.626 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 17:35:06.631 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:35:06.636 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:35:06.637 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:35:06.639 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 17:35:06.644 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:06.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:06.647 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:35:06.648 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:35:06.649 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:35:06.650 -05:00 [DBG] Start authorize callback request
2017-11-13 17:35:06.651 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:06.651 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:06.672 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:06.674 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:06.675 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:06.681 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:06.754 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:06.762 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:06.853 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:06.854 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:06.856 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
  "Nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
  "SessionId": "9f0365ce97f2c93bae81625c81ee72af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:06.870 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:35:06.871 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:35:06.878 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:06.879 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:06.881 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:06.905 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:06.906 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:06.907 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:06.913 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:06.975 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:06.981 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:06.986 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:06.987 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:07.008 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:07.013 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:07.078 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:08.467 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:08.469 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:08.473 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:08.497 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:08.498 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:08.499 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:08.507 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:08.571 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:08.578 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:08.644 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:08.645 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:08.652 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:08.653 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:08.654 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:35:08.656 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:35:08.658 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:35:08.659 -05:00 [DBG] Start authorize callback request
2017-11-13 17:35:08.660 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:08.660 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:08.683 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:08.685 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:08.686 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:08.693 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:08.756 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:08.762 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:08.827 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:08.828 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:08.829 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
  "Nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
  "SessionId": "9f0365ce97f2c93bae81625c81ee72af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093031677370.YmE0NmRiZTMtYTI2Ni00ZTRmLTliZTctYjA5MzYzMTg5MzdiZjQ4Njk0OGUtZjQyMS00NTZlLTgwMDItMDU2YjRlY2EwMjZk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:08.842 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:35:08.843 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:35:08.846 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:35:08.848 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:08.858 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:35:08.861 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:35:08.871 -05:00 [DBG] vXNggF93ArBMyCaaj/ZTlONb/sc/E9DtHRMQD8yFdW0= not found in database
2017-11-13 17:35:08.875 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:35:08.876 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:35:08.878 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:35:08.883 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaUjji0IGSaHEtdaFS7ZzOlic9d0b7Z8Gz4nL6OKKL_FYYOk8Cl7dwBCFZ9po1eS8-7W_kbCcOmJomxHQVXPuPuuilKpFHlS0c6g_Cs00RbOToyklmjc1m9dAk681LXfC6946PVpiy0UjHiKOPPkj3Gxbpw7A0Tbpsck_6C16KuTXIbj6lsDFiOiFZi3CYsN9xK71z_DOtdaFr8iWMOjGcf1QPcAOvof8_2XU6Azyzp8k-XGYQbZn5NukXEPeBg4FkqtU5Y-AGf2OpkzAfOALKk",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:35:08.886 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:35:08.887 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:35:09.145 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:35:09.148 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:35:09.149 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:35:09.151 -05:00 [DBG] Start token request.
2017-11-13 17:35:09.151 -05:00 [DBG] Start client validation
2017-11-13 17:35:09.152 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:35:09.153 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:35:09.154 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:35:09.155 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:35:09.179 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:09.180 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:35:09.181 -05:00 [DBG] Client validation success
2017-11-13 17:35:09.182 -05:00 [DBG] Start token request validation
2017-11-13 17:35:09.183 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:35:09.186 -05:00 [DBG] vXNggF93ArBMyCaaj/ZTlONb/sc/E9DtHRMQD8yFdW0= found in database: true
2017-11-13 17:35:09.195 -05:00 [DBG] removing vXNggF93ArBMyCaaj/ZTlONb/sc/E9DtHRMQD8yFdW0= persisted grant from database
2017-11-13 17:35:09.202 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:35:09.203 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c7e810f9ce2d581b758009356f8dc63fdeb0e0efcfe4b06047783cf493c8bf65",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "c7e810f9ce2d581b758009356f8dc63fdeb0e0efcfe4b06047783cf493c8bf65",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:35:09.210 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:09.216 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:09.281 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:09.283 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:35:09.283 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:09.292 -05:00 [DBG] Creating refresh token
2017-11-13 17:35:09.293 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:35:09.302 -05:00 [DBG] eBGR+iG74AQUPQ7RqVRCFvK17IHKgyVySadI+MwwRhk= not found in database
2017-11-13 17:35:09.308 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:09.310 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:09.314 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:09.315 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:35:09.316 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:35:09.320 -05:00 [DBG] Token request success.
2017-11-13 17:35:09.322 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:35:09.324 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:35:09.325 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:35:09.326 -05:00 [DBG] Start userinfo request
2017-11-13 17:35:09.327 -05:00 [DBG] Bearer token found in header
2017-11-13 17:35:09.334 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:09.340 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:09.341 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612509,
    "exp": 1510616109,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612506,
    "idp": "Facebook",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:35:09.348 -05:00 [DBG] Creating userinfo response
2017-11-13 17:35:09.349 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:35:09.351 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:09.353 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:35:09.355 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:35:09.356 -05:00 [DBG] End userinfo request
2017-11-13 17:35:24.471 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 17:35:24.473 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 17:35:24.475 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 17:35:24.477 -05:00 [DBG] Start discovery request
2017-11-13 17:35:24.496 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 17:35:24.671 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 17:35:24.672 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 17:35:24.675 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 17:35:24.677 -05:00 [DBG] Start key discovery request
2017-11-13 17:35:24.707 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:35:24.708 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:35:24.709 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:35:24.710 -05:00 [DBG] Start authorize request
2017-11-13 17:35:24.711 -05:00 [DBG] No user present in authorize request
2017-11-13 17:35:24.711 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:24.731 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:24.733 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:24.733 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:24.738 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:24.800 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:24.803 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:24.807 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:24.809 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:24.810 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
  "Nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:24.819 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:35:24.826 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:35:27.341 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 17:35:27.564 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 17:35:27.570 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 17:35:27.576 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:35:27.582 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:35:27.583 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:35:27.585 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 17:35:27.591 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:27.592 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:27.593 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:35:27.594 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:35:27.595 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:35:27.596 -05:00 [DBG] Start authorize callback request
2017-11-13 17:35:27.597 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:27.598 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:27.619 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:27.621 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:27.621 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:27.627 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:27.688 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:27.690 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:27.695 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:27.696 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:27.697 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
  "Nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
  "SessionId": "7e136ba3e50834f39c660f6cf13ee90d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:27.709 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:35:27.710 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:35:27.715 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:27.716 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:27.718 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:27.723 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:27.724 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:27.725 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:27.727 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:27.731 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:27.732 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:27.736 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:27.737 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:27.742 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:27.747 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:27.811 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:31.936 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:31.938 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:31.940 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:31.968 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:31.969 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:31.971 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:31.979 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.043 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.050 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.102 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.103 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:32.110 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:32.112 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:35:32.112 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:35:32.113 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:35:32.114 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:35:32.116 -05:00 [DBG] Start authorize callback request
2017-11-13 17:35:32.116 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:32.117 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:35:32.142 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.143 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:35:32.144 -05:00 [DBG] No PKCE used.
2017-11-13 17:35:32.151 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.234 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.243 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.313 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.315 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:35:32.316 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
  "Nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
  "SessionId": "7e136ba3e50834f39c660f6cf13ee90d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:35:32.328 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:35:32.329 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:35:32.331 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:35:32.333 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:32.338 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:35:32.342 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:35:32.350 -05:00 [DBG] PyLmE5B06bEOhCcKqUpK+UR6mHXuVcw7Y2gwv4dhelo= not found in database
2017-11-13 17:35:32.353 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:35:32.353 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:35:32.354 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:35:32.360 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZlcRNOWV8DIBjfL0SgNmkRDCCa66yOmgEz5nzZRINv23pVinoPz_KR_TFJSSAm7S2_q2UTdcSNOb8Pf3rlIzCNTbQa2GS4rfkR-1f1RcXZhCcv8HTMGBcFeQ9Dq6Q7bwxeJkcTaT9LoADrfLF-fc1OFX8Rver480WYOSS9Dhk-4XkSEGz0QTD6VAFaPauE5nA3knLmaovg3mKQ3s8TChg2zh39bBvwliDRuRlOwuAJZfDICN4IEeGQTS05gVz2qOfiErWyYKGznBzjRG1SbkCr",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:35:32.364 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:35:32.365 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:35:32.661 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:35:32.663 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:35:32.665 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:35:32.666 -05:00 [DBG] Start token request.
2017-11-13 17:35:32.666 -05:00 [DBG] Start client validation
2017-11-13 17:35:32.667 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:35:32.668 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:35:32.669 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:35:32.670 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:35:32.696 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.697 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:35:32.698 -05:00 [DBG] Client validation success
2017-11-13 17:35:32.699 -05:00 [DBG] Start token request validation
2017-11-13 17:35:32.700 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:35:32.703 -05:00 [DBG] PyLmE5B06bEOhCcKqUpK+UR6mHXuVcw7Y2gwv4dhelo= found in database: true
2017-11-13 17:35:32.715 -05:00 [DBG] removing PyLmE5B06bEOhCcKqUpK+UR6mHXuVcw7Y2gwv4dhelo= persisted grant from database
2017-11-13 17:35:32.721 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:35:32.722 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "28fed95ac1f74331d6aaa2d58747d308d4f675ff30a4d2cf32b856e1523feded",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "28fed95ac1f74331d6aaa2d58747d308d4f675ff30a4d2cf32b856e1523feded",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:35:32.734 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.740 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.805 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.806 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:35:32.807 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:35:32.815 -05:00 [DBG] Creating refresh token
2017-11-13 17:35:32.816 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:35:32.825 -05:00 [DBG] S/xQREgeGZHMscKbNADNakWSgGVfkvBfibCZ2sVig3s= not found in database
2017-11-13 17:35:32.831 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.833 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.836 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:35:32.837 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:35:32.838 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:35:32.843 -05:00 [DBG] Token request success.
2017-11-13 17:35:32.849 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:35:32.851 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:35:32.852 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:35:32.853 -05:00 [DBG] Start userinfo request
2017-11-13 17:35:32.854 -05:00 [DBG] Bearer token found in header
2017-11-13 17:35:32.861 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.866 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:35:32.867 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612532,
    "exp": 1510616132,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612527,
    "idp": "Facebook",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:35:32.874 -05:00 [DBG] Creating userinfo response
2017-11-13 17:35:32.875 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:35:32.882 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:35:32.884 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:35:32.890 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:35:32.891 -05:00 [DBG] End userinfo request
2017-11-13 17:36:20.350 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:36:20.351 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:36:32.754 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:36:32.755 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:01.533 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:01.534 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:01.535 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:37:01.537 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:37:01.538 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:37:01.543 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:01.550 -05:00 [DBG] Start end session request validation
2017-11-13 17:37:01.555 -05:00 [DBG] Start identity token validation
2017-11-13 17:37:01.577 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:01.578 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:37:01.581 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:37:01.587 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612532,
    "exp": 1510612832,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462093247007820.YTQyNTc2NDktYzI3MS00YTYzLWEzZTktY2EwY2UwOGUyOTBkZTZjMGUxYjAtMWM1NC00MjY2LWIyODgtYTA1MTBlZDJmMzkw",
    "iat": 1510612532,
    "at_hash": "OWO7s9ALuwOM3CZ6kPUyNQ",
    "sid": "7e136ba3e50834f39c660f6cf13ee90d",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612527,
    "idp": "Facebook",
    "amr": "external"
  }
}
2017-11-13 17:37:01.599 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-5gnSCr6dSvkII-m8xZc1Tq60ONzBcUD9nrjmW_YEo8U794LXC5nlKMfbND-gBQ82K47qxS-BRI7ZXd9JztPPVsogRPWZIs1p9W05ALG5KlG3TLe1WAR6j6wARMqG_4PMmDS9MgkVmzQHEjdI5pPn",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTI1MzIsImV4cCI6MTUxMDYxMjgzMiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDkzMjQ3MDA3ODIwLllUUXlOVGMyTkRrdFl6STNNUzAwWVRZekxXRXpaVGt0WTJFd1kyVXdPR1V5T1RCa1pUWmpNR1V4WWpBdE1XTTFOQzAwTWpZMkxXSXlPRGd0WVRBMU1UQmxaREptTXprdyIsImlhdCI6MTUxMDYxMjUzMiwiYXRfaGFzaCI6Ik9XTzdzOUFMdXdPTTNDWjZrUFV5TlEiLCJzaWQiOiI3ZTEzNmJhM2U1MDgzNGYzOWM2NjBmNmNmMTNlZTkwZCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjUyNywiaWRwIjoiRmFjZWJvb2siLCJhbXIiOlsiZXh0ZXJuYWwiXX0.FXHUkd3YEH2WJGK3LqXF7kRG2V7DtI1UGdgJRVFmPudX4aKZTLAZzR27s3LAbWDQSemUfYYseMhtsGLpO0AmKlbf6gOKQlv9d03dRRwhED8X4y2goKbLF0dUzk8sNV4C8JKiSaMnhq3q0McGdoi7gZiPuAOW9fBbIzlaivRumZcy3q3_bvEwkrHQxQPssVfmwqLNJiuvPXcRE_NSmfD5AzMWbKairpkF9i04x2rzR6EI6ydTou835bJt15edfZkiM1YeaUbBQHOkH6tjOpgc1jzarZXm73Ymhw4zZd2sYxIlLyed9ZgabmhzNkOhNzkhqdFI5HgvzJz91DjE8CKE9g",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ-5gnSCr6dSvkII-m8xZc1Tq60ONzBcUD9nrjmW_YEo8U794LXC5nlKMfbND-gBQ82K47qxS-BRI7ZXd9JztPPVsogRPWZIs1p9W05ALG5KlG3TLe1WAR6j6wARMqG_4PMmDS9MgkVmzQHEjdI5pPn",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:37:01.608 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:37:01.624 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:01.626 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:01.652 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:37:01.653 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:37:01.654 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:37:01.655 -05:00 [INF] User logged out.
2017-11-13 17:37:01.962 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:37:01.964 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:37:01.966 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:37:01.971 -05:00 [DBG] Processing signout callback request
2017-11-13 17:37:01.989 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:01.990 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:37:01.990 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:37:01.991 -05:00 [INF] Successful signout callback.
2017-11-13 17:37:01.991 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:37:01.992 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:37:20.159 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:37:20.160 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:37:20.162 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:37:20.164 -05:00 [DBG] Start authorize request
2017-11-13 17:37:20.165 -05:00 [DBG] No user present in authorize request
2017-11-13 17:37:20.165 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:37:20.187 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:20.189 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:37:20.190 -05:00 [DBG] No PKCE used.
2017-11-13 17:37:20.196 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:20.268 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:20.271 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:20.353 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:20.355 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:37:20.357 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
  "Nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:37:20.365 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:37:20.372 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:37:22.551 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 17:37:22.559 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:37:31.348 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:37:31.353 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:37:31.359 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:37:31.369 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:37:31.370 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:37:31.371 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 17:37:31.379 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:31.380 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:31.381 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:37:31.382 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:37:31.384 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:37:31.385 -05:00 [DBG] Start authorize callback request
2017-11-13 17:37:31.386 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:31.387 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:37:31.410 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:31.411 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:37:31.412 -05:00 [DBG] No PKCE used.
2017-11-13 17:37:31.417 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:31.484 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:31.490 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:31.557 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:31.559 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:37:31.560 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
  "Nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
  "SessionId": "5d4b72b0442c7b66223b34e895e9f040",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:37:31.573 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:37:31.573 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:37:31.580 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:31.581 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:31.582 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:37:31.606 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:31.607 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:37:31.608 -05:00 [DBG] No PKCE used.
2017-11-13 17:37:31.615 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:31.679 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:31.684 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:31.689 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:31.691 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:37:31.712 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:31.719 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:31.785 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:33.248 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:33.250 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:33.253 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:37:33.287 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:33.289 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:37:33.289 -05:00 [DBG] No PKCE used.
2017-11-13 17:37:33.297 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:33.371 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:33.378 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:33.397 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:33.398 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:37:33.404 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:33.406 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:33.406 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:37:33.408 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:37:33.409 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:37:33.410 -05:00 [DBG] Start authorize callback request
2017-11-13 17:37:33.411 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:33.412 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:37:33.436 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:33.437 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:37:33.437 -05:00 [DBG] No PKCE used.
2017-11-13 17:37:33.445 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:33.514 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:33.520 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:33.597 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:33.599 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:37:33.600 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
  "Nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
  "SessionId": "5d4b72b0442c7b66223b34e895e9f040",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:37:33.613 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:37:33.614 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:37:33.615 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:37:33.617 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:33.624 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:37:33.627 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:37:33.636 -05:00 [DBG] 2ZkjJ7tKUHSy0yE8eNid/64AWgaApkcgzau8UJgGdNk= not found in database
2017-11-13 17:37:33.639 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:37:33.639 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:37:33.640 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:37:33.645 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYJawonBN1Jc4Mg9YFl97XDMDChjhDtkm3KXpCGypfddJLxIWN4nkmz7mL5BA0SkB8dGOSI0Gh2vmwkzgVQLBmzLVd3XtSkbdn2MEHZFh1Q-tYIoqLYGtEYWQEIre4McpF8OqB-5PyJxQP-G8a2q5wR1zYanmKu5i2cPKYrHhHGyJM8tWP4qCcKmNMAbWm3lR_As1q4dBxk_gSJwX7tYXPYQbHxqms0IMrIIlzKy0DBISdf8NPvBR_W5H7NKDbtYlIV5leiMcipWezHh8N1M2i0",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:37:33.649 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:37:33.650 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:37:33.924 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:37:33.926 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:37:33.927 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:37:33.929 -05:00 [DBG] Start token request.
2017-11-13 17:37:33.930 -05:00 [DBG] Start client validation
2017-11-13 17:37:33.930 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:37:33.931 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:37:33.932 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:37:33.933 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:37:33.960 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:33.962 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:37:33.962 -05:00 [DBG] Client validation success
2017-11-13 17:37:33.963 -05:00 [DBG] Start token request validation
2017-11-13 17:37:33.964 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:37:33.968 -05:00 [DBG] 2ZkjJ7tKUHSy0yE8eNid/64AWgaApkcgzau8UJgGdNk= found in database: true
2017-11-13 17:37:33.980 -05:00 [DBG] removing 2ZkjJ7tKUHSy0yE8eNid/64AWgaApkcgzau8UJgGdNk= persisted grant from database
2017-11-13 17:37:33.986 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:37:33.987 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "bc3699d897c563dc24a96e662eb88ab684b838cd6d23594beed7cc78b9e63c41",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "bc3699d897c563dc24a96e662eb88ab684b838cd6d23594beed7cc78b9e63c41",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:37:34.018 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:34.025 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:34.106 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:34.108 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:37:34.108 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:34.117 -05:00 [DBG] Creating refresh token
2017-11-13 17:37:34.118 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:37:34.128 -05:00 [DBG] JWn0jroF+jdgULr7HpmJtApjkl2SkiHkgYx1knbUi6I= not found in database
2017-11-13 17:37:34.147 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:34.153 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:34.216 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:37:34.217 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:37:34.218 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:37:34.223 -05:00 [DBG] Token request success.
2017-11-13 17:37:34.226 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:37:34.227 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:37:34.229 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:37:34.230 -05:00 [DBG] Start userinfo request
2017-11-13 17:37:34.230 -05:00 [DBG] Bearer token found in header
2017-11-13 17:37:34.257 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:34.284 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:34.285 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612654,
    "exp": 1510616254,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612651,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:37:34.292 -05:00 [DBG] Creating userinfo response
2017-11-13 17:37:34.293 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:37:34.299 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:37:34.301 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:37:34.307 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:37:34.309 -05:00 [DBG] End userinfo request
2017-11-13 17:37:45.457 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:45.459 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:50.669 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:50.671 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:50.671 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:37:50.673 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:37:50.674 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:37:50.675 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:37:50.676 -05:00 [DBG] Start end session request validation
2017-11-13 17:37:50.677 -05:00 [DBG] Start identity token validation
2017-11-13 17:37:50.709 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:50.710 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:37:50.714 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:37:50.720 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612654,
    "exp": 1510612954,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462094401513412.NDcxZTc4OTQtMDZkYy00NGYyLWJiNjItODc0ZWIwYzUyZDYyNjc1MWRkMmEtZmJlZS00MDExLWFmYTEtMzIxNTk2MmI3Mjhi",
    "iat": 1510612654,
    "at_hash": "8OebIFA7U5kjOQIzRnV8Cw",
    "sid": "5d4b72b0442c7b66223b34e895e9f040",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612651,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:37:50.726 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va7QllnTIdtT7kof2Gip2u3OAgos2K1Wba-5Yza9omiV9O9tA4oYBVertGK0IoCJ3ySlGf2Crt8bFv9E5ik1d_Q_TFjVrpYmOw9GVbrSG5obu2fHVHqud8Xr6e8OX-YOyh2i9h1O6tCXb0hRq2FdarJ",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTI2NTQsImV4cCI6MTUxMDYxMjk1NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDk0NDAxNTEzNDEyLk5EY3haVGM0T1RRdE1EWmtZeTAwTkdZeUxXSmlOakl0T0RjMFpXSXdZelV5WkRZeU5qYzFNV1JrTW1FdFptSmxaUzAwTURFeExXRm1ZVEV0TXpJeE5UazJNbUkzTWpoaSIsImlhdCI6MTUxMDYxMjY1NCwiYXRfaGFzaCI6IjhPZWJJRkE3VTVrak9RSXpSblY4Q3ciLCJzaWQiOiI1ZDRiNzJiMDQ0MmM3YjY2MjIzYjM0ZTg5NWU5ZjA0MCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjY1MSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.fRQ1dxT19nIIXKIm68_EbcMd6I0dr_lw_1IiY4zOaVQzSBzSv-6RDuLsceIIZNOHEq_GVwAc8fNr0Kpl9QACAYwMSd1ZKUDbXxh3uSjuSQ6SCdZs-wDGF8djvNsl0T0N39SHfJtGA-fILQSVTrHnfK5cXxGEqTTbmbKkcVc2SHin68v3BZQqV7i44jrUXLt3mNPjAAn9Bz8Z4wXsxZgGnOc3uxqporxqj7IQ21pVQZxZg89LO3y1augR3Pqfpn5kOrnacHiatewNREIO-Olb6QjYuhiLa9Z32f1ND2ukOhVXMOcwD3oxXSVHSDkK2-hvfXxoWHBp5Py1rvLKTGaliQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va7QllnTIdtT7kof2Gip2u3OAgos2K1Wba-5Yza9omiV9O9tA4oYBVertGK0IoCJ3ySlGf2Crt8bFv9E5ik1d_Q_TFjVrpYmOw9GVbrSG5obu2fHVHqud8Xr6e8OX-YOyh2i9h1O6tCXb0hRq2FdarJ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:37:50.734 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:37:50.740 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:50.741 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:50.743 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:37:50.744 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:37:50.745 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:37:50.746 -05:00 [INF] User logged out.
2017-11-13 17:37:50.932 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:37:50.936 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:37:50.938 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:37:50.939 -05:00 [DBG] Processing signout callback request
2017-11-13 17:37:50.978 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:37:50.979 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:37:50.980 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:37:50.981 -05:00 [INF] Successful signout callback.
2017-11-13 17:37:50.982 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:37:50.983 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:37:56.867 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:37:58.366 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-13 17:37:58.664 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-13 17:37:58.670 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-13 17:37:58.676 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:37:58.681 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:37:58.683 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:37:58.684 -05:00 [INF] User logged in with Facebook provider.
2017-11-13 17:37:58.690 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:37:58.691 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:03.434 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:03.436 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:13.085 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:13.086 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:22.288 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:22.289 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:22.290 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:38:22.292 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:38:22.293 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:38:22.294 -05:00 [DBG] Start authorize request
2017-11-13 17:38:22.295 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:38:22.296 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:38:22.321 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:22.322 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:38:22.323 -05:00 [DBG] No PKCE used.
2017-11-13 17:38:22.329 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:22.395 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:22.401 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:22.470 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:22.471 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:38:22.473 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaim-75bj4j3NCHCFBeqBjcveyKsXE-3C8FLOwnBazFQuQfxD3EIAwDqrxHliyhukSa2lrys4ooaV5v2HEyIgZBbweoH4f3HblNeHw3ynLbHt1ah-U7OvmFbsgO7TISetNLkD2Y_ohti6XvFh4q_qCwKbJCUYcIYQRO8l7U5YLWIioGBh-Xvr_5KA-rcxZ4Ry6d2vp2AgtsCY9w2AiY5CLOqx9fKLMCd15ehoxhzUKUwdCddrWluBt9dZB3YAUUoAhn8_PEMFZ-Fi57eKvQUJaX",
  "Nonce": "636462095022824198.MmM2MTNhMDctYjA5Yy00M2JhLWI2MzgtOTUxMjRlYmIwZjZhZjA1NDQwNzAtYjAyZC00YmYzLWFmNzItZmQ3M2I1NzFiOTYx",
  "SessionId": "288f0194767871a2913a33351a734212",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095022824198.MmM2MTNhMDctYjA5Yy00M2JhLWI2MzgtOTUxMjRlYmIwZjZhZjA1NDQwNzAtYjAyZC00YmYzLWFmNzItZmQ3M2I1NzFiOTYx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vaim-75bj4j3NCHCFBeqBjcveyKsXE-3C8FLOwnBazFQuQfxD3EIAwDqrxHliyhukSa2lrys4ooaV5v2HEyIgZBbweoH4f3HblNeHw3ynLbHt1ah-U7OvmFbsgO7TISetNLkD2Y_ohti6XvFh4q_qCwKbJCUYcIYQRO8l7U5YLWIioGBh-Xvr_5KA-rcxZ4Ry6d2vp2AgtsCY9w2AiY5CLOqx9fKLMCd15ehoxhzUKUwdCddrWluBt9dZB3YAUUoAhn8_PEMFZ-Fi57eKvQUJaX",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:38:22.486 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:38:22.487 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:38:22.493 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:22.494 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:22.495 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:38:22.514 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:22.516 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:38:22.516 -05:00 [DBG] No PKCE used.
2017-11-13 17:38:22.522 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:22.591 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:22.598 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:22.664 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:22.665 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:38:22.689 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:22.695 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:22.761 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.178 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:28.180 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:28.182 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:38:28.208 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.209 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:38:28.209 -05:00 [DBG] No PKCE used.
2017-11-13 17:38:28.216 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.278 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.281 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.285 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.286 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:38:28.292 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:28.293 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:38:28.294 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:38:28.296 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:38:28.297 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:38:28.299 -05:00 [DBG] Start authorize callback request
2017-11-13 17:38:28.299 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:38:28.300 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:38:28.305 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.306 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:38:28.307 -05:00 [DBG] No PKCE used.
2017-11-13 17:38:28.309 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.313 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.315 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.318 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.319 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:38:28.320 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaim-75bj4j3NCHCFBeqBjcveyKsXE-3C8FLOwnBazFQuQfxD3EIAwDqrxHliyhukSa2lrys4ooaV5v2HEyIgZBbweoH4f3HblNeHw3ynLbHt1ah-U7OvmFbsgO7TISetNLkD2Y_ohti6XvFh4q_qCwKbJCUYcIYQRO8l7U5YLWIioGBh-Xvr_5KA-rcxZ4Ry6d2vp2AgtsCY9w2AiY5CLOqx9fKLMCd15ehoxhzUKUwdCddrWluBt9dZB3YAUUoAhn8_PEMFZ-Fi57eKvQUJaX",
  "Nonce": "636462095022824198.MmM2MTNhMDctYjA5Yy00M2JhLWI2MzgtOTUxMjRlYmIwZjZhZjA1NDQwNzAtYjAyZC00YmYzLWFmNzItZmQ3M2I1NzFiOTYx",
  "SessionId": "288f0194767871a2913a33351a734212",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095022824198.MmM2MTNhMDctYjA5Yy00M2JhLWI2MzgtOTUxMjRlYmIwZjZhZjA1NDQwNzAtYjAyZC00YmYzLWFmNzItZmQ3M2I1NzFiOTYx",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vaim-75bj4j3NCHCFBeqBjcveyKsXE-3C8FLOwnBazFQuQfxD3EIAwDqrxHliyhukSa2lrys4ooaV5v2HEyIgZBbweoH4f3HblNeHw3ynLbHt1ah-U7OvmFbsgO7TISetNLkD2Y_ohti6XvFh4q_qCwKbJCUYcIYQRO8l7U5YLWIioGBh-Xvr_5KA-rcxZ4Ry6d2vp2AgtsCY9w2AiY5CLOqx9fKLMCd15ehoxhzUKUwdCddrWluBt9dZB3YAUUoAhn8_PEMFZ-Fi57eKvQUJaX",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:38:28.333 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:38:28.335 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:38:28.336 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:38:28.338 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:38:28.344 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:38:28.348 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:38:28.356 -05:00 [DBG] ev3BNyv2Pu3ex0flJ0vOG1lzBH4fi4p1ObE+LGyUAh0= not found in database
2017-11-13 17:38:28.359 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:38:28.361 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:38:28.362 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:38:28.366 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vaim-75bj4j3NCHCFBeqBjcveyKsXE-3C8FLOwnBazFQuQfxD3EIAwDqrxHliyhukSa2lrys4ooaV5v2HEyIgZBbweoH4f3HblNeHw3ynLbHt1ah-U7OvmFbsgO7TISetNLkD2Y_ohti6XvFh4q_qCwKbJCUYcIYQRO8l7U5YLWIioGBh-Xvr_5KA-rcxZ4Ry6d2vp2AgtsCY9w2AiY5CLOqx9fKLMCd15ehoxhzUKUwdCddrWluBt9dZB3YAUUoAhn8_PEMFZ-Fi57eKvQUJaX",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:38:28.370 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:38:28.372 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:38:28.624 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:38:28.626 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:38:28.627 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:38:28.628 -05:00 [DBG] Start token request.
2017-11-13 17:38:28.629 -05:00 [DBG] Start client validation
2017-11-13 17:38:28.630 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:38:28.631 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:38:28.632 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:38:28.633 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:38:28.662 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.663 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:38:28.664 -05:00 [DBG] Client validation success
2017-11-13 17:38:28.665 -05:00 [DBG] Start token request validation
2017-11-13 17:38:28.666 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:38:28.670 -05:00 [DBG] ev3BNyv2Pu3ex0flJ0vOG1lzBH4fi4p1ObE+LGyUAh0= found in database: true
2017-11-13 17:38:28.680 -05:00 [DBG] removing ev3BNyv2Pu3ex0flJ0vOG1lzBH4fi4p1ObE+LGyUAh0= persisted grant from database
2017-11-13 17:38:28.686 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:38:28.687 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "f2d2fb9ac1ceb62485f93daa8bfa133f8da042bc49eeb5776e88c306c480d664",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "f2d2fb9ac1ceb62485f93daa8bfa133f8da042bc49eeb5776e88c306c480d664",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:38:28.713 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.719 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.793 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.795 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:38:28.796 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:38:28.806 -05:00 [DBG] Creating refresh token
2017-11-13 17:38:28.807 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:38:28.818 -05:00 [DBG] HkIdEdRyeT8m1yTf93TvKd20QN60xZtlMVygQ90zgMk= not found in database
2017-11-13 17:38:28.845 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.853 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.931 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:38:28.932 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:38:28.934 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:38:28.938 -05:00 [DBG] Token request success.
2017-11-13 17:38:28.941 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:38:28.942 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:38:28.943 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:38:28.945 -05:00 [DBG] Start userinfo request
2017-11-13 17:38:28.946 -05:00 [DBG] Bearer token found in header
2017-11-13 17:38:28.969 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.977 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:38:28.979 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612708,
    "exp": 1510616308,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612678,
    "idp": "Facebook",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:38:28.987 -05:00 [DBG] Creating userinfo response
2017-11-13 17:38:28.987 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:38:28.993 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:38:28.995 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:38:29.003 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:38:29.005 -05:00 [DBG] End userinfo request
2017-11-13 17:39:31.648 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 17:39:31.650 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 17:39:31.652 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 17:39:31.653 -05:00 [DBG] Start discovery request
2017-11-13 17:39:31.667 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 17:39:31.814 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 17:39:31.816 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 17:39:31.817 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 17:39:31.818 -05:00 [DBG] Start key discovery request
2017-11-13 17:39:31.852 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:31.853 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:31.854 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:39:31.855 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:39:31.856 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:39:31.858 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:31.858 -05:00 [DBG] Start end session request validation
2017-11-13 17:39:31.859 -05:00 [INF] End session request validation success
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYDlVJ1Xi43UNThFdD0cqeAkdCPHgJp3lIV9sqs8Dm9U0ouubKFmbu12129LmFNu6b8NVQ9yM8FdAcwiHTU5AVrCh8thCe025d4qLTRGVCiDWC_KfxmHdBO555ayES_kfAfjxOMqTNZU9LmOSX3NuPo",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:31.864 -05:00 [DBG] Success validating end session request from null
2017-11-13 17:39:31.873 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:31.874 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:31.876 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:39:31.878 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:39:31.879 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:39:31.881 -05:00 [INF] User logged out.
2017-11-13 17:39:32.119 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:39:32.121 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:39:32.122 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:39:32.124 -05:00 [DBG] Processing signout callback request
2017-11-13 17:39:32.160 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:32.161 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:39:32.161 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:39:32.162 -05:00 [INF] Successful signout callback.
2017-11-13 17:39:32.163 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:39:32.164 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:39:39.807 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:39:39.809 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:39:39.810 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:39:39.811 -05:00 [DBG] Start authorize request
2017-11-13 17:39:39.812 -05:00 [DBG] No user present in authorize request
2017-11-13 17:39:39.812 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:39.833 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:39.835 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:39.835 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:39.841 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:39.904 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:39.906 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:39.910 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:39.911 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:39.913 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
  "Nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:39.922 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:39:39.928 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:39:41.791 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 17:39:41.798 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:39:49.095 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:39:49.100 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:39:49.105 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:39:49.107 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 17:39:49.111 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:39:49.113 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:39:49.113 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 17:39:49.122 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:49.123 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:49.124 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:39:49.125 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:39:49.126 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:39:49.127 -05:00 [DBG] Start authorize callback request
2017-11-13 17:39:49.128 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:49.128 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:49.148 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:49.150 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:49.150 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:49.156 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:49.217 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:49.220 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:49.225 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:49.226 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:49.228 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
  "Nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
  "SessionId": "0616e8383fafeb30b7f26aba41a5c088",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:49.240 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:39:49.241 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:39:49.247 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:49.249 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:49.250 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:49.272 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:49.273 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:49.274 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:49.281 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:49.362 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:49.370 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:49.439 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:49.441 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:49.463 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:49.471 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:49.542 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:51.564 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:51.566 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:51.568 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:51.594 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:51.595 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:51.596 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:51.603 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:51.667 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:51.674 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:51.694 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:51.696 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:51.704 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:51.705 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:51.706 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:39:51.707 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:39:51.709 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:39:51.710 -05:00 [DBG] Start authorize callback request
2017-11-13 17:39:51.711 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:51.711 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:51.740 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:51.741 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:51.742 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:51.752 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:51.833 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:51.842 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:51.912 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:51.913 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:51.914 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
  "Nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
  "SessionId": "0616e8383fafeb30b7f26aba41a5c088",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:51.927 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:39:51.928 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:39:51.929 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:39:51.931 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:51.938 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:39:51.942 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:39:51.950 -05:00 [DBG] xZ7V9iCc06GhQyYlJwpMEAF3CimsupJP6OzUVVyP55A= not found in database
2017-11-13 17:39:51.953 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:39:51.954 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:39:51.955 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:39:51.960 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZqG78T21eyurvghVsB98PpvDoVztosK5hLxR8BWlVkCEtCv4aC1HpbYuGnkujJhYv3TFgOJT4hov61kiijJ0izdLdcUqi1JI3p5wTWxg8hk9ycMbmMpGOOEkzHQBcVwyQp4I5VuNF3uckAdmAQPQBKtC64zBi-vCpcHQ0QSvsIaR6Bh7RozCwiclZqHJYbO3hm8YDBwjvEAOJcDpT5jSoEY12tpS2HRnrcv60vvYC3WJZFbMrNCSOHRHpoIZi2iWaOY-NylYTojHhBpiYejN8H",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:39:51.964 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:39:51.965 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:39:52.285 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:39:52.286 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:39:52.287 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:39:52.288 -05:00 [DBG] Start token request.
2017-11-13 17:39:52.289 -05:00 [DBG] Start client validation
2017-11-13 17:39:52.290 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:39:52.290 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:39:52.291 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:39:52.292 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:39:52.319 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:52.320 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:39:52.322 -05:00 [DBG] Client validation success
2017-11-13 17:39:52.323 -05:00 [DBG] Start token request validation
2017-11-13 17:39:52.324 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:39:52.328 -05:00 [DBG] xZ7V9iCc06GhQyYlJwpMEAF3CimsupJP6OzUVVyP55A= found in database: true
2017-11-13 17:39:52.342 -05:00 [DBG] removing xZ7V9iCc06GhQyYlJwpMEAF3CimsupJP6OzUVVyP55A= persisted grant from database
2017-11-13 17:39:52.348 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:39:52.349 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "86ef9f784ed0d813689f739fd3826df8b3aff0cf7d6b76f516197a2d8c320488",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "86ef9f784ed0d813689f739fd3826df8b3aff0cf7d6b76f516197a2d8c320488",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:39:52.361 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:52.368 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:52.445 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:52.446 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:39:52.447 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:52.456 -05:00 [DBG] Creating refresh token
2017-11-13 17:39:52.457 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:39:52.469 -05:00 [DBG] 5MJ5n9fS0ut3+IgQOTcMkmsGCjrq6eGEPYHNHKof/jE= not found in database
2017-11-13 17:39:52.491 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:52.498 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:52.567 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:52.569 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:39:52.570 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:39:52.574 -05:00 [DBG] Token request success.
2017-11-13 17:39:52.581 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:39:52.583 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:39:52.584 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:39:52.585 -05:00 [DBG] Start userinfo request
2017-11-13 17:39:52.585 -05:00 [DBG] Bearer token found in header
2017-11-13 17:39:52.607 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:52.614 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:52.615 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612792,
    "exp": 1510616392,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612789,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:39:52.624 -05:00 [DBG] Creating userinfo response
2017-11-13 17:39:52.625 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:39:52.631 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:52.633 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:39:52.639 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:39:52.640 -05:00 [DBG] End userinfo request
2017-11-13 17:39:55.511 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:55.512 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:55.513 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:39:55.514 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:39:55.515 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:39:55.516 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:55.517 -05:00 [DBG] Start end session request validation
2017-11-13 17:39:55.518 -05:00 [DBG] Start identity token validation
2017-11-13 17:39:55.539 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:55.540 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:39:55.543 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:39:55.547 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612792,
    "exp": 1510613092,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462095798005484.NWIwMzA2NzEtZjk3Ny00ZjQ4LWIwYjUtOTNlNTllYzUwYTFiYmNmZGMwODYtZGJkYi00M2Q3LTlhNTItMDBjOTk4ZjY3NmZi",
    "iat": 1510612792,
    "at_hash": "gGfeyfyMyLfP-EkgKeiFUA",
    "sid": "0616e8383fafeb30b7f26aba41a5c088",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612789,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:39:55.553 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VY8Udc9h8O0uIqJC1KUsjKmwH_NPdAFNgOhxrHGTV7toSViFVpNDQGyi67cuVWGq_P78d_F6-MOkcyvHHTatRmaWA_ksCI41GbZAr-EhGxVDoJZE-Y5wKp3IJhOjhA3JYDY4BTlaQ08vKMeY0OKyvTL",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTI3OTIsImV4cCI6MTUxMDYxMzA5MiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDk1Nzk4MDA1NDg0Lk5XSXdNekEyTnpFdFpqazNOeTAwWmpRNExXSXdZalV0T1RObE5UbGxZelV3WVRGaVltTm1aR013T0RZdFpHSmtZaTAwTTJRM0xUbGhOVEl0TURCak9UazRaalkzTm1aaSIsImlhdCI6MTUxMDYxMjc5MiwiYXRfaGFzaCI6ImdHZmV5ZnlNeUxmUC1Fa2dLZWlGVUEiLCJzaWQiOiIwNjE2ZTgzODNmYWZlYjMwYjdmMjZhYmE0MWE1YzA4OCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjc4OSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.DDXZ-575SvD5pMmRGq-VNZERWk_j5xAGqNGqVbAdi9oEuwivJZ5-3h2nE8wqmbkIpjJIckpsnNwyyGb0J-MBRQxKtdgQ6YOWBSREhxHUsSHOpCHY4CLU_-zQfzB_7m3n-SVBxykdBL5QIDgE8icNsJH0cA1g4oo-e507Nf-gO0TQNjhxklHLbKE_oi1ENI2P6gI4ZIZEeksY08EFPpeECFUkcQ7NmEHkNJBWBpOzOoFv5lSzj8_UOi5v7yumsizRjFcOBBS66bneWhYluPDRdwLZNt_7SpWllPeLlUzWxSBzZUYudXwaRMrQH-sftpcPskiFyBteBt5-WZPFWV-LMw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VY8Udc9h8O0uIqJC1KUsjKmwH_NPdAFNgOhxrHGTV7toSViFVpNDQGyi67cuVWGq_P78d_F6-MOkcyvHHTatRmaWA_ksCI41GbZAr-EhGxVDoJZE-Y5wKp3IJhOjhA3JYDY4BTlaQ08vKMeY0OKyvTL",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:55.561 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:39:55.567 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:55.568 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:55.570 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:39:55.571 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:39:55.572 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:39:55.573 -05:00 [INF] User logged out.
2017-11-13 17:39:55.764 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:39:55.767 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:39:55.769 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:39:55.771 -05:00 [DBG] Processing signout callback request
2017-11-13 17:39:55.800 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:55.801 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:39:55.802 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:39:55.802 -05:00 [INF] Successful signout callback.
2017-11-13 17:39:55.803 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:39:55.804 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:39:58.168 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:39:58.170 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:39:58.171 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:39:58.172 -05:00 [DBG] Start authorize request
2017-11-13 17:39:58.173 -05:00 [DBG] No user present in authorize request
2017-11-13 17:39:58.173 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:58.196 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:58.197 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:58.198 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:58.204 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:58.266 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:58.269 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:39:58.272 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:39:58.274 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:39:58.275 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
  "Nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:39:58.284 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:39:58.290 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:39:59.917 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:39:59.924 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:39:59.926 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:39:59.927 -05:00 [INF] User logged in.
2017-11-13 17:39:59.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:59.935 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:39:59.936 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:39:59.937 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:39:59.938 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:39:59.939 -05:00 [DBG] Start authorize callback request
2017-11-13 17:39:59.940 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:39:59.940 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:39:59.961 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:39:59.962 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:39:59.963 -05:00 [DBG] No PKCE used.
2017-11-13 17:39:59.970 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:00.040 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:00.047 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:00.131 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:00.133 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:00.134 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
  "Nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
  "SessionId": "fa65f515049b479bcd1e7d0824e9dbbc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:40:00.150 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:40:00.152 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:40:00.158 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:00.159 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:00.160 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:00.185 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:00.186 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:00.187 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:00.193 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:00.265 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:00.273 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:00.354 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:00.355 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:00.382 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:00.392 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:00.463 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:02.618 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:02.620 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:02.622 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:02.662 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:02.664 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:02.665 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:02.670 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:02.738 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:02.741 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:02.745 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:02.746 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:02.753 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:02.754 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:02.755 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:40:02.756 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:40:02.757 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:40:02.758 -05:00 [DBG] Start authorize callback request
2017-11-13 17:40:02.759 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:02.759 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:02.764 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:02.765 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:02.766 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:02.768 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:02.772 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:02.774 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:02.777 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:02.779 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:02.780 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
  "Nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
  "SessionId": "fa65f515049b479bcd1e7d0824e9dbbc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462095981609673.NGQ1ZTczMDUtMjg1MC00Yzc0LWI1ZjgtNWIxNzdjZjYxNGM0NjUxYTU0NGMtYzYyOS00YWVkLWFlZDgtOTk5YTE0ZDBlNGRj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:40:02.792 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:40:02.793 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:40:02.795 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:40:02.797 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:02.804 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:40:02.808 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:40:02.818 -05:00 [DBG] i5jrLzWDJIQhpxHnpl17tiTUJMShkXBJxsyYzVOeScw= not found in database
2017-11-13 17:40:02.821 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:40:02.822 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:40:02.824 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:40:02.829 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaJs7A9TMyVkqk0fQy8PStowtWbhKWLdd_HLExWVv3lonm7ktu6HzSP2S4ouI-FIKfDlqqBSVxu98aJpO-YhEto5n8sfdJn8ZBSlq9Kz8B3tCwPKWRd-PaeoprmYYEAC4Qq8OTqprWqfUcdlSRaQpAo1ZSYvTWPgwwZFw5S4xTDOpFvdwwhhgesBNmytsfJjqlHIfrTyHuTVMn1hY4UzQCkzDgPbHOqA4dOD-S2dR3_v3daHKO0x--jncVY3nfNmaksf4wjcaAFjKGdpn0Azio9",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:40:02.834 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:40:02.835 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:40:03.081 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:40:03.082 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:40:03.084 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:40:03.085 -05:00 [DBG] Start token request.
2017-11-13 17:40:03.086 -05:00 [DBG] Start client validation
2017-11-13 17:40:03.087 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:40:03.089 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:40:03.090 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:40:03.092 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:40:03.117 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:03.118 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:40:03.119 -05:00 [DBG] Client validation success
2017-11-13 17:40:03.119 -05:00 [DBG] Start token request validation
2017-11-13 17:40:03.120 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:40:03.123 -05:00 [DBG] i5jrLzWDJIQhpxHnpl17tiTUJMShkXBJxsyYzVOeScw= found in database: true
2017-11-13 17:40:03.137 -05:00 [DBG] removing i5jrLzWDJIQhpxHnpl17tiTUJMShkXBJxsyYzVOeScw= persisted grant from database
2017-11-13 17:40:03.145 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:40:03.147 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "065d5c48ad613c8d2b791881ba2ef725d8cee8602f5c8badf46e6784fdfd34c5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "065d5c48ad613c8d2b791881ba2ef725d8cee8602f5c8badf46e6784fdfd34c5",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:40:03.183 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:03.190 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:03.270 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:03.271 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:40:03.272 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:03.281 -05:00 [DBG] Creating refresh token
2017-11-13 17:40:03.282 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:40:03.292 -05:00 [DBG] 75lkUOwMrMDg3rF0BDY4LxhVLfxOeRTN0oUtipus3z8= not found in database
2017-11-13 17:40:03.313 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:03.320 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:03.385 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:03.386 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:40:03.388 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:40:03.392 -05:00 [DBG] Token request success.
2017-11-13 17:40:03.395 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:40:03.396 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:40:03.397 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:40:03.399 -05:00 [DBG] Start userinfo request
2017-11-13 17:40:03.400 -05:00 [DBG] Bearer token found in header
2017-11-13 17:40:03.429 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:03.457 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:03.459 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612803,
    "exp": 1510616403,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612799,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:40:03.469 -05:00 [DBG] Creating userinfo response
2017-11-13 17:40:03.470 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:40:03.478 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:03.479 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:40:03.487 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:40:03.488 -05:00 [DBG] End userinfo request
2017-11-13 17:40:16.004 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:40:16.006 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:40:16.008 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:40:16.009 -05:00 [DBG] Start authorize request
2017-11-13 17:40:16.010 -05:00 [DBG] No user present in authorize request
2017-11-13 17:40:16.011 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:16.032 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:16.033 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:16.034 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:16.040 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:16.105 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:16.112 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:16.186 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:16.187 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:16.189 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
  "Nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:40:16.198 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:40:16.204 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:40:17.846 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed in.
2017-11-13 17:40:17.855 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:40:23.979 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:40:23.986 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId was successfully authenticated.
2017-11-13 17:40:23.991 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:40:23.992 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe signed in.
2017-11-13 17:40:23.998 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:40:23.999 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:40:24.000 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e logged in with 2fa.
2017-11-13 17:40:24.008 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:24.009 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:24.010 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:40:24.011 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:40:24.012 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:40:24.013 -05:00 [DBG] Start authorize callback request
2017-11-13 17:40:24.015 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:24.015 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:24.037 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:24.038 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:24.039 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:24.045 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:24.108 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:24.111 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:24.115 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:24.116 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:24.118 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
  "Nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
  "SessionId": "6e0736847871c4ce1111904fddef45e8",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:40:24.129 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:40:24.130 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:40:24.137 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:24.138 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:24.139 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:24.145 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:24.146 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:24.146 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:24.149 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:24.154 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:24.155 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:24.159 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:24.160 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:24.164 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:24.169 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:24.232 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.102 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:29.104 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:29.106 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:29.135 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:29.136 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:29.137 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:29.143 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:29.210 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.218 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:29.279 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.282 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:29.288 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:29.289 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:29.290 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:40:29.291 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:40:29.292 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:40:29.293 -05:00 [DBG] Start authorize callback request
2017-11-13 17:40:29.294 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:29.295 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:40:29.317 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:29.318 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:40:29.319 -05:00 [DBG] No PKCE used.
2017-11-13 17:40:29.325 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:29.395 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.402 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:29.470 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.472 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:40:29.473 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
  "Nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
  "SessionId": "6e0736847871c4ce1111904fddef45e8",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:40:29.486 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:40:29.487 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:40:29.488 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:40:29.490 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:29.497 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:40:29.516 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:40:29.527 -05:00 [DBG] +d8QWIzH7cfUwh3tgUBS63U3LWKO2cmKee6TeJfnCQ4= not found in database
2017-11-13 17:40:29.530 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:40:29.531 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:40:29.532 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:40:29.537 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbWW5mshoxFgP9P822ZQAdc07jYis1dcmyi80SOKcVbonMRVoSp-EOZfzGShcDUmSQNUHh2kUur8mYACwMoSdpOdm5Z7DW5LE3yY9mlx0BFVgdOxW5zZ4JI5_-bQFcx8aC_vMbOuif00-OPnlqHRr0WZRROilGgQYra1p-D7J2aLekrqX6BTfiLV_A_bwWwruYx9xSENEuuU65lFFYM_WZOfEKV1DMkPL78zkD3pOvbcdM0cjSFg5szYnJVJjY_Q7tVkcfMV0-jKvMbmiiKG9XA",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:40:29.541 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:40:29.542 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:40:29.807 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:40:29.811 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:40:29.813 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:40:29.814 -05:00 [DBG] Start token request.
2017-11-13 17:40:29.815 -05:00 [DBG] Start client validation
2017-11-13 17:40:29.816 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:40:29.816 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:40:29.817 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:40:29.819 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:40:29.846 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:29.847 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:40:29.848 -05:00 [DBG] Client validation success
2017-11-13 17:40:29.848 -05:00 [DBG] Start token request validation
2017-11-13 17:40:29.849 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:40:29.853 -05:00 [DBG] +d8QWIzH7cfUwh3tgUBS63U3LWKO2cmKee6TeJfnCQ4= found in database: true
2017-11-13 17:40:29.863 -05:00 [DBG] removing +d8QWIzH7cfUwh3tgUBS63U3LWKO2cmKee6TeJfnCQ4= persisted grant from database
2017-11-13 17:40:29.870 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:40:29.871 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "0733d00b4ddfe2efaecaa9743cae9167ef7f367bc073a53ec43b8c0e60f8d168",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "0733d00b4ddfe2efaecaa9743cae9167ef7f367bc073a53ec43b8c0e60f8d168",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:40:29.879 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:29.887 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:29.957 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:29.959 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:40:29.960 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:40:29.968 -05:00 [DBG] Creating refresh token
2017-11-13 17:40:29.969 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:40:29.979 -05:00 [DBG] f+khPYSsAju4tuvP/RKHQJ2r1Z4SSp/tUUm3JqhIiBM= not found in database
2017-11-13 17:40:30.007 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:30.013 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:30.085 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:40:30.088 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:40:30.089 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:40:30.093 -05:00 [DBG] Token request success.
2017-11-13 17:40:30.096 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:40:30.097 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:40:30.098 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:40:30.099 -05:00 [DBG] Start userinfo request
2017-11-13 17:40:30.100 -05:00 [DBG] Bearer token found in header
2017-11-13 17:40:30.127 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:30.149 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:30.151 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510612829,
    "exp": 1510616429,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612823,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:40:30.159 -05:00 [DBG] Creating userinfo response
2017-11-13 17:40:30.159 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:40:30.166 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:40:30.168 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:40:30.173 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:40:30.174 -05:00 [DBG] End userinfo request
2017-11-13 17:40:49.743 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:49.745 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:51.719 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:51.721 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:40:51.730 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:40:51.732 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:40:51.733 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:40:51.734 -05:00 [INF] User logged out.
2017-11-13 17:40:51.811 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:40:51.812 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:40:51.814 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:40:51.815 -05:00 [DBG] Processing signout callback request
2017-11-13 17:40:51.844 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:40:51.845 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:40:51.845 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:40:51.846 -05:00 [INF] Successful signout callback.
2017-11-13 17:40:51.847 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:40:51.847 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:41:07.144 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-13 17:41:07.152 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:41:09.660 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:41:09.665 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:41:09.666 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:41:09.667 -05:00 [INF] User logged in.
2017-11-13 17:41:09.675 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:09.676 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:21.271 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:21.273 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:21.301 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:21.303 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:24.291 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:24.293 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:25.205 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:25.206 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:26.180 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:26.182 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:41:26.203 -05:00 [DBG] 11 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:41:26.243 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:41:26.250 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:41:26.317 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:11.243 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 17:43:11.275 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 17:43:11.276 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 17:43:11.277 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 17:43:11.277 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 17:43:11.477 -05:00 [DBG] Starting token cleanup
2017-11-13 17:43:13.257 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:13.274 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:13.281 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:43:13.286 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:43:13.287 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:43:13.300 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:43:13.306 -05:00 [DBG] Start end session request validation
2017-11-13 17:43:13.319 -05:00 [DBG] Start identity token validation
2017-11-13 17:43:14.080 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:43:14.085 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:43:14.120 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:43:14.216 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510612830,
    "exp": 1510613130,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462096159834081.MzAwYzExMTItOWU2OC00YTE0LThlZmUtZjc2YmExMjA1YzNjYTkyNmMzZjItZjhlYi00MTI4LWE3NzQtOWYzNTE0NzljYzFj",
    "iat": 1510612830,
    "at_hash": "m0RVwXHHmmhLP6PwC39MPw",
    "sid": "6e0736847871c4ce1111904fddef45e8",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510612823,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:43:14.239 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb4hZhK2Ms5MbNw8Eesb-8i326udpQuApLHJD5xQjtvqVlAj2jlHEuoY-stRCxw9CZ6FLIQf9JCtrAMHGEDg7bUBL0UD-jg_l6B_wQgYy_LoM8FkxFheVcsQETHJEPKblwXUHLSNjtnBjk8jbSZoOdK",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTI4MzAsImV4cCI6MTUxMDYxMzEzMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDk2MTU5ODM0MDgxLk16QXdZekV4TVRJdE9XVTJPQzAwWVRFMExUaGxabVV0WmpjMlltRXhNakExWXpOallUa3lObU16WmpJdFpqaGxZaTAwTVRJNExXRTNOelF0T1dZek5URTBOemxqWXpGaiIsImlhdCI6MTUxMDYxMjgzMCwiYXRfaGFzaCI6Im0wUlZ3WEhIbW1oTFA2UHdDMzlNUHciLCJzaWQiOiI2ZTA3MzY4NDc4NzFjNGNlMTExMTkwNGZkZGVmNDVlOCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMjgyMywiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.SwdQFdebVoJUHplbXyfEGTfWEu7RE7Pt5bCphSST-gb_7dwFPg4_5hz_AbuwQUNsGZvW1YAmB8oT9iXrIJyKFHJu_Xwy6QIGeF7_eaqDAYMjMF4sYxcGYKseClTkV4ZjhItmnP3zt7Q0QSpnWyUVIBcFthhXPRUw69HonrySt0PxOd7kB_A_1oy561bYVy-3MTyklA7LpAMnzmYwBGS17sLvoAdaMAKQQDoTfbyTk9UDgKfz3zp5Fr_Gd7itfWJGQuHcxJl-5SrgNvFZj7UF_Z0K9X-5GnHlb1dhievq-UBy4PQGvmvSRlCARXPUnmFhYxbamK6lA11heOQwGN_RbA",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb4hZhK2Ms5MbNw8Eesb-8i326udpQuApLHJD5xQjtvqVlAj2jlHEuoY-stRCxw9CZ6FLIQf9JCtrAMHGEDg7bUBL0UD-jg_l6B_wQgYy_LoM8FkxFheVcsQETHJEPKblwXUHLSNjtnBjk8jbSZoOdK",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:43:14.252 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:43:14.308 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:14.312 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:14.577 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:43:14.581 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:43:14.585 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:43:14.587 -05:00 [INF] User logged out.
2017-11-13 17:43:19.331 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:43:19.335 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:43:19.337 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:43:19.346 -05:00 [DBG] Start authorize request
2017-11-13 17:43:19.354 -05:00 [DBG] No user present in authorize request
2017-11-13 17:43:19.362 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:43:19.569 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:43:19.575 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:43:19.577 -05:00 [DBG] No PKCE used.
2017-11-13 17:43:19.680 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:20.020 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:20.078 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:20.233 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:20.247 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:43:20.260 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:43:20.283 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:43:20.340 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:43:23.468 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:43:23.589 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:43:23.597 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:43:23.600 -05:00 [INF] User logged in.
2017-11-13 17:43:23.616 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:23.619 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:23.621 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:43:23.623 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:43:23.625 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:43:23.634 -05:00 [DBG] Start authorize callback request
2017-11-13 17:43:23.638 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:43:23.639 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:43:23.843 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:43:23.845 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:43:23.846 -05:00 [DBG] No PKCE used.
2017-11-13 17:43:23.885 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:24.060 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:24.098 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:24.268 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:24.270 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:43:24.272 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
  "SessionId": "1a5081634f8386e08072f44109ec49cf",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:43:24.319 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:43:24.320 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:43:24.332 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:24.334 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:43:34.237 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:43:34.479 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:43:34.480 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:43:34.481 -05:00 [DBG] No PKCE used.
2017-11-13 17:43:34.528 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:34.720 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:34.772 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:43:34.955 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:43:34.956 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:43:58.718 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:44:08.877 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T22:44:08.8521178+00:00"".
2017-11-13 17:44:08.905 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:44:09.076 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:46:45.480 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:45.483 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:45.502 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:46:47.840 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:47.844 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:47.934 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:46:47.996 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:46:47.998 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:46:48.001 -05:00 [INF] User logged in.
2017-11-13 17:46:48.016 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:48.019 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:48.022 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:46:48.023 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:46:48.025 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:46:48.028 -05:00 [DBG] Start authorize callback request
2017-11-13 17:46:48.030 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:46:48.031 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:46:48.221 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:46:48.222 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:46:48.224 -05:00 [DBG] No PKCE used.
2017-11-13 17:46:48.266 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:46:48.420 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:46:48.466 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:46:48.626 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:46:48.628 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:46:48.631 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
  "SessionId": "58fb94aa1428f4f6b96fcffd101792c5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:46:48.674 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:46:48.675 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:46:48.689 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:48.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:46:52.442 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:46:52.710 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:46:52.712 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:46:52.713 -05:00 [DBG] No PKCE used.
2017-11-13 17:46:52.761 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:46:52.937 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:46:52.990 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:46:53.182 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:46:53.184 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:46:53.434 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:46:53.493 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:46:53.660 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:47:40.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:40.290 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:40.316 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:47:41.837 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:41.840 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:41.950 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:47:42.014 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:47:42.017 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:47:42.020 -05:00 [INF] User logged in.
2017-11-13 17:47:42.034 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:42.037 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:42.040 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:47:42.041 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:47:42.042 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:47:42.045 -05:00 [DBG] Start authorize callback request
2017-11-13 17:47:42.046 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:47:42.047 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:47:42.250 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:47:42.251 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:47:42.252 -05:00 [DBG] No PKCE used.
2017-11-13 17:47:42.296 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:47:42.455 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:47:42.491 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:47:42.642 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:47:42.643 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:47:42.645 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
  "SessionId": "b1bdd6cd51aa879d80046d4b70ce26af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:47:42.678 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:47:42.679 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:47:42.689 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:47:42.692 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:48:36.977 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:48:37.255 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:48:37.256 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:48:37.256 -05:00 [DBG] No PKCE used.
2017-11-13 17:48:37.307 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:48:37.514 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:48:37.560 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:48:37.670 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:48:37.672 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:48:37.865 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:48:37.910 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:48:38.090 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:48:54.926 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:48:54.929 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:49:33.092 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:49:33.332 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:33.333 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:49:33.333 -05:00 [DBG] No PKCE used.
2017-11-13 17:49:33.382 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:33.552 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:33.596 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:33.707 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:33.708 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:49:44.083 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T22:49:44.0830066+00:00"".
2017-11-13 17:49:53.026 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:49:53.029 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:49:53.032 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:49:53.033 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:49:53.035 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:49:53.039 -05:00 [DBG] Start authorize callback request
2017-11-13 17:49:53.042 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:49:53.044 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:49:53.199 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:53.201 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:49:53.202 -05:00 [DBG] No PKCE used.
2017-11-13 17:49:53.237 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:53.315 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:53.350 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:53.433 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:53.434 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:49:53.435 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
  "SessionId": "b1bdd6cd51aa879d80046d4b70ce26af",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:49:53.493 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:49:53.499 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:49:53.506 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:49:53.511 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:49:53.571 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 17:49:53.646 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:49:53.698 -05:00 [DBG] /32r/I/WL2Z0vqX2mzobghEJ6ZSO81zCEuE5vrnNEEw= not found in database
2017-11-13 17:49:53.741 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:49:53.751 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:49:53.754 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:49:53.797 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vb_FpTq11GuOzpwsDQAdjAqM_5V2yLjuwzri6wK10Eolm9uH0TFbTzJ42xKyI6CloP9pMElff3hAkRdCv30d2_vEo6_hnzZWmC94Y88X7wwS0w11Mq1Skqvr4ueJ5Umhv4daqiVMLNd54Nvzspzq3w-qoi7Dgd-MKc9QvKPl62Mah_mNO9T6kEcwaZPgmk2DXeiPwuAku8TUfda3-GIxtX0c5ARPiTCxKwcQSR8_mZHpzJ_vceos7bVHzOAUsKOnx1RdJoJOmfE1mdu3Oclw2H0",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:49:53.814 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:49:53.815 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:49:54.088 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 17:49:54.096 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 17:49:54.100 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 17:49:54.111 -05:00 [DBG] Start token request.
2017-11-13 17:49:54.117 -05:00 [DBG] Start client validation
2017-11-13 17:49:54.124 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 17:49:54.129 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 17:49:54.130 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 17:49:54.132 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 17:49:54.314 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:54.326 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 17:49:54.327 -05:00 [DBG] Client validation success
2017-11-13 17:49:54.333 -05:00 [DBG] Start token request validation
2017-11-13 17:49:54.344 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 17:49:54.396 -05:00 [DBG] /32r/I/WL2Z0vqX2mzobghEJ6ZSO81zCEuE5vrnNEEw= found in database: true
2017-11-13 17:49:54.444 -05:00 [DBG] removing /32r/I/WL2Z0vqX2mzobghEJ6ZSO81zCEuE5vrnNEEw= persisted grant from database
2017-11-13 17:49:54.500 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 17:49:54.510 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "3376d472de889ef4cd311e0d865e8595ab128691d6049952d153f8ae21f409ea",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "3376d472de889ef4cd311e0d865e8595ab128691d6049952d153f8ae21f409ea",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 17:49:54.896 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:54.964 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:55.183 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:55.194 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 17:49:55.195 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:49:55.267 -05:00 [DBG] Creating refresh token
2017-11-13 17:49:55.268 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 17:49:55.311 -05:00 [DBG] WzkQV1Tsyne4hGI7KcaPzLdFFcNmgcYjBPEuVz8fURg= not found in database
2017-11-13 17:49:55.661 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:55.721 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:55.921 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:49:55.923 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:49:55.924 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:49:55.931 -05:00 [DBG] Token request success.
2017-11-13 17:49:55.946 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 17:49:55.949 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 17:49:55.950 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 17:49:55.960 -05:00 [DBG] Start userinfo request
2017-11-13 17:49:55.965 -05:00 [DBG] Bearer token found in header
2017-11-13 17:49:56.405 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:56.697 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:49:56.698 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510613395,
    "exp": 1510616995,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510613262,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 17:49:56.713 -05:00 [DBG] Creating userinfo response
2017-11-13 17:49:56.719 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 17:49:56.799 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:49:56.802 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 17:49:56.867 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 17:49:56.871 -05:00 [DBG] End userinfo request
2017-11-13 17:49:58.762 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:49:58.764 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:00.945 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:00.948 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:01.034 -05:00 [DBG] 12 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:50:01.279 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:01.330 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:01.509 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:02.725 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:02.729 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:02.802 -05:00 [DBG] removing 12 persisted grants from database for subject cf559f42-d46a-4dea-9390-b50e0f71a84e, clientId mvc.hybrid
2017-11-13 17:50:02.842 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:02.845 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:02.888 -05:00 [DBG] 0 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:50:06.002 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:06.005 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:07.938 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:07.941 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:11.967 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:11.972 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:12.022 -05:00 [DBG] 0 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:50:16.220 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:16.223 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:16.226 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 17:50:16.228 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 17:50:16.229 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 17:50:16.232 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:50:16.233 -05:00 [DBG] Start end session request validation
2017-11-13 17:50:16.234 -05:00 [DBG] Start identity token validation
2017-11-13 17:50:16.412 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:16.413 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 17:50:16.416 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 17:50:16.440 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510613395,
    "exp": 1510613695,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462097993229133.NTIzMjI0ZDEtZTAxZS00ZDM0LTljMmUtNzZmOGU5N2I0NWZmM2JmYWEwMjgtMTM3ZS00NmFjLWFiNTUtNThjODc3Mjg1ODdi",
    "iat": 1510613395,
    "at_hash": "fO7Q6jKf3LGaAIFVKt0E1Q",
    "sid": "b1bdd6cd51aa879d80046d4b70ce26af",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510613262,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 17:50:16.445 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vajau4wceobLSZNgk6oiladi2E2FE8xxf9Ol6ij4pzm_knh-7UrEk5KCs0Ceor2Pcj-SXhwhIPqWplJrwtPAoeqOv352Kw9-3BYtXwWJ7ZBzOoE1Jy5RcYfnemakXla_J1NhXSPWkw-A7lOJ9NPyL97",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTMzOTUsImV4cCI6MTUxMDYxMzY5NSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMDk3OTkzMjI5MTMzLk5USXpNakkwWkRFdFpUQXhaUzAwWkRNMExUbGpNbVV0TnpabU9HVTVOMkkwTldabU0ySm1ZV0V3TWpndE1UTTNaUzAwTm1GakxXRmlOVFV0TlRoak9EYzNNamcxT0RkaSIsImlhdCI6MTUxMDYxMzM5NSwiYXRfaGFzaCI6ImZPN1E2aktmM0xHYUFJRlZLdDBFMVEiLCJzaWQiOiJiMWJkZDZjZDUxYWE4NzlkODAwNDZkNGI3MGNlMjZhZiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMzI2MiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.K0vCIJcTzBvfCuCBa5Vy3vDtgdB9jpO7fraUgZpK4ZEd-1W7uQGgjcCnKO_xIDKhZ-MSElIkjYSMibS_B1-Lm93hXxB3vs8CwwmkkzUd7fa9sUTH03EEIQiWGYCollCSsVUy0VPQ1iHuOzRTqCfTme1-PViey9l8NXXlkTS0Qq0kiUWNQIxhZ8Hzf-xGqzwmcJH4XjxvFRcPHMX8ZcZzW5YXrb4qsJNCOAWwa4zqHH70pbe0nvCrcAZnWj7InrOQTbMaF86S8LGbrEEWhQ_Rg5ZIKxwP3mt4HiKSifHiOvGO4cVtiY5FrmkddE3D5IOlfPygk63VNu-2iTH4SilLyQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vajau4wceobLSZNgk6oiladi2E2FE8xxf9Ol6ij4pzm_knh-7UrEk5KCs0Ceor2Pcj-SXhwhIPqWplJrwtPAoeqOv352Kw9-3BYtXwWJ7ZBzOoE1Jy5RcYfnemakXla_J1NhXSPWkw-A7lOJ9NPyL97",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:50:16.459 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 17:50:16.467 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:16.469 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:16.491 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 17:50:16.495 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:50:16.498 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 17:50:16.500 -05:00 [INF] User logged out.
2017-11-13 17:50:16.723 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 17:50:16.731 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 17:50:16.737 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 17:50:16.749 -05:00 [DBG] Processing signout callback request
2017-11-13 17:50:16.982 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:16.983 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 17:50:16.984 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 17:50:16.984 -05:00 [INF] Successful signout callback.
2017-11-13 17:50:16.987 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 17:50:16.989 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 17:50:19.219 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 17:50:19.221 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 17:50:19.224 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 17:50:19.228 -05:00 [DBG] Start authorize request
2017-11-13 17:50:19.229 -05:00 [DBG] No user present in authorize request
2017-11-13 17:50:19.230 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:50:19.436 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:19.437 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:50:19.439 -05:00 [DBG] No PKCE used.
2017-11-13 17:50:19.489 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:19.658 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:19.692 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:19.840 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:19.841 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:50:19.842 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
  "Nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:50:19.855 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 17:50:19.896 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 17:50:21.790 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 17:50:21.851 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:50:21.853 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:50:21.856 -05:00 [INF] User logged in.
2017-11-13 17:50:21.868 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:21.872 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:21.876 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:50:21.877 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:50:21.879 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:50:21.882 -05:00 [DBG] Start authorize callback request
2017-11-13 17:50:21.883 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:50:21.883 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:50:22.075 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:22.077 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:50:22.078 -05:00 [DBG] No PKCE used.
2017-11-13 17:50:22.120 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:22.281 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:22.315 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:22.479 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:22.482 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:50:22.483 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
  "Nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
  "SessionId": "fe56f1c0e85aaefea8979c62c6e77c2a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:50:22.521 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:50:22.521 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 17:50:22.530 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:22.533 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:50:30.557 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:50:30.807 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:30.809 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:50:30.809 -05:00 [DBG] No PKCE used.
2017-11-13 17:50:30.857 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:31.049 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:31.105 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:31.288 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:50:31.290 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:50:31.544 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:50:31.608 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:50:31.802 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:51:32.708 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:51:32.712 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:51:48.659 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T22:51:48.6597592+00:00"".
2017-11-13 17:52:28.852 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:52:29.092 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:52:29.093 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:52:29.094 -05:00 [DBG] No PKCE used.
2017-11-13 17:52:29.142 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:52:29.328 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:52:29.377 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:52:29.575 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:52:29.577 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:52:35.904 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T22:52:35.9048181+00:00"".
2017-11-13 17:52:50.628 -05:00 [WRN] Heartbeat took longer than ""00:00:01"" at ""2017-11-13T22:52:50.6281170+00:00"".
2017-11-13 17:53:05.065 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:53:05.068 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 17:53:05.071 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 17:53:05.072 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 17:53:05.073 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 17:53:05.077 -05:00 [DBG] Start authorize callback request
2017-11-13 17:53:05.078 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:53:05.079 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 17:53:05.281 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 17:53:05.283 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 17:53:05.284 -05:00 [DBG] No PKCE used.
2017-11-13 17:53:05.331 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:53:05.483 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:53:05.519 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 17:53:05.678 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 17:53:05.680 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 17:53:05.681 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
  "Nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
  "SessionId": "fe56f1c0e85aaefea8979c62c6e77c2a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462102192101509.YTQyNmNmOWMtZDJjZS00OGMyLWFlYTEtZmNjNTk4NzRjNDZlMTRkYWM3ZjUtMGNlOS00NmRkLWI5ODMtZGRiMzliNzhiOWUy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 17:53:05.748 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 17:53:05.749 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:53:05.752 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 17:53:05.755 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 17:53:05.795 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 17:53:05.831 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 17:53:05.866 -05:00 [DBG] jsK9shyujU+l+wSucg8e4DNeaTApQj6kaWq661PYmLI= not found in database
2017-11-13 17:53:05.900 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 17:53:05.902 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 17:53:05.903 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 17:53:05.909 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaWTq_oZ_Juezf5HT02DJ9XXTk0xZpICJh9oAHtp1AlW8urO2O8khIaX27pkNUO6h6YhoF0kRviDRra5FKiqV-RCTbRtudqHnKx0TpG-sJ_wANtitX8bxYjFbCohwhcvrP-ZggujBs0toFzU7tiKGUYlyJuiU5rYAuxtt4keSKsO9gIQ4h5k0sYtD4MYc-unt9lsWMohgq_ve5NwvZAajbPmxthv5OG90hcLilICSnSBTTpX9lezYLtcolFVYUa0Hp8-1Rpli9JnLGGXcOxTw0c",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 17:53:05.915 -05:00 [DBG] Augmenting SignInContext
2017-11-13 17:53:05.916 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 17:53:06.216 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 18:02:20.219 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:02:20.249 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:02:20.251 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:02:20.251 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:02:20.252 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:02:20.329 -05:00 [DBG] Starting token cleanup
2017-11-13 18:02:30.134 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:02:30.163 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:02:30.164 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:02:30.165 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:02:30.166 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:02:30.347 -05:00 [DBG] Starting token cleanup
2017-11-13 18:02:35.487 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:02:35.504 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:02:35.511 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:02:35.518 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:02:35.519 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:02:35.526 -05:00 [DBG] Start authorize request
2017-11-13 18:02:35.539 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:02:35.551 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:02:36.297 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:02:36.310 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:02:36.311 -05:00 [DBG] No PKCE used.
2017-11-13 18:02:36.403 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:02:36.732 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:02:36.785 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:02:36.926 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:02:36.935 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:02:37.003 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbRl5M4DMJ5DJtaeBDQUCta6tVxjOun4lMjTJxKlGdC64oWyClZvOuwaFf1gUjm5Fp8Z9gUskMU4uOPm_eFQxDz3fPDxKGpG1So6w6UAiOJ0Qt_ho2ibi8tGddTz_FU82keWhBVTeKhJ2I2lnJUbvlhZoidsfemdFsTJI_cKeQ1uXfrin4RLbMiruzzo0Z7W1wuw3XQ9SARUnZswByOSrHnEYrOnaSCDlaG_TYxRH72sRDZVvZGeOKoNDHyky_hA_2N5i2MmZQ53rYENAAAnexE",
  "Nonce": "636462109553178747.ZGY4ZDcxMTctZTU5My00MjBmLWEwODQtZmQ2NzRmZGJiYzU4MjhjMjA2NjEtYzU2NS00ZDQ5LWE3ZDItMmFjMjQ1NDNjOWIy",
  "SessionId": "fe56f1c0e85aaefea8979c62c6e77c2a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462109553178747.ZGY4ZDcxMTctZTU5My00MjBmLWEwODQtZmQ2NzRmZGJiYzU4MjhjMjA2NjEtYzU2NS00ZDQ5LWE3ZDItMmFjMjQ1NDNjOWIy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbRl5M4DMJ5DJtaeBDQUCta6tVxjOun4lMjTJxKlGdC64oWyClZvOuwaFf1gUjm5Fp8Z9gUskMU4uOPm_eFQxDz3fPDxKGpG1So6w6UAiOJ0Qt_ho2ibi8tGddTz_FU82keWhBVTeKhJ2I2lnJUbvlhZoidsfemdFsTJI_cKeQ1uXfrin4RLbMiruzzo0Z7W1wuw3XQ9SARUnZswByOSrHnEYrOnaSCDlaG_TYxRH72sRDZVvZGeOKoNDHyky_hA_2N5i2MmZQ53rYENAAAnexE",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:02:37.109 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:02:37.110 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:02:37.146 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:02:37.154 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:12:10.474 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:12:10.503 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:12:10.504 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:12:10.505 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:12:10.505 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:12:10.653 -05:00 [DBG] Starting token cleanup
2017-11-13 18:13:24.292 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:13:24.327 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:13:24.335 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:13:24.343 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:13:24.351 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:13:24.359 -05:00 [DBG] Start authorize request
2017-11-13 18:13:24.376 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:13:24.528 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:13:25.549 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:13:25.559 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:13:25.560 -05:00 [DBG] No PKCE used.
2017-11-13 18:13:25.652 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:13:26.137 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:13:26.202 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:13:26.384 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:13:26.396 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:13:26.501 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZPGMo36suKt71GrnMJ1oCv4jXtBapTY36cRv0_1AHgdyZRrd__nJFj_dNJt-T0hlku7JUP5COEcQIF1Ikg0mz2wHlGlkykpx3N87usMp2liNOGGSto_FMhtaEpLypDwVd77f0anvn1jpkw2VM2W7IuUGVkse_RnqUyac4r0HjgFqaFUY6dh_ffxjlE9KJRaJjdbz2vZXgfIfPtGLNa_DG9zijeG-cVRm_7i-QJ7zRinYlole9C4wVNGS6KH-4oSctsoFuaxKW7q5xF2BtSP-Pl",
  "Nonce": "636462116038564669.YTk4NzJhMDQtM2Y3Yi00YTdkLWI0YzktYjVhMWUxYzk3YTg1YzA3MjA0ZWItMDEyNS00ZWRiLWFmMzAtNGQ2ODQ2NWNiNmIw",
  "SessionId": "fe56f1c0e85aaefea8979c62c6e77c2a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462116038564669.YTk4NzJhMDQtM2Y3Yi00YTdkLWI0YzktYjVhMWUxYzk3YTg1YzA3MjA0ZWItMDEyNS00ZWRiLWFmMzAtNGQ2ODQ2NWNiNmIw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZPGMo36suKt71GrnMJ1oCv4jXtBapTY36cRv0_1AHgdyZRrd__nJFj_dNJt-T0hlku7JUP5COEcQIF1Ikg0mz2wHlGlkykpx3N87usMp2liNOGGSto_FMhtaEpLypDwVd77f0anvn1jpkw2VM2W7IuUGVkse_RnqUyac4r0HjgFqaFUY6dh_ffxjlE9KJRaJjdbz2vZXgfIfPtGLNa_DG9zijeG-cVRm_7i-QJ7zRinYlole9C4wVNGS6KH-4oSctsoFuaxKW7q5xF2BtSP-Pl",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:13:26.663 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:13:26.664 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:13:26.751 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:13:26.755 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:13:34.899 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:13:35.456 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:13:35.461 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:13:35.462 -05:00 [DBG] No PKCE used.
2017-11-13 18:13:35.564 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:13:35.992 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:13:36.150 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:13:36.612 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:13:36.613 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:13:37.323 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:13:37.548 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:13:38.165 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:13:48.892 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:13:48.942 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:14:08.488 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:14:08.758 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:14:08.759 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:14:08.760 -05:00 [DBG] No PKCE used.
2017-11-13 18:14:08.812 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:14:09.031 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:14:09.077 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:14:09.286 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:14:09.287 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:15:27.459 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:27.462 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:27.465 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 18:15:27.467 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 18:15:27.468 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 18:15:27.478 -05:00 [DBG] Start authorize callback request
2017-11-13 18:15:27.508 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:15:27.509 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:15:27.698 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:27.699 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:15:27.700 -05:00 [DBG] No PKCE used.
2017-11-13 18:15:27.739 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:27.890 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:27.928 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:28.091 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:28.092 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:15:28.094 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZPGMo36suKt71GrnMJ1oCv4jXtBapTY36cRv0_1AHgdyZRrd__nJFj_dNJt-T0hlku7JUP5COEcQIF1Ikg0mz2wHlGlkykpx3N87usMp2liNOGGSto_FMhtaEpLypDwVd77f0anvn1jpkw2VM2W7IuUGVkse_RnqUyac4r0HjgFqaFUY6dh_ffxjlE9KJRaJjdbz2vZXgfIfPtGLNa_DG9zijeG-cVRm_7i-QJ7zRinYlole9C4wVNGS6KH-4oSctsoFuaxKW7q5xF2BtSP-Pl",
  "Nonce": "636462116038564669.YTk4NzJhMDQtM2Y3Yi00YTdkLWI0YzktYjVhMWUxYzk3YTg1YzA3MjA0ZWItMDEyNS00ZWRiLWFmMzAtNGQ2ODQ2NWNiNmIw",
  "SessionId": "fe56f1c0e85aaefea8979c62c6e77c2a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462116038564669.YTk4NzJhMDQtM2Y3Yi00YTdkLWI0YzktYjVhMWUxYzk3YTg1YzA3MjA0ZWItMDEyNS00ZWRiLWFmMzAtNGQ2ODQ2NWNiNmIw",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZPGMo36suKt71GrnMJ1oCv4jXtBapTY36cRv0_1AHgdyZRrd__nJFj_dNJt-T0hlku7JUP5COEcQIF1Ikg0mz2wHlGlkykpx3N87usMp2liNOGGSto_FMhtaEpLypDwVd77f0anvn1jpkw2VM2W7IuUGVkse_RnqUyac4r0HjgFqaFUY6dh_ffxjlE9KJRaJjdbz2vZXgfIfPtGLNa_DG9zijeG-cVRm_7i-QJ7zRinYlole9C4wVNGS6KH-4oSctsoFuaxKW7q5xF2BtSP-Pl",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:15:28.149 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:15:28.156 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 18:15:28.162 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 18:15:28.167 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:15:28.235 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 18:15:28.318 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 18:15:28.381 -05:00 [DBG] 4ylG3Gqs5Ep0b6jGiCBOLGX9QIXTxFiIo0v0qkDMqR8= not found in database
2017-11-13 18:15:28.446 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 18:15:28.458 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 18:15:28.461 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 18:15:28.533 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZPGMo36suKt71GrnMJ1oCv4jXtBapTY36cRv0_1AHgdyZRrd__nJFj_dNJt-T0hlku7JUP5COEcQIF1Ikg0mz2wHlGlkykpx3N87usMp2liNOGGSto_FMhtaEpLypDwVd77f0anvn1jpkw2VM2W7IuUGVkse_RnqUyac4r0HjgFqaFUY6dh_ffxjlE9KJRaJjdbz2vZXgfIfPtGLNa_DG9zijeG-cVRm_7i-QJ7zRinYlole9C4wVNGS6KH-4oSctsoFuaxKW7q5xF2BtSP-Pl",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 18:15:28.797 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 18:15:28.806 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 18:15:28.807 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 18:15:28.820 -05:00 [DBG] Start token request.
2017-11-13 18:15:28.829 -05:00 [DBG] Start client validation
2017-11-13 18:15:28.836 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 18:15:28.842 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 18:15:28.844 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 18:15:28.845 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 18:15:29.058 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:29.069 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 18:15:29.071 -05:00 [DBG] Client validation success
2017-11-13 18:15:29.080 -05:00 [DBG] Start token request validation
2017-11-13 18:15:29.093 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 18:15:29.136 -05:00 [DBG] 4ylG3Gqs5Ep0b6jGiCBOLGX9QIXTxFiIo0v0qkDMqR8= found in database: true
2017-11-13 18:15:29.177 -05:00 [DBG] removing 4ylG3Gqs5Ep0b6jGiCBOLGX9QIXTxFiIo0v0qkDMqR8= persisted grant from database
2017-11-13 18:15:29.231 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 18:15:29.240 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "ab3f1467c7efb8fe82a1cc503a3249746e1258f46086e209fcf3fdcee1b606a2",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "ab3f1467c7efb8fe82a1cc503a3249746e1258f46086e209fcf3fdcee1b606a2",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 18:15:29.597 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:29.660 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:29.885 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:29.898 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 18:15:29.899 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:15:30.041 -05:00 [DBG] Creating refresh token
2017-11-13 18:15:30.042 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 18:15:30.087 -05:00 [DBG] 6a9jg8M/A0XjfHAmyGDKvWsZ3Uvnp6N4gZuIEoLhH+U= not found in database
2017-11-13 18:15:30.430 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:30.492 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:30.699 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:30.701 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 18:15:30.703 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 18:15:30.710 -05:00 [DBG] Token request success.
2017-11-13 18:15:30.726 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 18:15:30.729 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 18:15:30.730 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 18:15:30.739 -05:00 [DBG] Start userinfo request
2017-11-13 18:15:30.743 -05:00 [DBG] Bearer token found in header
2017-11-13 18:15:31.231 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:31.577 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:31.582 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510614930,
    "exp": 1510618530,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510613421,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 18:15:31.599 -05:00 [DBG] Creating userinfo response
2017-11-13 18:15:31.604 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 18:15:31.667 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:31.670 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 18:15:31.728 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 18:15:31.731 -05:00 [DBG] End userinfo request
2017-11-13 18:15:34.766 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:34.769 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:34.773 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 18:15:34.777 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 18:15:34.779 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 18:15:34.792 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:15:34.799 -05:00 [DBG] Start end session request validation
2017-11-13 18:15:34.805 -05:00 [DBG] Start identity token validation
2017-11-13 18:15:34.995 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:34.996 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 18:15:35.000 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 18:15:35.028 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510614930,
    "exp": 1510615230,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462116038564669.YTk4NzJhMDQtM2Y3Yi00YTdkLWI0YzktYjVhMWUxYzk3YTg1YzA3MjA0ZWItMDEyNS00ZWRiLWFmMzAtNGQ2ODQ2NWNiNmIw",
    "iat": 1510614930,
    "at_hash": "7OpqPKjh5nan2m4Xdssy7g",
    "sid": "fe56f1c0e85aaefea8979c62c6e77c2a",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510613421,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 18:15:35.040 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZu4KMKnjkcGcM1TQvpssbQ30yKV9_Kn84kQL0LNLRCyP1n36_qZ63sOaHzNBZ6BsgCtTuFf-BeWjklQrqac2iVJK2WvNxHfoICFPKyw3ok2kOf1A_Le1ZmRNwq855PfUj2Tib3ztXCXtVtPHH8n5QV",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTQ5MzAsImV4cCI6MTUxMDYxNTIzMCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTE2MDM4NTY0NjY5LllUazROekpoTURRdE0yWTNZaTAwWVRka0xXSTBZemt0WWpWaE1XVXhZemszWVRnMVl6QTNNakEwWldJdE1ERXlOUzAwWldSaUxXRm1NekF0TkdRMk9EUTJOV05pTm1JdyIsImlhdCI6MTUxMDYxNDkzMCwiYXRfaGFzaCI6IjdPcHFQS2poNW5hbjJtNFhkc3N5N2ciLCJzaWQiOiJmZTU2ZjFjMGU4NWFhZWZlYTg5NzljNjJjNmU3N2MyYSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxMzQyMSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.VIMhTxhTKcROsHLXwh9d3FUUtd53Rufbgy84C18x0yZEKbF3MRbM81GeMXXEnG8pPcbe-M-KOo2tdWLkrwvc0M02vYmv5-RN1p9LlqZRLiftu0yJJlWfv4yN-FfI2jLWRebA4Dj5fyfEcqYqYKkjQDzuM3B4npooRftXdOEJmLJ6bgOQizRJywcok8YQlKNoH6SO9-uSiwjRJjJoUvXOAnRJKNkqkA7lC7JaLaF2Mo_PV2ZIIkqQ5rFYlRkWk3Sc8ud-mounbJWSjzBowFSDZ5reQE74VB8zBHbXy1uLjlhGq_E2FXuNg9YuoP7lqM2pJY48Yuwpk0d4yB2oiE8fng",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZu4KMKnjkcGcM1TQvpssbQ30yKV9_Kn84kQL0LNLRCyP1n36_qZ63sOaHzNBZ6BsgCtTuFf-BeWjklQrqac2iVJK2WvNxHfoICFPKyw3ok2kOf1A_Le1ZmRNwq855PfUj2Tib3ztXCXtVtPHH8n5QV",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:15:35.051 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 18:15:35.072 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:35.075 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:35.145 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 18:15:35.149 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 18:15:35.151 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 18:15:35.155 -05:00 [INF] User logged out.
2017-11-13 18:15:35.493 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 18:15:35.497 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 18:15:35.499 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 18:15:35.508 -05:00 [DBG] Processing signout callback request
2017-11-13 18:15:35.726 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:35.727 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 18:15:35.728 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 18:15:35.729 -05:00 [INF] Successful signout callback.
2017-11-13 18:15:35.732 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 18:15:35.733 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 18:15:37.369 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:15:37.371 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:15:37.372 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:15:37.376 -05:00 [DBG] Start authorize request
2017-11-13 18:15:37.377 -05:00 [DBG] No user present in authorize request
2017-11-13 18:15:37.378 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:15:37.571 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:37.572 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:15:37.572 -05:00 [DBG] No PKCE used.
2017-11-13 18:15:37.607 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:37.749 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:37.792 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:37.952 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:37.969 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:15:37.971 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYdr3EuQWyQt49wYcM26j0ZR0CBwlasZNlskGd97rPxRvz8cg_m06VfrJs9NGM5p5sDdqRxp5r9lfEEGs7NI72AQX9x7CpZJL-cihTz1m2ZVgZ2TGj44pFTq6x7ZknVM_Oy_GYDNX316UGZgR0KTCDYxwpmgYY4n0XPe6EHa1jWW6aJHGZOLuKW_PIjgjZtXRd2cwMjq50sVWn8Li7XjwndbsmQC5umdtT6E8us-t0ZJsOy3VyJL-XGcyzJ5VD4STPVO8lxt23U1vFhiVYIosol",
  "Nonce": "636462117373604961.ODBjNTBlYTItZDI0NS00NDYwLTliNmQtZmQ4YWJiOWY3ZjA1YjJjNTg5ODUtM2NmNy00MTE4LWEwMDYtNGI0MGI3OTJlMTRi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462117373604961.ODBjNTBlYTItZDI0NS00NDYwLTliNmQtZmQ4YWJiOWY3ZjA1YjJjNTg5ODUtM2NmNy00MTE4LWEwMDYtNGI0MGI3OTJlMTRi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYdr3EuQWyQt49wYcM26j0ZR0CBwlasZNlskGd97rPxRvz8cg_m06VfrJs9NGM5p5sDdqRxp5r9lfEEGs7NI72AQX9x7CpZJL-cihTz1m2ZVgZ2TGj44pFTq6x7ZknVM_Oy_GYDNX316UGZgR0KTCDYxwpmgYY4n0XPe6EHa1jWW6aJHGZOLuKW_PIjgjZtXRd2cwMjq50sVWn8Li7XjwndbsmQC5umdtT6E8us-t0ZJsOy3VyJL-XGcyzJ5VD4STPVO8lxt23U1vFhiVYIosol",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:15:37.984 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 18:15:38.021 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 18:15:39.808 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 18:15:39.875 -05:00 [DBG] Augmenting SignInContext
2017-11-13 18:15:39.881 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 18:15:39.885 -05:00 [INF] User logged in.
2017-11-13 18:15:39.897 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:39.900 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:39.902 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 18:15:39.904 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 18:15:39.905 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 18:15:39.908 -05:00 [DBG] Start authorize callback request
2017-11-13 18:15:39.909 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:15:39.910 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:15:40.099 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:40.100 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:15:40.100 -05:00 [DBG] No PKCE used.
2017-11-13 18:15:40.140 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:40.284 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:40.324 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:40.502 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:40.504 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:15:40.505 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYdr3EuQWyQt49wYcM26j0ZR0CBwlasZNlskGd97rPxRvz8cg_m06VfrJs9NGM5p5sDdqRxp5r9lfEEGs7NI72AQX9x7CpZJL-cihTz1m2ZVgZ2TGj44pFTq6x7ZknVM_Oy_GYDNX316UGZgR0KTCDYxwpmgYY4n0XPe6EHa1jWW6aJHGZOLuKW_PIjgjZtXRd2cwMjq50sVWn8Li7XjwndbsmQC5umdtT6E8us-t0ZJsOy3VyJL-XGcyzJ5VD4STPVO8lxt23U1vFhiVYIosol",
  "Nonce": "636462117373604961.ODBjNTBlYTItZDI0NS00NDYwLTliNmQtZmQ4YWJiOWY3ZjA1YjJjNTg5ODUtM2NmNy00MTE4LWEwMDYtNGI0MGI3OTJlMTRi",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462117373604961.ODBjNTBlYTItZDI0NS00NDYwLTliNmQtZmQ4YWJiOWY3ZjA1YjJjNTg5ODUtM2NmNy00MTE4LWEwMDYtNGI0MGI3OTJlMTRi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYdr3EuQWyQt49wYcM26j0ZR0CBwlasZNlskGd97rPxRvz8cg_m06VfrJs9NGM5p5sDdqRxp5r9lfEEGs7NI72AQX9x7CpZJL-cihTz1m2ZVgZ2TGj44pFTq6x7ZknVM_Oy_GYDNX316UGZgR0KTCDYxwpmgYY4n0XPe6EHa1jWW6aJHGZOLuKW_PIjgjZtXRd2cwMjq50sVWn8Li7XjwndbsmQC5umdtT6E8us-t0ZJsOy3VyJL-XGcyzJ5VD4STPVO8lxt23U1vFhiVYIosol",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:15:40.542 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:15:40.543 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:15:40.554 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:40.557 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:15:50.965 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:15:51.228 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:51.230 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:15:51.231 -05:00 [DBG] No PKCE used.
2017-11-13 18:15:51.291 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:51.479 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:51.532 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:51.711 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:15:51.713 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:15:51.941 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:15:52.010 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:15:52.194 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:37:02.436 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:37:02.475 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:37:02.476 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:37:02.476 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:37:02.477 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:37:02.780 -05:00 [DBG] Starting token cleanup
2017-11-13 18:37:03.037 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:37:03.054 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:37:03.063 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:37:03.070 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:37:03.071 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:37:03.078 -05:00 [DBG] Start authorize request
2017-11-13 18:37:03.090 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:37:03.109 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:37:03.971 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:37:03.986 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:37:03.990 -05:00 [DBG] No PKCE used.
2017-11-13 18:37:04.084 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:37:04.424 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:37:04.479 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:37:04.631 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:37:04.640 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:37:04.705 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va4URtLldr4j8P6DfH96YcN1zEFKGRZyUq_wJNAhq172mATQbm_ZKBQjYvRY8nBWEPr1JYeMT0Hj22HZM38JqoRCzlJSib3EdVfKpKe7FnCTbXKLOYcx7pez4-92AcueiDcBSQkXsrqExhmg7XOBl3c0x_ztt10emhpQYLeaRxv1KpS94HG1MhqrR_hfxQJLacIHgrsy33XggNBPdB9ltyBHs452as7U18A_Gh6CrIX9JztENyDbPCUqMLj4ctIUj1M56SOdXaq_DnHF95tQTt2",
  "Nonce": "636462130228649176.Njc4ZTgzYWMtZGQyNS00NDVjLWFiZTEtYzQ3M2I2ZGM2YTY3MGYxMWJjNTUtOGFlMC00NjJhLTk3ZmUtZmY5ODNmMjcwNGU5",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462130228649176.Njc4ZTgzYWMtZGQyNS00NDVjLWFiZTEtYzQ3M2I2ZGM2YTY3MGYxMWJjNTUtOGFlMC00NjJhLTk3ZmUtZmY5ODNmMjcwNGU5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va4URtLldr4j8P6DfH96YcN1zEFKGRZyUq_wJNAhq172mATQbm_ZKBQjYvRY8nBWEPr1JYeMT0Hj22HZM38JqoRCzlJSib3EdVfKpKe7FnCTbXKLOYcx7pez4-92AcueiDcBSQkXsrqExhmg7XOBl3c0x_ztt10emhpQYLeaRxv1KpS94HG1MhqrR_hfxQJLacIHgrsy33XggNBPdB9ltyBHs452as7U18A_Gh6CrIX9JztENyDbPCUqMLj4ctIUj1M56SOdXaq_DnHF95tQTt2",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:37:04.844 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:37:04.845 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:37:04.877 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:37:04.882 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:37:16.741 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:37:17.138 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:37:17.140 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:37:17.141 -05:00 [DBG] No PKCE used.
2017-11-13 18:37:17.226 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:37:17.494 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:37:17.575 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:37:17.866 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:37:17.868 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:37:21.389 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:37:23.267 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:43:47.915 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:43:47.950 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:43:47.951 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:43:47.952 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:43:47.953 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:43:48.119 -05:00 [DBG] Starting token cleanup
2017-11-13 18:43:59.393 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:43:59.412 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:43:59.419 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:43:59.426 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:43:59.428 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:43:59.434 -05:00 [DBG] Start authorize request
2017-11-13 18:43:59.445 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:43:59.459 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:44:00.262 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:44:00.272 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:44:00.274 -05:00 [DBG] No PKCE used.
2017-11-13 18:44:00.382 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:44:00.724 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:44:00.777 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:44:00.955 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:44:00.965 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:44:01.039 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZj4Hiq1ZRwRcw6jCl2cS8dCihiOaU8LpCRow7DDnHChukdqbdYUFj5XBAcsWq1FrtjwPYBhDaEaPZLHGiUaXs6G9wo0rgra53TpHbFOAs59r0aHIuG-okQONxMD9EK-3BW5siY3yxo8sI4PYZkLfx2-O_R8D06q4ETS3nleE97iK4V7O9Bgvjg25kIzEMqOus3ez4hZlVAE3dMHSJ4oQ__36oM0_1EBK9mWOSd1Kh6CG9T3cbpUa6oVyrUn1D_DXUsPD1eWYx7_a1lLTXorA3E",
  "Nonce": "636462134392156241.N2I1NmI4MTctOTY2ZC00ODY4LWIzMDYtYzRjNmQxMzdmZmE3ZjgwZjc3YjQtN2NhNi00MmM5LWIyY2ItNGQzNmYwOWU3YmM1",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462134392156241.N2I1NmI4MTctOTY2ZC00ODY4LWIzMDYtYzRjNmQxMzdmZmE3ZjgwZjc3YjQtN2NhNi00MmM5LWIyY2ItNGQzNmYwOWU3YmM1",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZj4Hiq1ZRwRcw6jCl2cS8dCihiOaU8LpCRow7DDnHChukdqbdYUFj5XBAcsWq1FrtjwPYBhDaEaPZLHGiUaXs6G9wo0rgra53TpHbFOAs59r0aHIuG-okQONxMD9EK-3BW5siY3yxo8sI4PYZkLfx2-O_R8D06q4ETS3nleE97iK4V7O9Bgvjg25kIzEMqOus3ez4hZlVAE3dMHSJ4oQ__36oM0_1EBK9mWOSd1Kh6CG9T3cbpUa6oVyrUn1D_DXUsPD1eWYx7_a1lLTXorA3E",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:44:01.677 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:44:01.678 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:44:01.710 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:44:01.717 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:02.199 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 18:59:02.228 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 18:59:02.229 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 18:59:02.230 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 18:59:02.231 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 18:59:02.322 -05:00 [DBG] Starting token cleanup
2017-11-13 18:59:34.832 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:34.846 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:34.852 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 18:59:34.858 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 18:59:34.859 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 18:59:34.863 -05:00 [DBG] Start authorize request
2017-11-13 18:59:34.873 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 18:59:34.878 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:59:35.395 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:35.404 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:59:35.405 -05:00 [DBG] No PKCE used.
2017-11-13 18:59:35.453 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:35.667 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:35.682 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:35.755 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:35.765 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:59:35.850 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZuqKId2vURah7Suuy829koaNsOuUytH79yqzEYEdopSvDC7K3LjeljjJfdL9RlZrdxIQKGN94vuyLwsaso5sGCT4ATfXNR2h94mU5bqF1zZO4FPyLLSP9lbUWB38kLfXbCfU_N0k8XTS6O0uqshGAvxwEbtKd8k5V2o9bp8vdmpcZJiVq9jkiRdA7Ucxc6JYNtqNsaA0qMw8i_2Wk6gqyBGWvHLGdrsTHrJLgL4wPqA9Bko7msL-BI-kaNeXYxis5sKEzRibkwjBBClQ0pdrbp",
  "Nonce": "636462143745647380.OTA4MTkwMmUtZmFhNS00YmM3LTg5ZjEtZTA1MGUyZGRhMWE5NmYzNzI4MWEtMDBmZi00ZjAyLTllNzgtNzAwNTllZWUxZmY5",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462143745647380.OTA4MTkwMmUtZmFhNS00YmM3LTg5ZjEtZTA1MGUyZGRhMWE5NmYzNzI4MWEtMDBmZi00ZjAyLTllNzgtNzAwNTllZWUxZmY5",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZuqKId2vURah7Suuy829koaNsOuUytH79yqzEYEdopSvDC7K3LjeljjJfdL9RlZrdxIQKGN94vuyLwsaso5sGCT4ATfXNR2h94mU5bqF1zZO4FPyLLSP9lbUWB38kLfXbCfU_N0k8XTS6O0uqshGAvxwEbtKd8k5V2o9bp8vdmpcZJiVq9jkiRdA7Ucxc6JYNtqNsaA0qMw8i_2Wk6gqyBGWvHLGdrsTHrJLgL4wPqA9Bko7msL-BI-kaNeXYxis5sKEzRibkwjBBClQ0pdrbp",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 18:59:35.881 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:59:35.882 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 18:59:35.912 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:35.914 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:36.031 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:59:36.055 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.057 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:59:36.058 -05:00 [DBG] No PKCE used.
2017-11-13 18:59:36.065 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.130 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.137 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.194 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:36.196 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 18:59:36.200 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:59:36.213 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.215 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:59:36.233 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.233 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.235 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:59:36.237 -05:00 [DBG] No PKCE used.
2017-11-13 18:59:36.236 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:59:36.240 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:59:36.243 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.245 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.246 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:59:36.247 -05:00 [DBG] No PKCE used.
2017-11-13 18:59:36.250 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.322 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.327 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.331 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.331 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.414 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.414 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.416 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:59:36.415 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:59:36.440 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.441 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 18:59:36.440 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.442 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 18:59:36.448 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.455 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.456 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 18:59:36.457 -05:00 [DBG] No PKCE used.
2017-11-13 18:59:36.462 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.520 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.532 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.540 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.621 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 18:59:36.623 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 18:59:36.650 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 18:59:36.660 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 18:59:36.738 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.709 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:06.711 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:06.711 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:00:06.712 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:00:06.713 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:00:06.715 -05:00 [DBG] Start authorize request
2017-11-13 19:00:06.716 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:00:06.717 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:06.745 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:06.746 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:06.747 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:06.754 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.826 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.828 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.832 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.833 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:06.835 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYDccrhlt4FA5sZmUqGu0rdB_xLY4Is_53voifpQ41dxPg9gE9cXxUPNcmIBXJIedOEdOFYSLol6vSC3aH4YPDwjpYaHwuQDlQlSjlbfhX_H7ZTH3fcF2tnQ7-tuPWD9TiDo72aG68sFuf71gm_NyFCCkr6L-I3pqOLyXy7JnEa0HSko33m5Pqjvy1KfnUhE8IxpRAZg60pORBFzJ9WAaAROLbz8dwEf5a2OOuoXVqw92At_ijZUhrhNAjndqGvBhWiDO2e7CkSgIwQCVtQcJgW",
  "Nonce": "636462144066999853.ODU1Njk1MTQtYmNmMy00MjIzLTg5OGQtOGFkNTc4MWRlMDcwNzk5ZWRlMWItNWE0NS00N2E2LWFjOWUtZTZiMTcxMDg2MWMy",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462144066999853.ODU1Njk1MTQtYmNmMy00MjIzLTg5OGQtOGFkNTc4MWRlMDcwNzk5ZWRlMWItNWE0NS00N2E2LWFjOWUtZTZiMTcxMDg2MWMy",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYDccrhlt4FA5sZmUqGu0rdB_xLY4Is_53voifpQ41dxPg9gE9cXxUPNcmIBXJIedOEdOFYSLol6vSC3aH4YPDwjpYaHwuQDlQlSjlbfhX_H7ZTH3fcF2tnQ7-tuPWD9TiDo72aG68sFuf71gm_NyFCCkr6L-I3pqOLyXy7JnEa0HSko33m5Pqjvy1KfnUhE8IxpRAZg60pORBFzJ9WAaAROLbz8dwEf5a2OOuoXVqw92At_ijZUhrhNAjndqGvBhWiDO2e7CkSgIwQCVtQcJgW",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:00:06.851 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:00:06.852 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:00:06.860 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:06.861 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:06.862 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:06.867 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:06.868 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:06.869 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:06.872 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.877 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.879 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.882 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.883 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:06.888 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:06.889 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:00:06.890 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:06.895 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:06.896 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:06.897 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:06.899 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.903 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.906 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.910 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:06.912 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:06.916 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:06.922 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:06.983 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.053 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:28.055 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:28.056 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:00:28.057 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:00:28.058 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:00:28.060 -05:00 [DBG] Start authorize request
2017-11-13 19:00:28.061 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:00:28.062 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:28.097 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:28.099 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:28.100 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:28.111 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.206 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.217 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.282 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.283 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:28.284 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYT7W2Geffi3uU2TV2bJuSWOOvsxFQI5IA5z54aAi1gFS39pTLJo7hCn4pjJcmfWOkGyHH2XFdPjCnUsx45iJ3QviyDnE6oZSIZoLwBvQWEcCLptKJzWfFILMdvOAmy0ziMxx9BAAhy7AX_UyTXWjPrD2rlCj1R3Ch2Z411R7A8ruRNkxsGuEAUkqdvLmHF4wwwdeiWBDwb_uqV6B0PV4MfsBKxrhrseScqv0y1GV-YB1jUr19DRJ6ryDLZ3hMGJDnalaDt6as03ABQkWTE2xK2",
  "Nonce": "636462144280448385.YmQyYzljNDItYjU5OS00Zjg4LWFjM2QtMjliOGE3OWNlMzRiMjJmOTljMWItYjc4NC00NWZlLThmYmUtMGU5Y2Y2NWM5YTI1",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462144280448385.YmQyYzljNDItYjU5OS00Zjg4LWFjM2QtMjliOGE3OWNlMzRiMjJmOTljMWItYjc4NC00NWZlLThmYmUtMGU5Y2Y2NWM5YTI1",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYT7W2Geffi3uU2TV2bJuSWOOvsxFQI5IA5z54aAi1gFS39pTLJo7hCn4pjJcmfWOkGyHH2XFdPjCnUsx45iJ3QviyDnE6oZSIZoLwBvQWEcCLptKJzWfFILMdvOAmy0ziMxx9BAAhy7AX_UyTXWjPrD2rlCj1R3Ch2Z411R7A8ruRNkxsGuEAUkqdvLmHF4wwwdeiWBDwb_uqV6B0PV4MfsBKxrhrseScqv0y1GV-YB1jUr19DRJ6ryDLZ3hMGJDnalaDt6as03ABQkWTE2xK2",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:00:28.299 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:00:28.299 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:00:28.305 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:28.307 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:00:28.308 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:28.335 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:28.344 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:28.346 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:28.353 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.441 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.450 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.523 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.525 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:28.548 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:28.549 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:00:28.550 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:00:28.579 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:28.580 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:00:28.581 -05:00 [DBG] No PKCE used.
2017-11-13 19:00:28.588 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.657 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.664 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.745 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:00:28.747 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:00:28.772 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:00:28.782 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:00:28.863 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:17.793 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:02:17.794 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:02:17.795 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:02:17.797 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:02:17.798 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:02:17.800 -05:00 [DBG] Start authorize request
2017-11-13 19:02:17.800 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:02:17.801 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:02:17.831 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:02:17.833 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:02:17.835 -05:00 [DBG] No PKCE used.
2017-11-13 19:02:17.846 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:17.921 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:17.928 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:17.996 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:17.998 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:02:17.999 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYWkH7VazTt0sj6qPk4W_v2O3126mcpk1fmI7jU_5uWO0uAWs7mT56hicAd5HNTeCdl-KB12e4Q2t311hfWlDaK1cEAkNC50N_hif88eZXTp_gNDiRTtcQWJKO07EoOX2pP4WswF2yRW3Hp20qWJdXxAC87HiaDWTO_XJTzfiGAcqYyCm-6Jiu154gGQ4QiN_NkxMpnTaHCHJjLFjQbxSwqacpWGZLrNUOz29uoKgyn37MS0-UnDrofmr97yx5KeG4fXkpvsXD2GsmHpM-MQlxB",
  "Nonce": "636462145377840334.ZjUyYTE0YzctYzljOS00MWNkLWFjODAtOGVhOGVlNDcyMGJlYzZiYzVjMGYtYzc4Zi00MTgzLWE4MDMtNjZmMmMzNGQ3ZTM3",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462145377840334.ZjUyYTE0YzctYzljOS00MWNkLWFjODAtOGVhOGVlNDcyMGJlYzZiYzVjMGYtYzc4Zi00MTgzLWE4MDMtNjZmMmMzNGQ3ZTM3",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYWkH7VazTt0sj6qPk4W_v2O3126mcpk1fmI7jU_5uWO0uAWs7mT56hicAd5HNTeCdl-KB12e4Q2t311hfWlDaK1cEAkNC50N_hif88eZXTp_gNDiRTtcQWJKO07EoOX2pP4WswF2yRW3Hp20qWJdXxAC87HiaDWTO_XJTzfiGAcqYyCm-6Jiu154gGQ4QiN_NkxMpnTaHCHJjLFjQbxSwqacpWGZLrNUOz29uoKgyn37MS0-UnDrofmr97yx5KeG4fXkpvsXD2GsmHpM-MQlxB",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:02:18.012 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:02:18.013 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:02:18.019 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:02:18.020 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:02:18.021 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:02:18.044 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:02:18.045 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:02:18.046 -05:00 [DBG] No PKCE used.
2017-11-13 19:02:18.053 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:18.131 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:18.140 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:18.217 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:18.218 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:02:18.240 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:02:18.241 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:02:18.242 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:02:18.247 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:02:18.248 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:02:18.248 -05:00 [DBG] No PKCE used.
2017-11-13 19:02:18.253 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:18.321 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:18.328 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:18.407 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:02:18.408 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:02:18.436 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:02:18.443 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:02:18.510 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:08.514 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:08.516 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:08.546 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:08.567 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:08.569 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:08.569 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:08.575 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:08.638 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:08.641 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:08.645 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:08.646 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:08.677 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:08.679 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:08.680 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:04:08.681 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:04:08.683 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:04:08.689 -05:00 [DBG] Start authorize callback request
2017-11-13 19:04:08.715 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:08.716 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:08.743 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:08.744 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:08.745 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:08.752 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:08.826 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:08.831 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:08.881 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:08.883 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:08.884 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYWkH7VazTt0sj6qPk4W_v2O3126mcpk1fmI7jU_5uWO0uAWs7mT56hicAd5HNTeCdl-KB12e4Q2t311hfWlDaK1cEAkNC50N_hif88eZXTp_gNDiRTtcQWJKO07EoOX2pP4WswF2yRW3Hp20qWJdXxAC87HiaDWTO_XJTzfiGAcqYyCm-6Jiu154gGQ4QiN_NkxMpnTaHCHJjLFjQbxSwqacpWGZLrNUOz29uoKgyn37MS0-UnDrofmr97yx5KeG4fXkpvsXD2GsmHpM-MQlxB",
  "Nonce": "636462145377840334.ZjUyYTE0YzctYzljOS00MWNkLWFjODAtOGVhOGVlNDcyMGJlYzZiYzVjMGYtYzc4Zi00MTgzLWE4MDMtNjZmMmMzNGQ3ZTM3",
  "SessionId": "3c3345cb9e21a1e03a955d8248cc8a5a",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462145377840334.ZjUyYTE0YzctYzljOS00MWNkLWFjODAtOGVhOGVlNDcyMGJlYzZiYzVjMGYtYzc4Zi00MTgzLWE4MDMtNjZmMmMzNGQ3ZTM3",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYWkH7VazTt0sj6qPk4W_v2O3126mcpk1fmI7jU_5uWO0uAWs7mT56hicAd5HNTeCdl-KB12e4Q2t311hfWlDaK1cEAkNC50N_hif88eZXTp_gNDiRTtcQWJKO07EoOX2pP4WswF2yRW3Hp20qWJdXxAC87HiaDWTO_XJTzfiGAcqYyCm-6Jiu154gGQ4QiN_NkxMpnTaHCHJjLFjQbxSwqacpWGZLrNUOz29uoKgyn37MS0-UnDrofmr97yx5KeG4fXkpvsXD2GsmHpM-MQlxB",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:08.897 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:08.903 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:08.907 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:08.912 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:08.941 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-13 19:04:08.950 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 19:04:09.011 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:04:09.036 -05:00 [DBG] PGgRqe/8qoYsE7I4RpqZ/KlExhJAoDTM9GrtnwGCHOw= not found in database
2017-11-13 19:04:09.049 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:04:09.058 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:09.060 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:09.107 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYWkH7VazTt0sj6qPk4W_v2O3126mcpk1fmI7jU_5uWO0uAWs7mT56hicAd5HNTeCdl-KB12e4Q2t311hfWlDaK1cEAkNC50N_hif88eZXTp_gNDiRTtcQWJKO07EoOX2pP4WswF2yRW3Hp20qWJdXxAC87HiaDWTO_XJTzfiGAcqYyCm-6Jiu154gGQ4QiN_NkxMpnTaHCHJjLFjQbxSwqacpWGZLrNUOz29uoKgyn37MS0-UnDrofmr97yx5KeG4fXkpvsXD2GsmHpM-MQlxB",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 19:04:09.129 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:04:09.135 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:04:09.432 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:04:09.438 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:04:09.440 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:04:09.448 -05:00 [DBG] Start token request.
2017-11-13 19:04:09.454 -05:00 [DBG] Start client validation
2017-11-13 19:04:09.459 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:04:09.463 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:04:09.464 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:04:09.465 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:04:09.492 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:09.501 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:04:09.503 -05:00 [DBG] Client validation success
2017-11-13 19:04:09.509 -05:00 [DBG] Start token request validation
2017-11-13 19:04:09.522 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:04:09.540 -05:00 [DBG] PGgRqe/8qoYsE7I4RpqZ/KlExhJAoDTM9GrtnwGCHOw= found in database: true
2017-11-13 19:04:09.564 -05:00 [DBG] removing PGgRqe/8qoYsE7I4RpqZ/KlExhJAoDTM9GrtnwGCHOw= persisted grant from database
2017-11-13 19:04:09.573 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:04:09.581 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "2c327469d05060a58dcf055886af2c8cfafbfbeebe5a30375154b3a73295bbdc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "2c327469d05060a58dcf055886af2c8cfafbfbeebe5a30375154b3a73295bbdc",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:04:09.626 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:09.633 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:09.709 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:09.720 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:04:09.721 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:09.740 -05:00 [DBG] Creating refresh token
2017-11-13 19:04:09.741 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 19:04:09.755 -05:00 [DBG] n7ctHZ70bUsutyj1OBgv0hmvAv9vYGgIwvUsd0idpEI= not found in database
2017-11-13 19:04:09.778 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:09.784 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:09.851 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:09.852 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:09.853 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:09.860 -05:00 [DBG] Token request success.
2017-11-13 19:04:09.874 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:04:09.876 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:04:09.878 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:04:09.885 -05:00 [DBG] Start userinfo request
2017-11-13 19:04:09.889 -05:00 [DBG] Bearer token found in header
2017-11-13 19:04:09.941 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:09.979 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:09.983 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510617849,
    "exp": 1510621449,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510614939,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 19:04:09.996 -05:00 [DBG] Creating userinfo response
2017-11-13 19:04:10.001 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 19:04:10.011 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:10.014 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:04:10.022 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:04:10.023 -05:00 [DBG] End userinfo request
2017-11-13 19:04:17.904 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:17.905 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:17.907 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 19:04:17.909 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 19:04:17.910 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 19:04:17.915 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:17.922 -05:00 [DBG] Start end session request validation
2017-11-13 19:04:17.927 -05:00 [DBG] Start identity token validation
2017-11-13 19:04:17.949 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:17.951 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 19:04:17.954 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 19:04:17.961 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510617849,
    "exp": 1510618149,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462145377840334.ZjUyYTE0YzctYzljOS00MWNkLWFjODAtOGVhOGVlNDcyMGJlYzZiYzVjMGYtYzc4Zi00MTgzLWE4MDMtNjZmMmMzNGQ3ZTM3",
    "iat": 1510617849,
    "at_hash": "a4JInd6XzgOa1RvcSxgYSg",
    "sid": "3c3345cb9e21a1e03a955d8248cc8a5a",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510614939,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 19:04:17.971 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va8DwMmu7QGhlyZGV0oM_6W2BIHcQIuoxXwRcvu2UK2wZTfeYUANpSZwR6gVapS5V43vAoBDUJ8yCpDhdaoFFVzpeZHCEmcWpI2Vr4WF7cWscI0Lextgnm3ldeIuwlZAExHMGogslOGmQs1xW9A98Et",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTc4NDksImV4cCI6MTUxMDYxODE0OSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTQ1Mzc3ODQwMzM0LlpqVXlZVEUwWXpjdFl6bGpPUzAwTVdOa0xXRmpPREF0T0dWaE9HVmxORGN5TUdKbFl6WmlZelZqTUdZdFl6YzRaaTAwTVRnekxXRTRNRE10TmpabU1tTXpOR1EzWlRNMyIsImlhdCI6MTUxMDYxNzg0OSwiYXRfaGFzaCI6ImE0SkluZDZYemdPYTFSdmNTeGdZU2ciLCJzaWQiOiIzYzMzNDVjYjllMjFhMWUwM2E5NTVkODI0OGNjOGE1YSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxNDkzOSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.lHejcR1oq9eBQcG4uyILf70x4P7_JEw26zyFnxyMSEtvDg0-1xxfOMvRbyz8itGY8uWIMaLvu34dRyJRvevNy2qEe5ophdWH6iP_YY_pNKX28AGPSvLmexx16rDoMW5Guo6hUHJ1P04z6RAtQLaB3wcaZ6O-wxpwdTgFjb8vaIFu1W99dXgx3yFOYo0QEU7wM8FH7MwXnRKQT_VOzeec0fttbRjmdadhCJxA9YO_bVrRwiGcXga7WBzg3GBUYK5n2gRXJqa3aJI7c2tKe-Uc9A-IOaEzjh2m3PUxhqyjTjoHFmj2fNvAFmJ3yfZxs-AOcr9-tumG9Xkq_w0ZlZwr9Q",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va8DwMmu7QGhlyZGV0oM_6W2BIHcQIuoxXwRcvu2UK2wZTfeYUANpSZwR6gVapS5V43vAoBDUJ8yCpDhdaoFFVzpeZHCEmcWpI2Vr4WF7cWscI0Lextgnm3ldeIuwlZAExHMGogslOGmQs1xW9A98Et",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:17.980 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 19:04:17.996 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:17.997 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:18.029 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:04:18.031 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:04:18.032 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:04:18.034 -05:00 [INF] User logged out.
2017-11-13 19:04:18.436 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 19:04:18.440 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 19:04:18.443 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 19:04:18.448 -05:00 [DBG] Processing signout callback request
2017-11-13 19:04:18.481 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:18.482 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 19:04:18.482 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 19:04:18.483 -05:00 [INF] Successful signout callback.
2017-11-13 19:04:18.484 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 19:04:18.485 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 19:04:20.580 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:04:20.582 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:04:20.583 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:04:20.584 -05:00 [DBG] Start authorize request
2017-11-13 19:04:20.585 -05:00 [DBG] No user present in authorize request
2017-11-13 19:04:20.586 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:20.610 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:20.611 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:20.612 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:20.619 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:20.691 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:20.699 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:20.769 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:20.770 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:20.772 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
  "Nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:20.780 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:04:20.792 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:04:23.000 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:04:23.007 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:04:23.009 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:04:23.010 -05:00 [INF] User logged in.
2017-11-13 19:04:23.016 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:23.017 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:23.018 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:04:23.020 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:04:23.021 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:04:23.023 -05:00 [DBG] Start authorize callback request
2017-11-13 19:04:23.025 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:23.026 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:23.051 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:23.053 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:23.053 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:23.060 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.123 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.127 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.130 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.131 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:23.132 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
  "Nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
  "SessionId": "2442cf3c566191a9beebfdbb9d50d93d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:23.144 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:23.145 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:04:23.152 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:23.153 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:23.154 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:23.159 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:23.159 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:23.160 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:23.162 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.166 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.168 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.172 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.173 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:23.177 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:23.178 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:23.179 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:23.183 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:23.183 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:23.184 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:23.186 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.189 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.191 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.195 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:23.195 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:23.200 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:23.205 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:23.267 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:28.915 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:28.919 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:28.923 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:28.957 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:28.958 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:28.959 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:28.968 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:29.067 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:29.079 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:29.158 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:29.159 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:29.166 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:29.167 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:29.168 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:04:29.169 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:04:29.170 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:04:29.172 -05:00 [DBG] Start authorize callback request
2017-11-13 19:04:29.172 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:29.173 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:29.196 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:29.197 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:29.198 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:29.204 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:29.298 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:29.306 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:29.397 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:29.403 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:29.404 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
  "Nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
  "SessionId": "2442cf3c566191a9beebfdbb9d50d93d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:29.416 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:29.417 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:29.419 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:29.421 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:29.427 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 19:04:29.433 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:04:29.442 -05:00 [DBG] DQ8AxAB7C2sZLBjFAVA72W24BhVbgV+or/vrpxckrYQ= not found in database
2017-11-13 19:04:29.452 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:04:29.453 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:29.454 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:29.460 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKBrJRBVfiZC1kZqVrctCOm3qLPN8mv6_DWe1v2zu4xU-gwqHAL4lj8izU-C4K5RWx5n-md-C4M_NkOM6azLG43T28eNmpdPl0xmQbMMJ5_sEY3XRbme-xDLPSAp1wuEl_IDpYbA4DRRiMfJAC7Fbrfs_zRQtLRjMYd2FqKmN6Mw2QPZpCxgM3mTTfgeHtYNZcCXDqDwhMZJhvJkYEHd_crnxrV-VYyi58Bo44p4OeAXbuIJKp-5WWf6lNkLyYhxBRdF7XmN6QvS3C5UHuni_S",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 19:04:29.464 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:04:29.465 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:04:29.718 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:04:29.720 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:04:29.722 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:04:29.723 -05:00 [DBG] Start token request.
2017-11-13 19:04:29.724 -05:00 [DBG] Start client validation
2017-11-13 19:04:29.724 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:04:29.725 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:04:29.725 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:04:29.726 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:04:29.756 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:29.758 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:04:29.759 -05:00 [DBG] Client validation success
2017-11-13 19:04:29.760 -05:00 [DBG] Start token request validation
2017-11-13 19:04:29.761 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:04:29.765 -05:00 [DBG] DQ8AxAB7C2sZLBjFAVA72W24BhVbgV+or/vrpxckrYQ= found in database: true
2017-11-13 19:04:29.789 -05:00 [DBG] removing DQ8AxAB7C2sZLBjFAVA72W24BhVbgV+or/vrpxckrYQ= persisted grant from database
2017-11-13 19:04:29.797 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:04:29.798 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "7947fb2523fe4ff8b5d03e8b77c7a85ab4be4f67b6163f02ca1d3875e43a5d2b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "7947fb2523fe4ff8b5d03e8b77c7a85ab4be4f67b6163f02ca1d3875e43a5d2b",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:04:29.808 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:29.818 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:29.911 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:29.913 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:04:29.914 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:29.925 -05:00 [DBG] Creating refresh token
2017-11-13 19:04:29.926 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 19:04:29.940 -05:00 [DBG] wPCMJmUnCeu65d3WIKt19y2hLNnZCtzPsmyHTBZZw8M= not found in database
2017-11-13 19:04:29.976 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:29.983 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:30.051 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:30.053 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:30.054 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:30.058 -05:00 [DBG] Token request success.
2017-11-13 19:04:30.061 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:04:30.062 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:04:30.064 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:04:30.065 -05:00 [DBG] Start userinfo request
2017-11-13 19:04:30.065 -05:00 [DBG] Bearer token found in header
2017-11-13 19:04:30.092 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:30.099 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:30.101 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510617869,
    "exp": 1510621469,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510617863,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 19:04:30.109 -05:00 [DBG] Creating userinfo response
2017-11-13 19:04:30.110 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 19:04:30.117 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:30.119 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:04:30.124 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:04:30.126 -05:00 [DBG] End userinfo request
2017-11-13 19:04:37.259 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:37.261 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:37.262 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 19:04:37.263 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 19:04:37.264 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 19:04:37.265 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:37.266 -05:00 [DBG] Start end session request validation
2017-11-13 19:04:37.267 -05:00 [DBG] Start identity token validation
2017-11-13 19:04:37.295 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:37.296 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 19:04:37.300 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 19:04:37.306 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510617870,
    "exp": 1510618170,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462146605726955.YjM2ODg4ZWItOWQyMC00MjI3LTlmMDYtYzIyMTEwNDkzZTgzMjc3NGQzZjQtMzBjMi00ODM3LTgxMDktMzhjM2Q0MjZkNWVi",
    "iat": 1510617870,
    "at_hash": "QM3ACC8TigAtHjKjnSqJVA",
    "sid": "2442cf3c566191a9beebfdbb9d50d93d",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510617863,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 19:04:37.311 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaOZY6qekAfhzu-lv9IsSKVV7j963HNKRb4shOYUTl86iub7OGoHGT3yQfZSFNoT6zU2AFM27NECxVIXHZcNdxF-vZoo7XnK838f0PLTHlQHm27ggy7Rp-2QN2Zl9imISg0kOGh0FsKc3X5Hx1WXguS",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTc4NzAsImV4cCI6MTUxMDYxODE3MCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTQ2NjA1NzI2OTU1LllqTTJPRGc0WldJdE9XUXlNQzAwTWpJM0xUbG1NRFl0WXpJeU1URXdORGt6WlRnek1qYzNOR1F6WmpRdE16QmpNaTAwT0RNM0xUZ3hNRGt0TXpoak0yUTBNalprTldWaSIsImlhdCI6MTUxMDYxNzg3MCwiYXRfaGFzaCI6IlFNM0FDQzhUaWdBdEhqS2puU3FKVkEiLCJzaWQiOiIyNDQyY2YzYzU2NjE5MWE5YmVlYmZkYmI5ZDUwZDkzZCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxNzg2MywiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.mntY8QjoRqOo_bb97sVvKDj00iVJIKYCTLOPYCuKW9V894w3Squ1eunoTRreGLoexFLCW-JibIhvQ9GTuz5r-S0iBjjcSCK3GsLQDPmXeq2QWTpknAlqnciaqJDfcQ7dqQN_zJy04blXUyihcAAqxz0fBSXfONmfgpcoDNSBrAdOXSq7-3KeIWuddMOhHqKiGYRqM1OfGjKcTfrgpFPFooG2ZU7C7xykKGrhpfYJnksmlz7-_n_CJFv8oDUKGpl7xX_007hpw7wvqrsQh7wvka99MJPcvIhDVjIoMdCS0emBi5eZNEFwlAMcG3mwb0UK8Yjs5ynJ6OIh7lr7vcnuow",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaOZY6qekAfhzu-lv9IsSKVV7j963HNKRb4shOYUTl86iub7OGoHGT3yQfZSFNoT6zU2AFM27NECxVIXHZcNdxF-vZoo7XnK838f0PLTHlQHm27ggy7Rp-2QN2Zl9imISg0kOGh0FsKc3X5Hx1WXguS",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:37.319 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 19:04:37.325 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:37.326 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:37.329 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:04:37.330 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:04:37.330 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:04:37.331 -05:00 [INF] User logged out.
2017-11-13 19:04:37.506 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 19:04:37.508 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 19:04:37.509 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 19:04:37.511 -05:00 [DBG] Processing signout callback request
2017-11-13 19:04:37.516 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:37.517 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 19:04:37.518 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 19:04:37.520 -05:00 [INF] Successful signout callback.
2017-11-13 19:04:37.521 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 19:04:37.522 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 19:04:40.979 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:04:40.980 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:04:40.981 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:04:40.982 -05:00 [DBG] Start authorize request
2017-11-13 19:04:40.983 -05:00 [DBG] No user present in authorize request
2017-11-13 19:04:40.983 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:40.989 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:40.990 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:40.991 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:40.996 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:41.059 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:41.062 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:41.065 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:41.067 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:41.068 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
  "Nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:41.080 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:04:41.087 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:04:42.683 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:04:42.688 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:04:42.690 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:04:42.691 -05:00 [INF] User logged in.
2017-11-13 19:04:42.697 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:42.698 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:42.699 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:04:42.700 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:04:42.701 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:04:42.702 -05:00 [DBG] Start authorize callback request
2017-11-13 19:04:42.703 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:42.703 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:42.708 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:42.709 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:42.710 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:42.712 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.716 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.718 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.721 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.723 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:42.724 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
  "Nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
  "SessionId": "3c84d325e264420dde7ca9ce6d276141",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:42.735 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:42.736 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:04:42.742 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:42.743 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:42.744 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:42.750 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:42.751 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:42.752 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:42.754 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.758 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.760 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.764 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.765 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:42.770 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:42.771 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:42.772 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:42.776 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:42.777 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:42.777 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:42.779 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.783 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.786 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.789 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:42.790 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:42.794 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:42.799 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:42.864 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:47.772 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:47.773 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:47.775 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:47.780 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:47.781 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:47.782 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:47.784 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:47.789 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:47.792 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:47.796 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:47.797 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:47.803 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:47.805 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:04:47.806 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:04:47.807 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:04:47.809 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:04:47.810 -05:00 [DBG] Start authorize callback request
2017-11-13 19:04:47.811 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:47.812 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:04:47.817 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:47.818 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:04:47.819 -05:00 [DBG] No PKCE used.
2017-11-13 19:04:47.822 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:47.827 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:47.829 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:47.834 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:47.835 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:04:47.836 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
  "Nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
  "SessionId": "3c84d325e264420dde7ca9ce6d276141",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:04:47.847 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:04:47.848 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:47.850 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:04:47.853 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:47.860 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 19:04:47.865 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:04:47.875 -05:00 [DBG] fAE7xi9g0/5FcDLL5eLSn1JOkuYyL2yb5Dzg9Mu5slw= not found in database
2017-11-13 19:04:47.878 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:04:47.879 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:47.880 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:47.886 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbvOc_3fgRat_IUVlZ5fn_UzuwjQ1ca02ZuiERqqCMU9DxGmBeSiZqjGrvdW_yKwrmzC5Zmpn884etlC4hpMQyPeTxqCSR5eWEC4_JcTAxWf_4Pwuw-07zMtNGI6_1sv3Yker7rCvdlowwaGuXTt-hUcwzVrfcIwCOharznbjjuI9G_p8HdiDubQnay_craNATwN3LwTwFRceSZkHr7j8ZIeFfvLRxRF5ExxqVFeNCbVe4qH5VPIxixHTQfWO6utc6JCjSL2Wyeivhh5Pczo2lt",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 19:04:47.891 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:04:47.892 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:04:48.110 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:04:48.111 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:04:48.112 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:04:48.113 -05:00 [DBG] Start token request.
2017-11-13 19:04:48.114 -05:00 [DBG] Start client validation
2017-11-13 19:04:48.114 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:04:48.115 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:04:48.115 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:04:48.116 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:04:48.122 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:48.124 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:04:48.125 -05:00 [DBG] Client validation success
2017-11-13 19:04:48.126 -05:00 [DBG] Start token request validation
2017-11-13 19:04:48.126 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:04:48.129 -05:00 [DBG] fAE7xi9g0/5FcDLL5eLSn1JOkuYyL2yb5Dzg9Mu5slw= found in database: true
2017-11-13 19:04:48.140 -05:00 [DBG] removing fAE7xi9g0/5FcDLL5eLSn1JOkuYyL2yb5Dzg9Mu5slw= persisted grant from database
2017-11-13 19:04:48.145 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:04:48.146 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "a54157404dd46fc912b6701e3285af73f64fe55bd92c6b36109d82fddc6c0b06",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "a54157404dd46fc912b6701e3285af73f64fe55bd92c6b36109d82fddc6c0b06",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:04:48.154 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:48.157 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:48.161 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:48.162 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:04:48.163 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:04:48.172 -05:00 [DBG] Creating refresh token
2017-11-13 19:04:48.173 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 19:04:48.181 -05:00 [DBG] jP2zDq9JPURK4I0qUr2bZNVk4rtouoHUjk1TtgIHSBg= not found in database
2017-11-13 19:04:48.188 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:48.190 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:48.195 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:04:48.197 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:04:48.198 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:04:48.203 -05:00 [DBG] Token request success.
2017-11-13 19:04:48.207 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:04:48.209 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:04:48.210 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:04:48.211 -05:00 [DBG] Start userinfo request
2017-11-13 19:04:48.211 -05:00 [DBG] Bearer token found in header
2017-11-13 19:04:48.219 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:48.227 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:04:48.228 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510617888,
    "exp": 1510621488,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510617882,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 19:04:48.235 -05:00 [DBG] Creating userinfo response
2017-11-13 19:04:48.236 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 19:04:48.238 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:04:48.239 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:04:48.242 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:04:48.244 -05:00 [DBG] End userinfo request
2017-11-13 19:07:36.468 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:36.469 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:36.471 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 19:07:36.472 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 19:07:36.473 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 19:07:36.475 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:07:36.475 -05:00 [DBG] Start end session request validation
2017-11-13 19:07:36.476 -05:00 [DBG] Start identity token validation
2017-11-13 19:07:36.497 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:36.499 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 19:07:36.502 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 19:07:36.506 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510617888,
    "exp": 1510618188,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462146809734951.ODU1ZWY2NmYtMjkyMC00NWU2LWEwNjMtNTNhODg2NDMzNzhmOTg1MzYxMzUtZGJmOS00NTBkLWExMGEtM2UwYTZiODE3OWNi",
    "iat": 1510617888,
    "at_hash": "MTrMHGS9ieiij0a6dAhMHg",
    "sid": "3c84d325e264420dde7ca9ce6d276141",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510617882,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 19:07:36.513 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYLycbD_-QGZeC5UYPqrlke9gxAYIytmzBVZz5vKPtSTVYXD59htni06yf61axG0eFYBIS_Pqc-6_TMAVnQ6jx1t1XtfT9YwezEB1QJP0mJhV0aE9YzmntAvNS9qgIX-XKEvNGKXnbzhsCWWmqf40pB",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTc4ODgsImV4cCI6MTUxMDYxODE4OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTQ2ODA5NzM0OTUxLk9EVTFaV1kyTm1ZdE1qa3lNQzAwTldVMkxXRXdOak10TlROaE9EZzJORE16TnpobU9UZzFNell4TXpVdFpHSm1PUzAwTlRCa0xXRXhNR0V0TTJVd1lUWmlPREUzT1dOaSIsImlhdCI6MTUxMDYxNzg4OCwiYXRfaGFzaCI6Ik1Uck1IR1M5aWVpaWowYTZkQWhNSGciLCJzaWQiOiIzYzg0ZDMyNWUyNjQ0MjBkZGU3Y2E5Y2U2ZDI3NjE0MSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxNzg4MiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.de6XJ3mYyXy7pn4pHGjOZDqnKNBfhxVbyC4OwqfyFVJ25ku3jqRLO1mbTmTuNc3juVLZ4d8dAmNGkT0LoMUmgaN0BedPSvbDQhqDzCGvGsbJCmbmnqcyspjXbueNJQFYc1rnVmEjL8Ug58AiA2S9F37WY46u9govMPp9-7s-F4fNL5gC8S1kJX01ZrcU_ETFojasEnn5y6YEDXxE9ee9B3V5-d137ijvKn2nBTMqahIBC6lf5qCYr2LeYZb4fTwZJR3Mez1wX-E5a4TGOXgxJOMVHxf3al8HhCIApYntQeueUysa7YlVb-gpRqe08fro8rdTbsYbcCYcaqovMEkY_w",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYLycbD_-QGZeC5UYPqrlke9gxAYIytmzBVZz5vKPtSTVYXD59htni06yf61axG0eFYBIS_Pqc-6_TMAVnQ6jx1t1XtfT9YwezEB1QJP0mJhV0aE9YzmntAvNS9qgIX-XKEvNGKXnbzhsCWWmqf40pB",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:07:36.521 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 19:07:36.526 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:36.527 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:36.529 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:07:36.530 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:07:36.530 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:07:36.531 -05:00 [INF] User logged out.
2017-11-13 19:07:36.725 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 19:07:36.727 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 19:07:36.729 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 19:07:36.731 -05:00 [DBG] Processing signout callback request
2017-11-13 19:07:36.737 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:36.739 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 19:07:36.740 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 19:07:36.741 -05:00 [INF] Successful signout callback.
2017-11-13 19:07:36.742 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 19:07:36.743 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 19:07:38.657 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:07:38.659 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:07:38.660 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:07:38.661 -05:00 [DBG] Start authorize request
2017-11-13 19:07:38.662 -05:00 [DBG] No user present in authorize request
2017-11-13 19:07:38.663 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:38.670 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:38.671 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:38.672 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:38.678 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:38.742 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:38.745 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:38.748 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:38.750 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:38.751 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
  "Nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:07:38.761 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:07:38.767 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:07:40.140 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:07:40.146 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:07:40.147 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:07:40.148 -05:00 [INF] User logged in.
2017-11-13 19:07:40.154 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:40.155 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:40.156 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:07:40.158 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:07:40.159 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:07:40.160 -05:00 [DBG] Start authorize callback request
2017-11-13 19:07:40.161 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:07:40.162 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:40.167 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:40.168 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:40.169 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:40.171 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.175 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.177 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.181 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.182 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:40.183 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
  "Nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
  "SessionId": "7217ed1cf0afece37556104a0114d341",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:07:40.194 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:07:40.194 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:07:40.199 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:40.200 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:40.202 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:40.206 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:40.207 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:40.208 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:40.211 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.215 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.217 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.220 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.223 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:40.227 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:40.228 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:07:40.229 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:40.232 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:40.233 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:40.234 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:40.235 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.238 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.241 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.246 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:40.247 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:40.251 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:40.256 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:40.320 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.555 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:41.557 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:41.559 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:41.564 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.565 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:41.566 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:41.568 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.573 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.575 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.579 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.581 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:41.587 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:41.588 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:07:41.589 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:07:41.590 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:07:41.591 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:07:41.592 -05:00 [DBG] Start authorize callback request
2017-11-13 19:07:41.593 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:07:41.593 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:07:41.598 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.600 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:07:41.600 -05:00 [DBG] No PKCE used.
2017-11-13 19:07:41.603 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.606 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.609 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.612 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.613 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:07:41.614 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
  "Nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
  "SessionId": "7217ed1cf0afece37556104a0114d341",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:07:41.626 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:07:41.627 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:07:41.628 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1","offline_access"]
2017-11-13 19:07:41.631 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:07:41.637 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database
2017-11-13 19:07:41.641 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:07:41.651 -05:00 [DBG] YaaZnM7+wKraqW5sET0Hspjb+RCGJrqCRIGhsdyFMpA= not found in database
2017-11-13 19:07:41.654 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:07:41.655 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:07:41.656 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:07:41.663 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYEzjoY-yWx9PeAhUPIdEy3Y1xXva5qCWXUBolzBAEp0BD7-LZgA31Xq8LLpHy5Qy-ZELrHmMKIqC-h3fLILBkFuFz4GAjFpsXcHu3eg8UwVZvN30YIfy28fR6T90ck-4I4ZzBuoNWPRZlrwnqr7nI3vWCXJg18s6UxkWgWnzc0nX1sdyJaFVNcuS-CQLZB5mDRir93fPsg_D0zrDXxWoSr2pc24yVbL-5g9FzbbEsXPVrCRjUsgSWOCs4yumm-f3nejoLTftDvAWo3WkzamlWj",
  "Scope": "openid profile email api1 offline_access"
}
2017-11-13 19:07:41.667 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:07:41.668 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:07:41.882 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:07:41.883 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:07:41.884 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:07:41.885 -05:00 [DBG] Start token request.
2017-11-13 19:07:41.886 -05:00 [DBG] Start client validation
2017-11-13 19:07:41.886 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:07:41.887 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:07:41.888 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:07:41.888 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:07:41.894 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.895 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:07:41.896 -05:00 [DBG] Client validation success
2017-11-13 19:07:41.897 -05:00 [DBG] Start token request validation
2017-11-13 19:07:41.897 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:07:41.900 -05:00 [DBG] YaaZnM7+wKraqW5sET0Hspjb+RCGJrqCRIGhsdyFMpA= found in database: true
2017-11-13 19:07:41.910 -05:00 [DBG] removing YaaZnM7+wKraqW5sET0Hspjb+RCGJrqCRIGhsdyFMpA= persisted grant from database
2017-11-13 19:07:41.915 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:07:41.916 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "72ff4d597df1643c6ff4deaec253bdd4cd496e1942a0539eb1e87600a894cad2",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "72ff4d597df1643c6ff4deaec253bdd4cd496e1942a0539eb1e87600a894cad2",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:07:41.926 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.929 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.932 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.934 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:07:41.934 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:07:41.941 -05:00 [DBG] Creating refresh token
2017-11-13 19:07:41.942 -05:00 [DBG] Setting an absolute lifetime: 2592000
2017-11-13 19:07:41.951 -05:00 [DBG] rlF6csepaUUf2nGXl7CxehXjyNxcvZ1yAVzEjOvPyLo= not found in database
2017-11-13 19:07:41.957 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.960 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:41.963 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:07:41.964 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:07:41.966 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:07:41.970 -05:00 [DBG] Token request success.
2017-11-13 19:07:41.977 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:07:41.978 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:07:41.979 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:07:41.981 -05:00 [DBG] Start userinfo request
2017-11-13 19:07:41.982 -05:00 [DBG] Bearer token found in header
2017-11-13 19:07:41.989 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.995 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:07:41.997 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510618061,
    "exp": 1510621661,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510618060,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1",
      "offline_access"
    ],
    "amr": "external"
  }
}
2017-11-13 19:07:42.004 -05:00 [DBG] Creating userinfo response
2017-11-13 19:07:42.004 -05:00 [DBG] Scopes in access token: openid profile email api1 offline_access
2017-11-13 19:07:42.007 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:07:42.008 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:07:42.011 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:07:42.012 -05:00 [DBG] End userinfo request
2017-11-13 19:08:52.685 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:52.687 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:55.372 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:55.374 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:55.397 -05:00 [DBG] 7 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:08:55.449 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:08:55.457 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:08:55.526 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:08:57.077 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:57.080 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:57.095 -05:00 [DBG] removing 7 persisted grants from database for subject cf559f42-d46a-4dea-9390-b50e0f71a84e, clientId mvc.hybrid
2017-11-13 19:08:57.111 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:57.112 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:08:57.115 -05:00 [DBG] 0 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:09:29.636 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:29.638 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:29.648 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:09:29.650 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:09:29.651 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:09:29.652 -05:00 [INF] User logged out.
2017-11-13 19:09:29.843 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 19:09:29.844 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 19:09:29.846 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 19:09:29.848 -05:00 [DBG] Processing signout callback request
2017-11-13 19:09:29.875 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:29.876 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 19:09:29.878 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 19:09:29.879 -05:00 [INF] Successful signout callback.
2017-11-13 19:09:29.880 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 19:09:29.881 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 19:09:36.547 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 19:09:36.549 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 19:09:36.550 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 19:09:36.552 -05:00 [DBG] Processing signout request for anonymous
2017-11-13 19:09:36.553 -05:00 [DBG] Start end session request validation
2017-11-13 19:09:36.553 -05:00 [DBG] Start identity token validation
2017-11-13 19:09:36.558 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:36.559 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 19:09:36.562 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 19:09:36.567 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510618061,
    "exp": 1510618361,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462148586498535.MWFlZDdkNWUtZTdjMi00YTlhLTkyMGItZTdjN2ZlZDNjYTQwN2FlY2Y4MjQtOGVjNi00ZTJhLTgyNTYtN2RlMDIwMzExMjgz",
    "iat": 1510618061,
    "at_hash": "bIGbl5DmzDLqmnSz8MbJ0Q",
    "sid": "7217ed1cf0afece37556104a0114d341",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510618060,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 19:09:36.573 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZ4Tb1Lm93cAmQO9aJPhpFVZ5ipY1Om9PQBkGVfdKfpC1935u3s7spwiRtROatS_DZ0am6oTw9qHsC0_cWP7VGCWEBDtVL0YDe39gA4d3XBoBsCdk9LBO3MCyrBq5RieM46rxeFSxmVtDEmO6IVYXlM",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTgwNjEsImV4cCI6MTUxMDYxODM2MSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTQ4NTg2NDk4NTM1Lk1XRmxaRGRrTldVdFpUZGpNaTAwWVRsaExUa3lNR0l0WlRkak4yWmxaRE5qWVRRd04yRmxZMlk0TWpRdE9HVmpOaTAwWlRKaExUZ3lOVFl0TjJSbE1ESXdNekV4TWpneiIsImlhdCI6MTUxMDYxODA2MSwiYXRfaGFzaCI6ImJJR2JsNURtekRMcW1uU3o4TWJKMFEiLCJzaWQiOiI3MjE3ZWQxY2YwYWZlY2UzNzU1NjEwNGEwMTE0ZDM0MSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxODA2MCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.JKlO27NLPw2T2I4MOILy170wmyjZTxIPpEqEA8ZBUT8uOru7wvIGb2acEHzOCOkhu-1RsI4sL060xdy0KGBohBAGUn8i8HCtCLr_-FseQOZHpW7HMvS9jQKWEFeXtZgJa04SVi_IynE-1oE30pafgut1gOTLoYaphMM7nyCugQpD9zavCo0nA-9E7cKPMpM4W-UKRCpiYqxGSfjtEzLWxyzdS4r22WJbl_k9v4iR9DTx6P9w1jbFssSySF86q2rmPfBJc2mNSe5SsKp-fGLKxgrSdeNMTY8EqyqEN1eI5QE_KT0cHiLwR0wQ0u3wo9b2grFV7Ee7jdU5BtR5RHHp4w",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZ4Tb1Lm93cAmQO9aJPhpFVZ5ipY1Om9PQBkGVfdKfpC1935u3s7spwiRtROatS_DZ0am6oTw9qHsC0_cWP7VGCWEBDtVL0YDe39gA4d3XBoBsCdk9LBO3MCyrBq5RieM46rxeFSxmVtDEmO6IVYXlM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:09:36.581 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 19:09:36.586 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:09:36.587 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:09:36.588 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:09:36.589 -05:00 [INF] User logged out.
2017-11-13 19:09:39.545 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:09:39.547 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:09:39.548 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:09:39.549 -05:00 [DBG] Start authorize request
2017-11-13 19:09:39.550 -05:00 [DBG] No user present in authorize request
2017-11-13 19:09:39.551 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:09:39.556 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:39.557 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:09:39.558 -05:00 [DBG] No PKCE used.
2017-11-13 19:09:39.564 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:39.626 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:39.630 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:39.634 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:39.635 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:09:39.636 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZPzY-JNbVnthR1n0M2uO_Z6SX99DpG4ehTqov_iYE7f_ROxp2GbQiA_l_I0kz0Q8BAC3OovFGl4_gBFAcuVYAjLFRwImmW9g-3swWrmTX5nWxT19ixMJy_Utg0NHke5hEjFk7kbUb7-nZKpebzvJhC-KXC7FpJNuUYXEUQXkbxfPem51ff6zKk2sIgNhc7RalKuGSLL6gmRqeCc07udNCgA5wAore8tB8Ab1RadAdDiCE5LFRMvq-JEe1ddm66d89dRVmhL097Pbo06JXL28vD",
  "Nonce": "636462149795397993.NzExZTRiM2MtYmM3Ni00NDk3LWE3MGYtMDk1MTA5MzRkZjUwMjRjMzRkMjEtNDQyMy00ODliLThhOTMtY2M0MDRjYzdkNzFi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462149795397993.NzExZTRiM2MtYmM3Ni00NDk3LWE3MGYtMDk1MTA5MzRkZjUwMjRjMzRkMjEtNDQyMy00ODliLThhOTMtY2M0MDRjYzdkNzFi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZPzY-JNbVnthR1n0M2uO_Z6SX99DpG4ehTqov_iYE7f_ROxp2GbQiA_l_I0kz0Q8BAC3OovFGl4_gBFAcuVYAjLFRwImmW9g-3swWrmTX5nWxT19ixMJy_Utg0NHke5hEjFk7kbUb7-nZKpebzvJhC-KXC7FpJNuUYXEUQXkbxfPem51ff6zKk2sIgNhc7RalKuGSLL6gmRqeCc07udNCgA5wAore8tB8Ab1RadAdDiCE5LFRMvq-JEe1ddm66d89dRVmhL097Pbo06JXL28vD",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:09:39.645 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:09:39.652 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:09:43.337 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:09:43.344 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:09:43.345 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:09:43.346 -05:00 [INF] User logged in.
2017-11-13 19:09:43.351 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:43.352 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:43.353 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:09:43.355 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:09:43.356 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:09:43.358 -05:00 [DBG] Start authorize callback request
2017-11-13 19:09:43.360 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:09:43.361 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:09:43.387 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:43.388 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:09:43.390 -05:00 [DBG] No PKCE used.
2017-11-13 19:09:43.397 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.471 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.480 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.555 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.556 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:09:43.557 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZPzY-JNbVnthR1n0M2uO_Z6SX99DpG4ehTqov_iYE7f_ROxp2GbQiA_l_I0kz0Q8BAC3OovFGl4_gBFAcuVYAjLFRwImmW9g-3swWrmTX5nWxT19ixMJy_Utg0NHke5hEjFk7kbUb7-nZKpebzvJhC-KXC7FpJNuUYXEUQXkbxfPem51ff6zKk2sIgNhc7RalKuGSLL6gmRqeCc07udNCgA5wAore8tB8Ab1RadAdDiCE5LFRMvq-JEe1ddm66d89dRVmhL097Pbo06JXL28vD",
  "Nonce": "636462149795397993.NzExZTRiM2MtYmM3Ni00NDk3LWE3MGYtMDk1MTA5MzRkZjUwMjRjMzRkMjEtNDQyMy00ODliLThhOTMtY2M0MDRjYzdkNzFi",
  "SessionId": "7aadba440e4523ebc8c82a2c8f4afd56",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462149795397993.NzExZTRiM2MtYmM3Ni00NDk3LWE3MGYtMDk1MTA5MzRkZjUwMjRjMzRkMjEtNDQyMy00ODliLThhOTMtY2M0MDRjYzdkNzFi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZPzY-JNbVnthR1n0M2uO_Z6SX99DpG4ehTqov_iYE7f_ROxp2GbQiA_l_I0kz0Q8BAC3OovFGl4_gBFAcuVYAjLFRwImmW9g-3swWrmTX5nWxT19ixMJy_Utg0NHke5hEjFk7kbUb7-nZKpebzvJhC-KXC7FpJNuUYXEUQXkbxfPem51ff6zKk2sIgNhc7RalKuGSLL6gmRqeCc07udNCgA5wAore8tB8Ab1RadAdDiCE5LFRMvq-JEe1ddm66d89dRVmhL097Pbo06JXL28vD",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:09:43.570 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:09:43.572 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:09:43.577 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:43.578 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:09:43.579 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:09:43.603 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:43.604 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:09:43.605 -05:00 [DBG] No PKCE used.
2017-11-13 19:09:43.612 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.689 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.698 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.768 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.769 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:09:43.789 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:43.791 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:09:43.792 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:09:43.796 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:43.798 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:09:43.798 -05:00 [DBG] No PKCE used.
2017-11-13 19:09:43.804 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.882 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.889 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:43.974 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:09:43.976 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:09:44.003 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:09:44.010 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:09:44.077 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:04.852 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:04.853 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:04.856 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:10:04.857 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:10:04.858 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:10:04.858 -05:00 [INF] User logged out.
2017-11-13 19:10:18.512 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:10:18.514 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:10:18.515 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:10:18.516 -05:00 [DBG] Start authorize request
2017-11-13 19:10:18.517 -05:00 [DBG] No user present in authorize request
2017-11-13 19:10:18.517 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:10:18.541 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:18.542 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:10:18.543 -05:00 [DBG] No PKCE used.
2017-11-13 19:10:18.549 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:18.612 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:18.616 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:18.621 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:18.622 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:10:18.623 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZbkveeDaTTCgv27ZnnWqFK93AkfNYKupNMFSfcCMw3dl27NR5KiHep2wQmrN4TOGGdtdyY-RWEKu1MXBNWjZG_8SkGPBLtZQAcgtXnprWa95liTZkcqFGMIZ0abB5m9kTvGkQrzg6OMTSdlZPpOxmcJtteFOKfkyr1E6pAf4xl4y67bjIfTkee-rKQwU6YNNErlsqHbT4evDrLUFrl2oxiQz4_O8TDgW-bFp1YLncp_V3FHmdY4HriVRyGA9LmPfxwMU4iuzwa6Y18k7lewwaj",
  "Nonce": "636462150185064935.YjdhNjgwNWItZDIyMC00MTgxLWJhYjEtMGFjMjgwZTQ4MDhjNDRmMDhkOTktODRhYS00N2QzLTkyOGMtYWFhZjE4Y2QxZjlj",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462150185064935.YjdhNjgwNWItZDIyMC00MTgxLWJhYjEtMGFjMjgwZTQ4MDhjNDRmMDhkOTktODRhYS00N2QzLTkyOGMtYWFhZjE4Y2QxZjlj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZbkveeDaTTCgv27ZnnWqFK93AkfNYKupNMFSfcCMw3dl27NR5KiHep2wQmrN4TOGGdtdyY-RWEKu1MXBNWjZG_8SkGPBLtZQAcgtXnprWa95liTZkcqFGMIZ0abB5m9kTvGkQrzg6OMTSdlZPpOxmcJtteFOKfkyr1E6pAf4xl4y67bjIfTkee-rKQwU6YNNErlsqHbT4evDrLUFrl2oxiQz4_O8TDgW-bFp1YLncp_V3FHmdY4HriVRyGA9LmPfxwMU4iuzwa6Y18k7lewwaj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:10:18.633 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:10:18.640 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:10:49.097 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:10:49.103 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:10:49.104 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:10:49.105 -05:00 [INF] User logged in.
2017-11-13 19:10:49.112 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:49.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:49.114 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:10:49.115 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:10:49.116 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:10:49.118 -05:00 [DBG] Start authorize callback request
2017-11-13 19:10:49.118 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:10:49.119 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:10:49.140 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:49.141 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:10:49.142 -05:00 [DBG] No PKCE used.
2017-11-13 19:10:49.147 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.216 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.226 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.321 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.322 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:10:49.323 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1 offline_access",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZbkveeDaTTCgv27ZnnWqFK93AkfNYKupNMFSfcCMw3dl27NR5KiHep2wQmrN4TOGGdtdyY-RWEKu1MXBNWjZG_8SkGPBLtZQAcgtXnprWa95liTZkcqFGMIZ0abB5m9kTvGkQrzg6OMTSdlZPpOxmcJtteFOKfkyr1E6pAf4xl4y67bjIfTkee-rKQwU6YNNErlsqHbT4evDrLUFrl2oxiQz4_O8TDgW-bFp1YLncp_V3FHmdY4HriVRyGA9LmPfxwMU4iuzwa6Y18k7lewwaj",
  "Nonce": "636462150185064935.YjdhNjgwNWItZDIyMC00MTgxLWJhYjEtMGFjMjgwZTQ4MDhjNDRmMDhkOTktODRhYS00N2QzLTkyOGMtYWFhZjE4Y2QxZjlj",
  "SessionId": "6f5ac7dff7ecb72c2d5a874ab4714944",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1 offline_access",
    "response_mode": "form_post",
    "nonce": "636462150185064935.YjdhNjgwNWItZDIyMC00MTgxLWJhYjEtMGFjMjgwZTQ4MDhjNDRmMDhkOTktODRhYS00N2QzLTkyOGMtYWFhZjE4Y2QxZjlj",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZbkveeDaTTCgv27ZnnWqFK93AkfNYKupNMFSfcCMw3dl27NR5KiHep2wQmrN4TOGGdtdyY-RWEKu1MXBNWjZG_8SkGPBLtZQAcgtXnprWa95liTZkcqFGMIZ0abB5m9kTvGkQrzg6OMTSdlZPpOxmcJtteFOKfkyr1E6pAf4xl4y67bjIfTkee-rKQwU6YNNErlsqHbT4evDrLUFrl2oxiQz4_O8TDgW-bFp1YLncp_V3FHmdY4HriVRyGA9LmPfxwMU4iuzwa6Y18k7lewwaj",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:10:49.338 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:10:49.339 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:10:49.345 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:49.347 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:10:49.349 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:10:49.377 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:49.378 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:10:49.378 -05:00 [DBG] No PKCE used.
2017-11-13 19:10:49.384 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.443 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.446 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.449 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.450 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:10:49.473 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:49.474 -05:00 [DBG] Scopes contains offline_access, consent is required
2017-11-13 19:10:49.475 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:10:49.497 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:49.499 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:10:49.500 -05:00 [DBG] No PKCE used.
2017-11-13 19:10:49.507 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.576 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.583 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.652 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:10:49.653 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:10:49.674 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:10:49.679 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:10:49.749 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:14:12.031 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 19:14:12.057 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 19:14:12.058 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 19:14:12.059 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 19:14:12.059 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 19:14:12.143 -05:00 [DBG] Starting token cleanup
2017-11-13 19:14:40.112 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-13 19:14:40.140 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-13 19:14:40.141 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-13 19:14:40.141 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-13 19:14:40.142 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-13 19:14:40.234 -05:00 [DBG] Starting token cleanup
2017-11-13 19:14:59.350 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-13 19:14:59.362 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-13 19:14:59.364 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-13 19:14:59.368 -05:00 [DBG] Start discovery request
2017-11-13 19:14:59.599 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-13 19:14:59.831 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-13 19:14:59.834 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-13 19:14:59.835 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-13 19:14:59.839 -05:00 [DBG] Start key discovery request
2017-11-13 19:14:59.902 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:14:59.904 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:14:59.906 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:14:59.910 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:14:59.911 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:14:59.916 -05:00 [DBG] Start authorize request
2017-11-13 19:14:59.928 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:14:59.934 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:00.105 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:00.112 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:00.114 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:00.151 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:00.257 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:00.276 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:00.341 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:00.350 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:00.365 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYDTKzCj3Ff2OtUOfOKRf4cU8R9LTvBGsxu-5F6tox0lh8gkGYQ1JHt1MZ5oYQTE3d-dQKEE1t53WYnKIaLSmaMoSbjXvKDQNwmfVduz8J463OyE25QDX6Wjp6uZnp2JqDmcjbaZ9h_1RkAeSMT2m0sho-ULNZUGSQOqMjNsN9K7Q3xlx-foGuaDcEOKuHE3xV4EgbFuWyHPqbMIlC4nJUtkG5sHNrN7jFtfwVHPpHItFveNrGqLR1nwIHcNmhnqf3Njmtym4c2pJ5BjimVvdKQ",
  "Nonce": "636462152998879702.NDcyMGZjNDEtNGIxMC00MmU1LThkYjUtN2Y0NmEwYzNkY2JjMDQ5ZTdkM2EtNmE3Zi00MjRiLWE0M2ItMzFiNTUzMzk1NWM4",
  "SessionId": "6f5ac7dff7ecb72c2d5a874ab4714944",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462152998879702.NDcyMGZjNDEtNGIxMC00MmU1LThkYjUtN2Y0NmEwYzNkY2JjMDQ5ZTdkM2EtNmE3Zi00MjRiLWE0M2ItMzFiNTUzMzk1NWM4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYDTKzCj3Ff2OtUOfOKRf4cU8R9LTvBGsxu-5F6tox0lh8gkGYQ1JHt1MZ5oYQTE3d-dQKEE1t53WYnKIaLSmaMoSbjXvKDQNwmfVduz8J463OyE25QDX6Wjp6uZnp2JqDmcjbaZ9h_1RkAeSMT2m0sho-ULNZUGSQOqMjNsN9K7Q3xlx-foGuaDcEOKuHE3xV4EgbFuWyHPqbMIlC4nJUtkG5sHNrN7jFtfwVHPpHItFveNrGqLR1nwIHcNmhnqf3Njmtym4c2pJ5BjimVvdKQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:15:00.450 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-13 19:15:00.455 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-13 19:15:00.457 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-13 19:15:00.459 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-13 19:15:00.460 -05:00 [INF] Showing consent: User has not yet consented
2017-11-13 19:15:00.470 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:00.472 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:00.611 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:00.631 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:00.633 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:00.635 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:00.644 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:00.725 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:00.737 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:00.836 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:00.837 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:00.858 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:00.863 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:00.928 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:07.748 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:07.750 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:07.780 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:07.803 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:07.804 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:07.805 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:07.813 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:07.883 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:07.886 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:07.891 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:07.892 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:07.914 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:07.916 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:07.917 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:15:07.919 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:15:07.920 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:15:07.927 -05:00 [DBG] Start authorize callback request
2017-11-13 19:15:07.962 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:07.963 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:07.991 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:07.992 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:07.993 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:08.000 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:08.066 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:08.073 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:08.138 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:08.140 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:08.141 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYDTKzCj3Ff2OtUOfOKRf4cU8R9LTvBGsxu-5F6tox0lh8gkGYQ1JHt1MZ5oYQTE3d-dQKEE1t53WYnKIaLSmaMoSbjXvKDQNwmfVduz8J463OyE25QDX6Wjp6uZnp2JqDmcjbaZ9h_1RkAeSMT2m0sho-ULNZUGSQOqMjNsN9K7Q3xlx-foGuaDcEOKuHE3xV4EgbFuWyHPqbMIlC4nJUtkG5sHNrN7jFtfwVHPpHItFveNrGqLR1nwIHcNmhnqf3Njmtym4c2pJ5BjimVvdKQ",
  "Nonce": "636462152998879702.NDcyMGZjNDEtNGIxMC00MmU1LThkYjUtN2Y0NmEwYzNkY2JjMDQ5ZTdkM2EtNmE3Zi00MjRiLWE0M2ItMzFiNTUzMzk1NWM4",
  "SessionId": "6f5ac7dff7ecb72c2d5a874ab4714944",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462152998879702.NDcyMGZjNDEtNGIxMC00MmU1LThkYjUtN2Y0NmEwYzNkY2JjMDQ5ZTdkM2EtNmE3Zi00MjRiLWE0M2ItMzFiNTUzMzk1NWM4",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYDTKzCj3Ff2OtUOfOKRf4cU8R9LTvBGsxu-5F6tox0lh8gkGYQ1JHt1MZ5oYQTE3d-dQKEE1t53WYnKIaLSmaMoSbjXvKDQNwmfVduz8J463OyE25QDX6Wjp6uZnp2JqDmcjbaZ9h_1RkAeSMT2m0sho-ULNZUGSQOqMjNsN9K7Q3xlx-foGuaDcEOKuHE3xV4EgbFuWyHPqbMIlC4nJUtkG5sHNrN7jFtfwVHPpHItFveNrGqLR1nwIHcNmhnqf3Njmtym4c2pJ5BjimVvdKQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:15:08.159 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-13 19:15:08.174 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-13 19:15:08.176 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-13 19:15:08.181 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1"]
2017-11-13 19:15:08.185 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2017-11-13 19:15:08.189 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:08.209 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-13 19:15:08.242 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:15:08.268 -05:00 [DBG] J/6S8IVFQuLFhcfT9Mo/iQJN/7BvCSdiZjOXbZDwT9A= not found in database
2017-11-13 19:15:08.276 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:15:08.285 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:15:08.288 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:15:08.330 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYDTKzCj3Ff2OtUOfOKRf4cU8R9LTvBGsxu-5F6tox0lh8gkGYQ1JHt1MZ5oYQTE3d-dQKEE1t53WYnKIaLSmaMoSbjXvKDQNwmfVduz8J463OyE25QDX6Wjp6uZnp2JqDmcjbaZ9h_1RkAeSMT2m0sho-ULNZUGSQOqMjNsN9K7Q3xlx-foGuaDcEOKuHE3xV4EgbFuWyHPqbMIlC4nJUtkG5sHNrN7jFtfwVHPpHItFveNrGqLR1nwIHcNmhnqf3Njmtym4c2pJ5BjimVvdKQ",
  "Scope": "openid profile email api1"
}
2017-11-13 19:15:08.364 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:15:08.372 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:15:08.688 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:15:08.693 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:15:08.695 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:15:08.706 -05:00 [DBG] Start token request.
2017-11-13 19:15:08.714 -05:00 [DBG] Start client validation
2017-11-13 19:15:08.721 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:15:08.726 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:15:08.729 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:15:08.731 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:15:08.767 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:08.778 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:15:08.779 -05:00 [DBG] Client validation success
2017-11-13 19:15:08.785 -05:00 [DBG] Start token request validation
2017-11-13 19:15:08.795 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:15:08.808 -05:00 [DBG] J/6S8IVFQuLFhcfT9Mo/iQJN/7BvCSdiZjOXbZDwT9A= found in database: true
2017-11-13 19:15:08.830 -05:00 [DBG] removing J/6S8IVFQuLFhcfT9Mo/iQJN/7BvCSdiZjOXbZDwT9A= persisted grant from database
2017-11-13 19:15:08.837 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:15:08.843 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "6669cc1bec1421a004c0e0f200f1c8553fb6ab8698cfec74355cba4fe71c3a7d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "6669cc1bec1421a004c0e0f200f1c8553fb6ab8698cfec74355cba4fe71c3a7d",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:15:08.903 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:08.917 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:09.023 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:09.037 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:15:09.040 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:09.153 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:09.162 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:09.249 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:09.251 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:15:09.253 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:15:09.262 -05:00 [DBG] Token request success.
2017-11-13 19:15:09.284 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:15:09.287 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:15:09.296 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:15:09.308 -05:00 [DBG] Start userinfo request
2017-11-13 19:15:09.313 -05:00 [DBG] Bearer token found in header
2017-11-13 19:15:09.366 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:09.402 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:09.406 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510618509,
    "exp": 1510622109,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510618249,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-13 19:15:09.424 -05:00 [DBG] Creating userinfo response
2017-11-13 19:15:09.428 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-13 19:15:09.439 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:09.442 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:15:09.452 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:15:09.454 -05:00 [DBG] End userinfo request
2017-11-13 19:15:11.309 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:11.311 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:11.312 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-13 19:15:11.314 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-13 19:15:11.316 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-13 19:15:11.322 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:11.328 -05:00 [DBG] Start end session request validation
2017-11-13 19:15:11.333 -05:00 [DBG] Start identity token validation
2017-11-13 19:15:11.355 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:11.357 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-13 19:15:11.360 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-13 19:15:11.366 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510618509,
    "exp": 1510618809,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462152998879702.NDcyMGZjNDEtNGIxMC00MmU1LThkYjUtN2Y0NmEwYzNkY2JjMDQ5ZTdkM2EtNmE3Zi00MjRiLWE0M2ItMzFiNTUzMzk1NWM4",
    "iat": 1510618509,
    "at_hash": "L60jPMKc0Ww5HW_L00JVvw",
    "sid": "6f5ac7dff7ecb72c2d5a874ab4714944",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510618249,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-13 19:15:11.376 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vabh-roNoP-pkaXmL34GM-ApP1HyfLNkQnp5WfUqnDN_DRNg4l37yBtxa_iikvqqiteVR5eb0RpHMJNXBqTXBShwasHjnFEAV6FW42L23SysGy3u-ybEAnuAjfpWNqQohfi2noyY4RNLK5bvGI52p0J",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2MTg1MDksImV4cCI6MTUxMDYxODgwOSwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyMTUyOTk4ODc5NzAyLk5EY3lNR1pqTkRFdE5HSXhNQzAwTW1VMUxUaGtZalV0TjJZME5tRXdZek5rWTJKak1EUTVaVGRrTTJFdE5tRTNaaTAwTWpSaUxXRTBNMkl0TXpGaU5UVXpNemsxTldNNCIsImlhdCI6MTUxMDYxODUwOSwiYXRfaGFzaCI6Ikw2MGpQTUtjMFd3NUhXX0wwMEpWdnciLCJzaWQiOiI2ZjVhYzdkZmY3ZWNiNzJjMmQ1YTg3NGFiNDcxNDk0NCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDYxODI0OSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.lwJ80kOUr2xTGK2ZJrcoFcMUvksinmUimMgvbIaP8YLDfb6wVrGEDzpx2B4Ciljje7qxBs7Q0EipsVhr7RHsuVro5s_OSYTk24Amo6vV9dvZGGoZ_wES7HVKXYkqGZaOJ09perAgMVaFPWQJHGT4cdBIBWa_N3ZY-f-AVJAAMx8SVav0yv19-cKpeQjPlVSx7Kc_QFU9UnAdv_IPphBqSIh1IMmiOa1eBLWMMJiAz1BgaQUAYm-1tfTqiZO0aeyG2pFBUw1z9G5HgnGTWnXzdG_bT8TdUz-1YoUMD4uVLZtZ1sdv3eoHf1Kv6xEKoWOmG6Tw2fMaVPBLy1q37jVq8g",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vabh-roNoP-pkaXmL34GM-ApP1HyfLNkQnp5WfUqnDN_DRNg4l37yBtxa_iikvqqiteVR5eb0RpHMJNXBqTXBShwasHjnFEAV6FW42L23SysGy3u-ybEAnuAjfpWNqQohfi2noyY4RNLK5bvGI52p0J",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:15:11.384 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-13 19:15:11.399 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:11.401 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:11.436 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-13 19:15:11.438 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:15:11.439 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-13 19:15:11.440 -05:00 [INF] User logged out.
2017-11-13 19:15:11.752 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-13 19:15:11.755 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-13 19:15:11.757 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-13 19:15:11.763 -05:00 [DBG] Processing signout callback request
2017-11-13 19:15:11.804 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:11.805 -05:00 [DBG] No client front-channel logout URLs
2017-11-13 19:15:11.807 -05:00 [DBG] No client back-channel logout URLs
2017-11-13 19:15:11.808 -05:00 [INF] Successful signout callback.
2017-11-13 19:15:11.809 -05:00 [DBG] No client front-channel iframe urls
2017-11-13 19:15:11.809 -05:00 [DBG] No client back-channel iframe urls
2017-11-13 19:15:13.563 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-13 19:15:13.564 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-13 19:15:13.565 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-13 19:15:13.566 -05:00 [DBG] Start authorize request
2017-11-13 19:15:13.567 -05:00 [DBG] No user present in authorize request
2017-11-13 19:15:13.568 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:13.595 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:13.597 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:13.597 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:13.604 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:13.678 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:13.688 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:13.777 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:13.778 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:13.780 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbCKOOXo8kl5ioO3zHGYKlQiBZq3FO35FmD9RCzds4jbbbvS2byeKGvnvQSdagHL4Crz_gEaqg1M0RdBun3xViqBhaQWZK_NKZN_1wRKFoVx8t52zYfZyLsyV0sGdxNwSrgbSikDwq8Rz6wLvWdivYh9i7u3qFZ86i1PuDTyePK7D3QgazXE5OMmepmdj2EA-qFKw-zAiysPNBr-upnvXNWKCoHUqyThxAyrdxHEAyA3k0d1mpDo4Fedg0sKv4kb2wLElDyF6hRz133AtMM9FKS",
  "Nonce": "636462153135561236.NTE5MTU5MjEtNDBmYi00MDQ2LTk5ZWEtZmUzMTNlMGEwNWE2Y2M3ODE3ZDQtNGYzNC00Y2I0LWJkNDAtNGY5ZjU1YmMzM2E2",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462153135561236.NTE5MTU5MjEtNDBmYi00MDQ2LTk5ZWEtZmUzMTNlMGEwNWE2Y2M3ODE3ZDQtNGYzNC00Y2I0LWJkNDAtNGY5ZjU1YmMzM2E2",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbCKOOXo8kl5ioO3zHGYKlQiBZq3FO35FmD9RCzds4jbbbvS2byeKGvnvQSdagHL4Crz_gEaqg1M0RdBun3xViqBhaQWZK_NKZN_1wRKFoVx8t52zYfZyLsyV0sGdxNwSrgbSikDwq8Rz6wLvWdivYh9i7u3qFZ86i1PuDTyePK7D3QgazXE5OMmepmdj2EA-qFKw-zAiysPNBr-upnvXNWKCoHUqyThxAyrdxHEAyA3k0d1mpDo4Fedg0sKv4kb2wLElDyF6hRz133AtMM9FKS",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:15:13.789 -05:00 [INF] Showing login: User is not authenticated
2017-11-13 19:15:13.803 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-13 19:15:15.711 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-13 19:15:15.720 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:15:15.722 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:15:15.723 -05:00 [INF] User logged in.
2017-11-13 19:15:15.731 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:15.732 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-13 19:15:15.734 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-13 19:15:15.735 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-13 19:15:15.736 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-13 19:15:15.737 -05:00 [DBG] Start authorize callback request
2017-11-13 19:15:15.738 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:15.739 -05:00 [DBG] Start authorize request protocol validation
2017-11-13 19:15:15.766 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:15.767 -05:00 [DBG] Checking for PKCE parameters
2017-11-13 19:15:15.768 -05:00 [DBG] No PKCE used.
2017-11-13 19:15:15.776 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:15.840 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:15.843 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:15.846 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:15.847 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-13 19:15:15.848 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbCKOOXo8kl5ioO3zHGYKlQiBZq3FO35FmD9RCzds4jbbbvS2byeKGvnvQSdagHL4Crz_gEaqg1M0RdBun3xViqBhaQWZK_NKZN_1wRKFoVx8t52zYfZyLsyV0sGdxNwSrgbSikDwq8Rz6wLvWdivYh9i7u3qFZ86i1PuDTyePK7D3QgazXE5OMmepmdj2EA-qFKw-zAiysPNBr-upnvXNWKCoHUqyThxAyrdxHEAyA3k0d1mpDo4Fedg0sKv4kb2wLElDyF6hRz133AtMM9FKS",
  "Nonce": "636462153135561236.NTE5MTU5MjEtNDBmYi00MDQ2LTk5ZWEtZmUzMTNlMGEwNWE2Y2M3ODE3ZDQtNGYzNC00Y2I0LWJkNDAtNGY5ZjU1YmMzM2E2",
  "SessionId": "77fbc891abd4ae8f57549ac3b50200bb",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462153135561236.NTE5MTU5MjEtNDBmYi00MDQ2LTk5ZWEtZmUzMTNlMGEwNWE2Y2M3ODE3ZDQtNGYzNC00Y2I0LWJkNDAtNGY5ZjU1YmMzM2E2",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbCKOOXo8kl5ioO3zHGYKlQiBZq3FO35FmD9RCzds4jbbbvS2byeKGvnvQSdagHL4Crz_gEaqg1M0RdBun3xViqBhaQWZK_NKZN_1wRKFoVx8t52zYfZyLsyV0sGdxNwSrgbSikDwq8Rz6wLvWdivYh9i7u3qFZ86i1PuDTyePK7D3QgazXE5OMmepmdj2EA-qFKw-zAiysPNBr-upnvXNWKCoHUqyThxAyrdxHEAyA3k0d1mpDo4Fedg0sKv4kb2wLElDyF6hRz133AtMM9FKS",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-13 19:15:15.863 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: true
2017-11-13 19:15:15.868 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2017-11-13 19:15:15.869 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-13 19:15:15.878 -05:00 [DBG] em7SmlL8xB60XEv1+/JI6yqcbWeqNomSL1MONw4lC5I= not found in database
2017-11-13 19:15:15.881 -05:00 [DBG] Creating Implicit Flow response.
2017-11-13 19:15:15.881 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:15:15.883 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:15:15.890 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbCKOOXo8kl5ioO3zHGYKlQiBZq3FO35FmD9RCzds4jbbbvS2byeKGvnvQSdagHL4Crz_gEaqg1M0RdBun3xViqBhaQWZK_NKZN_1wRKFoVx8t52zYfZyLsyV0sGdxNwSrgbSikDwq8Rz6wLvWdivYh9i7u3qFZ86i1PuDTyePK7D3QgazXE5OMmepmdj2EA-qFKw-zAiysPNBr-upnvXNWKCoHUqyThxAyrdxHEAyA3k0d1mpDo4Fedg0sKv4kb2wLElDyF6hRz133AtMM9FKS",
  "Scope": "openid profile email api1"
}
2017-11-13 19:15:15.894 -05:00 [DBG] Augmenting SignInContext
2017-11-13 19:15:15.895 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-13 19:15:16.148 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-13 19:15:16.150 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-13 19:15:16.151 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-13 19:15:16.152 -05:00 [DBG] Start token request.
2017-11-13 19:15:16.153 -05:00 [DBG] Start client validation
2017-11-13 19:15:16.154 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-13 19:15:16.155 -05:00 [DBG] Start parsing for secret in post body
2017-11-13 19:15:16.155 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-13 19:15:16.156 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-13 19:15:16.180 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:16.181 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-13 19:15:16.183 -05:00 [DBG] Client validation success
2017-11-13 19:15:16.183 -05:00 [DBG] Start token request validation
2017-11-13 19:15:16.185 -05:00 [DBG] Start validation of authorization code token request
2017-11-13 19:15:16.188 -05:00 [DBG] em7SmlL8xB60XEv1+/JI6yqcbWeqNomSL1MONw4lC5I= found in database: true
2017-11-13 19:15:16.200 -05:00 [DBG] removing em7SmlL8xB60XEv1+/JI6yqcbWeqNomSL1MONw4lC5I= persisted grant from database
2017-11-13 19:15:16.209 -05:00 [DBG] Validation of authorization code token request success
2017-11-13 19:15:16.211 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c9373648860002022c99a610064400d72b1670c7a80324a20a76ada20185bbf3",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "c9373648860002022c99a610064400d72b1670c7a80324a20a76ada20185bbf3",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-13 19:15:16.248 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:16.259 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:16.334 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:16.335 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-13 19:15:16.336 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-13 19:15:16.367 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:16.372 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:16.432 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-13 19:15:16.433 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-13 19:15:16.434 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-13 19:15:16.439 -05:00 [DBG] Token request success.
2017-11-13 19:15:16.441 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-13 19:15:16.443 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-13 19:15:16.444 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-13 19:15:16.445 -05:00 [DBG] Start userinfo request
2017-11-13 19:15:16.446 -05:00 [DBG] Bearer token found in header
2017-11-13 19:15:16.471 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:16.500 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-13 19:15:16.501 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510618516,
    "exp": 1510622116,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510618515,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-13 19:15:16.509 -05:00 [DBG] Creating userinfo response
2017-11-13 19:15:16.510 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-13 19:15:16.519 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-13 19:15:16.521 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-13 19:15:16.528 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-13 19:15:16.530 -05:00 [DBG] End userinfo request
2017-11-13 20:14:40.210 -05:00 [INF] Clearing 0 tokens
2017-11-13 21:14:40.164 -05:00 [INF] Clearing 0 tokens
2017-11-13 22:14:40.112 -05:00 [INF] Clearing 0 tokens
2017-11-13 23:14:40.052 -05:00 [INF] Clearing 0 tokens
2017-11-14 00:14:39.998 -05:00 [INF] Clearing 0 tokens
2017-11-14 01:14:39.951 -05:00 [INF] Clearing 0 tokens
2017-11-14 02:14:39.779 -05:00 [INF] Clearing 0 tokens
2017-11-14 03:14:39.727 -05:00 [INF] Clearing 0 tokens
2017-11-14 04:14:39.679 -05:00 [INF] Clearing 0 tokens
2017-11-14 05:14:39.618 -05:00 [INF] Clearing 0 tokens
2017-11-14 06:14:39.572 -05:00 [INF] Clearing 0 tokens
2017-11-14 07:14:39.512 -05:00 [INF] Clearing 0 tokens
2017-11-14 08:14:39.457 -05:00 [INF] Clearing 0 tokens
2017-11-14 09:14:39.403 -05:00 [INF] Clearing 0 tokens
2017-11-14 09:57:55.661 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:57:55.662 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:57:55.664 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-14 09:57:55.665 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-14 09:57:55.667 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-14 09:57:55.669 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:57:55.670 -05:00 [DBG] Start end session request validation
2017-11-14 09:57:55.671 -05:00 [INF] End session request validation success
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbaXQYdwvwBn22DUSgX-jufxVxNDKrQEoRfvV8lRRKYLVVjKLMSMMGNdJS-QGnF34khWqtOmkTMQZMD64TMCWFndHBD6S7U_hfjjCpGebpiBMkNYPuELa9D3dmiuGa5yN2d4UxMsTYCLOpbNHZ8KLjl",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:57:55.675 -05:00 [DBG] Success validating end session request from null
2017-11-14 09:57:55.686 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:57:55.687 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:57:55.697 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 09:57:55.698 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:57:55.700 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 09:57:55.702 -05:00 [INF] User logged out.
2017-11-14 09:57:55.971 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-14 09:57:55.975 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-14 09:57:55.978 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-14 09:57:55.980 -05:00 [DBG] Processing signout callback request
2017-11-14 09:57:56.029 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:57:56.031 -05:00 [DBG] No client front-channel logout URLs
2017-11-14 09:57:56.032 -05:00 [DBG] No client back-channel logout URLs
2017-11-14 09:57:56.033 -05:00 [INF] Successful signout callback.
2017-11-14 09:57:56.034 -05:00 [DBG] No client front-channel iframe urls
2017-11-14 09:57:56.035 -05:00 [DBG] No client back-channel iframe urls
2017-11-14 09:57:58.201 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:58:05.459 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-14 09:58:05.467 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:58:05.468 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:58:05.469 -05:00 [INF] User logged in.
2017-11-14 09:58:05.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:05.479 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:12.996 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:12.997 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:13.007 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 09:58:13.009 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:58:13.010 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 09:58:13.010 -05:00 [INF] User logged out.
2017-11-14 09:58:18.737 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-14 09:58:18.738 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-14 09:58:18.740 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-14 09:58:18.742 -05:00 [DBG] Start authorize request
2017-11-14 09:58:18.743 -05:00 [DBG] No user present in authorize request
2017-11-14 09:58:18.744 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:18.764 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:18.766 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:18.766 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:18.777 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:18.845 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:18.849 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:18.853 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:18.855 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:18.856 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYo3kMCv2GFBNB33TGHyjWwphAv4MVewThdlb52wpcmIpH8LPzxCqZEgv81MOGTSzQiWH_x9XmrL-6y8ud-DLCLMPMjrsOFiNyHbtof3vFwMDhDREvtWNxc5HxKuUJ58ekhhspdPk6XWR1HmmIB7czeKmgTtoQCx_Ym8r1TJ-li-57uyuIzMrZ92SuSR2wnf7vdEoVjRdQqr8_5K43FW2wry5xrr1d7STHrz-nO2WyfdBXg90-snWvjVWT8vnQvx7BDJKXWtKLPbSEmQ92cNTxP",
  "Nonce": "636462682987316659.NmJjMWVjYmItNWYzNC00NDJjLWFlMzQtYjJkN2E3NTZkNDczZWY1YzY4ZGYtNWZiNi00NjBkLTlmNjMtYWFhYzczY2ZhYTFi",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462682987316659.NmJjMWVjYmItNWYzNC00NDJjLWFlMzQtYjJkN2E3NTZkNDczZWY1YzY4ZGYtNWZiNi00NjBkLTlmNjMtYWFhYzczY2ZhYTFi",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYo3kMCv2GFBNB33TGHyjWwphAv4MVewThdlb52wpcmIpH8LPzxCqZEgv81MOGTSzQiWH_x9XmrL-6y8ud-DLCLMPMjrsOFiNyHbtof3vFwMDhDREvtWNxc5HxKuUJ58ekhhspdPk6XWR1HmmIB7czeKmgTtoQCx_Ym8r1TJ-li-57uyuIzMrZ92SuSR2wnf7vdEoVjRdQqr8_5K43FW2wry5xrr1d7STHrz-nO2WyfdBXg90-snWvjVWT8vnQvx7BDJKXWtKLPbSEmQ92cNTxP",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:58:18.865 -05:00 [INF] Showing login: User is not authenticated
2017-11-14 09:58:18.872 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:58:24.105 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-14 09:58:24.107 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-14 09:58:24.108 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-14 09:58:24.109 -05:00 [DBG] Start authorize request
2017-11-14 09:58:24.110 -05:00 [DBG] No user present in authorize request
2017-11-14 09:58:24.111 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:24.131 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:24.132 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:24.133 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:24.140 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:24.205 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:24.212 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:24.246 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:24.248 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:24.249 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
  "Nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:58:24.259 -05:00 [INF] Showing login: User is not authenticated
2017-11-14 09:58:24.265 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:58:25.767 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-14 09:58:25.773 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:58:25.775 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:58:25.776 -05:00 [INF] User logged in.
2017-11-14 09:58:25.782 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:25.784 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:25.785 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 09:58:25.787 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 09:58:25.788 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 09:58:25.789 -05:00 [DBG] Start authorize callback request
2017-11-14 09:58:25.790 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:58:25.790 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:25.810 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:25.812 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:25.812 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:25.819 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:25.890 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:25.897 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:25.981 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:25.982 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:25.983 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
  "Nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
  "SessionId": "e81fe25fa73bab184b6cdc930aacf99b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:58:25.999 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-14 09:58:26.001 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-14 09:58:26.002 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-14 09:58:26.003 -05:00 [INF] Showing consent: User has not yet consented
2017-11-14 09:58:26.012 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:26.013 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:26.015 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:26.035 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:26.036 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:26.037 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:26.042 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:26.110 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:26.120 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:26.184 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:26.185 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:26.209 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:26.216 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:26.280 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:55.783 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:55.785 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:55.788 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:55.810 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:55.811 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:55.812 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:55.819 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:55.885 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:55.892 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:55.958 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:55.959 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:55.967 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:55.968 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:55.969 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 09:58:55.970 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 09:58:55.971 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 09:58:55.972 -05:00 [DBG] Start authorize callback request
2017-11-14 09:58:55.973 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:58:55.974 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:58:55.994 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:55.995 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:58:55.996 -05:00 [DBG] No PKCE used.
2017-11-14 09:58:56.002 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:56.073 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:56.080 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:56.154 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:56.156 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:58:56.157 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
  "Nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
  "SessionId": "e81fe25fa73bab184b6cdc930aacf99b",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:58:56.172 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-14 09:58:56.173 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-14 09:58:56.174 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-14 09:58:56.175 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1"]
2017-11-14 09:58:56.178 -05:00 [DBG] Client allows remembering consent, and no scopes provided. Removing consent from consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:58:56.185 -05:00 [DBG] no wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= persisted grant found in database
2017-11-14 09:58:56.186 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-14 09:58:56.204 -05:00 [DBG] KAcxdJ+wWuSTH5VfUoAgpP32hUSQUsGlppFZYXrHYns= not found in database
2017-11-14 09:58:56.217 -05:00 [DBG] Creating Implicit Flow response.
2017-11-14 09:58:56.218 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:58:56.220 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:58:56.230 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Va6cGSOy5HPGch_WwPF8gDAWfPAWvkx6qwD9SYjS0eMjCFRsLrNgLC6lhhG5UqQpu32xuKJUtpHcOmIgLPOHph8t7xUPUp_hE6YaQBkIft1GnozwP_GutDPZqstAooj_A2ujOer-6ie0rl_RfophnhbNrwl__3KefqQiQbOute3-es1fXqb2yNyWQzyNUwyCoLqUUL68T4ZF0MxiV-js6iohvzxo-ynwBLiFRSezY6evOn4Qlhcp1unOsbYaAxxuUiCLBHIoATHUpPk0WW3GfSw",
  "Scope": "openid profile email api1"
}
2017-11-14 09:58:56.234 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:58:56.235 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:58:56.489 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-14 09:58:56.491 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-14 09:58:56.493 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-14 09:58:56.494 -05:00 [DBG] Start token request.
2017-11-14 09:58:56.495 -05:00 [DBG] Start client validation
2017-11-14 09:58:56.495 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-14 09:58:56.496 -05:00 [DBG] Start parsing for secret in post body
2017-11-14 09:58:56.497 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-14 09:58:56.498 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-14 09:58:56.522 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:56.523 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-14 09:58:56.524 -05:00 [DBG] Client validation success
2017-11-14 09:58:56.525 -05:00 [DBG] Start token request validation
2017-11-14 09:58:56.526 -05:00 [DBG] Start validation of authorization code token request
2017-11-14 09:58:56.529 -05:00 [DBG] KAcxdJ+wWuSTH5VfUoAgpP32hUSQUsGlppFZYXrHYns= found in database: true
2017-11-14 09:58:56.542 -05:00 [DBG] removing KAcxdJ+wWuSTH5VfUoAgpP32hUSQUsGlppFZYXrHYns= persisted grant from database
2017-11-14 09:58:56.562 -05:00 [DBG] Validation of authorization code token request success
2017-11-14 09:58:56.563 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "c0e28ff2d9a04515be4a2e18eae81f42206c089f7d53572a9befc6d64997e490",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "c0e28ff2d9a04515be4a2e18eae81f42206c089f7d53572a9befc6d64997e490",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-14 09:58:56.573 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:56.582 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:56.654 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:56.655 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-14 09:58:56.656 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:58:56.668 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:56.670 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:56.674 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:58:56.675 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:58:56.676 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:58:56.681 -05:00 [DBG] Token request success.
2017-11-14 09:58:56.685 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-14 09:58:56.686 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-14 09:58:56.687 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-14 09:58:56.689 -05:00 [DBG] Start userinfo request
2017-11-14 09:58:56.690 -05:00 [DBG] Bearer token found in header
2017-11-14 09:58:56.710 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:56.732 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:56.734 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510671536,
    "exp": 1510675136,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671505,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-14 09:58:56.741 -05:00 [DBG] Creating userinfo response
2017-11-14 09:58:56.742 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-14 09:58:56.749 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:58:56.751 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-14 09:58:56.757 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-14 09:58:56.758 -05:00 [DBG] End userinfo request
2017-11-14 09:58:59.452 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:59.454 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:59.455 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-14 09:58:59.456 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-14 09:58:59.458 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-14 09:58:59.459 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:58:59.460 -05:00 [DBG] Start end session request validation
2017-11-14 09:58:59.461 -05:00 [DBG] Start identity token validation
2017-11-14 09:58:59.486 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:59.487 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-14 09:58:59.490 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-14 09:58:59.495 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510671536,
    "exp": 1510671836,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462683040819042.YWMxZmM3Y2EtMjIxMS00ZjEwLWI0ODAtMzQ0ZTEyNjAwMTA1YWI2ZWU3NWMtYThiMS00YmU3LTlmYTctMTBhZTU2NzhiNzY0",
    "iat": 1510671536,
    "at_hash": "qK8E8O30yJSg7nRlue8vUA",
    "sid": "e81fe25fa73bab184b6cdc930aacf99b",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671505,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-14 09:58:59.504 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VYL2payvFa7FS35K6_oQOAOp0DzdeVvQRb_m-KmCP5U6k2JcgoeNTo1-Nhdx4cGCBYLcddTWaCrdrrzYFn7u6ikhzGwNDh9aq-JXdsw3pI2LF2iSP0ZPArYb6v_7v17g-eV8vPP8mw8EwlVOUURgDr1",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2NzE1MzYsImV4cCI6MTUxMDY3MTgzNiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyNjgzMDQwODE5MDQyLllXTXhabU0zWTJFdE1qSXhNUzAwWmpFd0xXSTBPREF0TXpRMFpURXlOakF3TVRBMVlXSTJaV1UzTldNdFlUaGlNUzAwWW1VM0xUbG1ZVGN0TVRCaFpUVTJOemhpTnpZMCIsImlhdCI6MTUxMDY3MTUzNiwiYXRfaGFzaCI6InFLOEU4TzMweUpTZzduUmx1ZTh2VUEiLCJzaWQiOiJlODFmZTI1ZmE3M2JhYjE4NGI2Y2RjOTMwYWFjZjk5YiIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDY3MTUwNSwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.QzrzdvtOIJqhfiOBpXmnLr-5XSOSEHJnrNluhbQtvGUAtpGzOSGebb-LrM-SolnJu8lQ6mYqMnltxnAsh0GqLpkeRvVafDPerPh8-oBVd5s5jLjAw2VuXk_Mg2nQdj2AUAKBlsrlIzErApzTl3amNtXQ2TSJawJR5eUf8nhN_4XahG4kv4gUS0cVgWTsxWllW803KK4mdlQrkYBHHNqnqFmZihIVLGD7rI-WlipGm-6LGWK7fTCtyOGK-AkC3Rd6GYElYMZU-CIGsblC1Hyq2F2MbVJKz6jLq4SeFSeKaeoQ569x8l6cl7J4lNWUbFcABtoXKZAvfmpUgRTooVQe1A",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VYL2payvFa7FS35K6_oQOAOp0DzdeVvQRb_m-KmCP5U6k2JcgoeNTo1-Nhdx4cGCBYLcddTWaCrdrrzYFn7u6ikhzGwNDh9aq-JXdsw3pI2LF2iSP0ZPArYb6v_7v17g-eV8vPP8mw8EwlVOUURgDr1",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:58:59.514 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-14 09:58:59.534 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:59.535 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:58:59.537 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 09:58:59.538 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:58:59.540 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 09:58:59.541 -05:00 [INF] User logged out.
2017-11-14 09:58:59.713 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-14 09:58:59.715 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-14 09:58:59.717 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-14 09:58:59.718 -05:00 [DBG] Processing signout callback request
2017-11-14 09:58:59.749 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:58:59.750 -05:00 [DBG] No client front-channel logout URLs
2017-11-14 09:58:59.751 -05:00 [DBG] No client back-channel logout URLs
2017-11-14 09:58:59.752 -05:00 [INF] Successful signout callback.
2017-11-14 09:58:59.753 -05:00 [DBG] No client front-channel iframe urls
2017-11-14 09:58:59.754 -05:00 [DBG] No client back-channel iframe urls
2017-11-14 09:59:01.478 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-14 09:59:01.480 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-14 09:59:01.481 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-14 09:59:01.483 -05:00 [DBG] Start authorize request
2017-11-14 09:59:01.484 -05:00 [DBG] No user present in authorize request
2017-11-14 09:59:01.484 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:01.504 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:01.505 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:01.506 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:01.512 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:01.575 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:01.577 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:01.581 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:01.582 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:01.584 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
  "Nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:01.592 -05:00 [INF] Showing login: User is not authenticated
2017-11-14 09:59:01.598 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:59:06.384 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-14 09:59:06.390 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:59:06.391 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:59:06.392 -05:00 [INF] User logged in.
2017-11-14 09:59:06.398 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:06.400 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:06.401 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 09:59:06.402 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 09:59:06.403 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 09:59:06.404 -05:00 [DBG] Start authorize callback request
2017-11-14 09:59:06.405 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:06.405 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:06.427 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:06.428 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:06.429 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:06.435 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:06.500 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:06.508 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:06.570 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:06.572 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:06.573 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
  "Nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
  "SessionId": "592b49a3d663e80418b9ec802c365cb5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:06.588 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-14 09:59:06.589 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-14 09:59:06.590 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-14 09:59:06.591 -05:00 [INF] Showing consent: User has not yet consented
2017-11-14 09:59:06.598 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:06.599 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:06.600 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:06.621 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:06.622 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:06.622 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:06.628 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:06.704 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:06.711 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:06.780 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:06.782 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:06.801 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:06.808 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:06.871 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.172 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:08.174 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:08.176 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:08.195 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.197 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:08.198 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:08.204 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.270 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.273 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.276 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.278 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:08.286 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:08.288 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:08.288 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 09:59:08.290 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 09:59:08.291 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 09:59:08.292 -05:00 [DBG] Start authorize callback request
2017-11-14 09:59:08.293 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:08.294 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:08.299 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.300 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:08.302 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:08.304 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.308 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.310 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.313 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.314 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:08.315 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
  "Nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
  "SessionId": "592b49a3d663e80418b9ec802c365cb5",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:08.330 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: false
2017-11-14 09:59:08.331 -05:00 [DBG] user_consent grant with value: mvc.hybrid|cf559f42-d46a-4dea-9390-b50e0f71a84e not found in store.
2017-11-14 09:59:08.332 -05:00 [DBG] Found no prior consent from consent store, consent is required
2017-11-14 09:59:08.333 -05:00 [INF] User consented to scopes: ["openid","profile","email","api1"]
2017-11-14 09:59:08.335 -05:00 [DBG] User indicated to remember consent for scopes: ["openid","profile","email","api1"]
2017-11-14 09:59:08.337 -05:00 [DBG] Client allows remembering consent, and consent given. Updating consent store for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:08.343 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= not found in database
2017-11-14 09:59:08.348 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-14 09:59:08.357 -05:00 [DBG] oxMtnHjKfUSNb8sawKqGmGYkvLrsZR4CllwlmdgPP8s= not found in database
2017-11-14 09:59:08.360 -05:00 [DBG] Creating Implicit Flow response.
2017-11-14 09:59:08.361 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:59:08.362 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:59:08.368 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6Vbq5cuwhkLYVBu3W5E1Dcz9oh-NHGzddRcWFwKBnqaUxbKAIrk4O4ONYD9VhjNjlQDweppqwnexecWLP2rHNd8-oFK13TOAWCXarNny1UHXJHpf_EEq7_u0KkeTxN1kl7arL_mV0WJZdQgHhbcrpu0YH4eVgkoJaB461SVrtoCQlayDdwrIn7YOMLeoozFvEQK23UCzAWJYkwxjWreL4AyjRn41ApBSLA_jrcz4TY3lOcnegS1G6eotgYR6RqSHy-s0K50-JPQw2wvene3Y1jHg",
  "Scope": "openid profile email api1"
}
2017-11-14 09:59:08.372 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:59:08.373 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:59:08.608 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-14 09:59:08.610 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-14 09:59:08.611 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-14 09:59:08.613 -05:00 [DBG] Start token request.
2017-11-14 09:59:08.614 -05:00 [DBG] Start client validation
2017-11-14 09:59:08.615 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-14 09:59:08.616 -05:00 [DBG] Start parsing for secret in post body
2017-11-14 09:59:08.617 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-14 09:59:08.618 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-14 09:59:08.641 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.642 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-14 09:59:08.643 -05:00 [DBG] Client validation success
2017-11-14 09:59:08.644 -05:00 [DBG] Start token request validation
2017-11-14 09:59:08.645 -05:00 [DBG] Start validation of authorization code token request
2017-11-14 09:59:08.649 -05:00 [DBG] oxMtnHjKfUSNb8sawKqGmGYkvLrsZR4CllwlmdgPP8s= found in database: true
2017-11-14 09:59:08.661 -05:00 [DBG] removing oxMtnHjKfUSNb8sawKqGmGYkvLrsZR4CllwlmdgPP8s= persisted grant from database
2017-11-14 09:59:08.670 -05:00 [DBG] Validation of authorization code token request success
2017-11-14 09:59:08.671 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "665c44be6a8cefad686ab241533077d36bd7b4a9ebfa498e9d88160760158fa3",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "665c44be6a8cefad686ab241533077d36bd7b4a9ebfa498e9d88160760158fa3",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-14 09:59:08.702 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.709 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.801 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.803 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-14 09:59:08.803 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:08.831 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.837 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.903 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:08.905 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:59:08.906 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:59:08.911 -05:00 [DBG] Token request success.
2017-11-14 09:59:08.917 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-14 09:59:08.919 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-14 09:59:08.922 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-14 09:59:08.925 -05:00 [DBG] Start userinfo request
2017-11-14 09:59:08.927 -05:00 [DBG] Bearer token found in header
2017-11-14 09:59:08.957 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.965 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:08.966 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510671548,
    "exp": 1510675148,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671546,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-14 09:59:08.973 -05:00 [DBG] Creating userinfo response
2017-11-14 09:59:08.974 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-14 09:59:08.981 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:08.983 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-14 09:59:08.991 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-14 09:59:08.993 -05:00 [DBG] End userinfo request
2017-11-14 09:59:16.380 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:16.383 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:16.384 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-14 09:59:16.385 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-14 09:59:16.386 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-14 09:59:16.387 -05:00 [DBG] Processing signout request for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:16.388 -05:00 [DBG] Start end session request validation
2017-11-14 09:59:16.388 -05:00 [DBG] Start identity token validation
2017-11-14 09:59:16.408 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:16.410 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-14 09:59:16.413 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-14 09:59:16.417 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510671548,
    "exp": 1510671848,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462683414682799.NDYxZDEyNDYtZmI0ZS00MjlmLTg3OGYtZWZkMjA1NDlhOGMxOGZiNmNjMDEtMTBlMi00ZGJjLWE3YTQtZDUxMjVhYmM5ZTVk",
    "iat": 1510671548,
    "at_hash": "LuEsIy9NXapefROG_c69FA",
    "sid": "592b49a3d663e80418b9ec802c365cb5",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671546,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-14 09:59:16.423 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VZTipFSA6Qw3fUL6aY7RmB0JFml2lXcyOkFDdoyvefbXdIVZaWDfPqTwgVAjEdtGKud8hnWtyHjtHnOkX2xmBahRIIviQN6nE0P9_MgLlmYBzQgXtew6ekx-Bc3CC1MPH_92F0JavKzO7uQgwKIJlYM",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2NzE1NDgsImV4cCI6MTUxMDY3MTg0OCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyNjgzNDE0NjgyNzk5Lk5EWXhaREV5TkRZdFptSTBaUzAwTWpsbUxUZzNPR1l0Wldaa01qQTFORGxoT0dNeE9HWmlObU5qTURFdE1UQmxNaTAwWkdKakxXRTNZVFF0WkRVeE1qVmhZbU01WlRWayIsImlhdCI6MTUxMDY3MTU0OCwiYXRfaGFzaCI6Ikx1RXNJeTlOWGFwZWZST0dfYzY5RkEiLCJzaWQiOiI1OTJiNDlhM2Q2NjNlODA0MThiOWVjODAyYzM2NWNiNSIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDY3MTU0NiwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.ffi3CG265ipIop3KgfZRot0xzkf8-UgWGwY84rwlH-7-7bwVqGYc5S6iOhSATTrcGECXHerd-AALoz7zgVeQuTeur4MZnfWoQ3veXFSFzm727_2u5Z9k4w-ZdiwjYIyYlxbzkO_S6PcBPcziOWpgwaZbydf508ZYB5wGf4gIfixKckYRy9CmlNIB9YqoDxfSwXEWmX0XJFNlMb8Eb6mwNpzPVhE8LuOF88FLme0mLgtTMDNyJveUA_nJyn-j04LaUOz_5-Qhb7qtwz5NVIF1FFi9v1O36NauUrij8rkpiOq6bF9KiogiMGtEFwgNvpjRaTlUVc0L4xvWtM0KxClzuQ",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VZTipFSA6Qw3fUL6aY7RmB0JFml2lXcyOkFDdoyvefbXdIVZaWDfPqTwgVAjEdtGKud8hnWtyHjtHnOkX2xmBahRIIviQN6nE0P9_MgLlmYBzQgXtew6ekx-Bc3CC1MPH_92F0JavKzO7uQgwKIJlYM",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:16.433 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-14 09:59:16.438 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:16.439 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:16.441 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 09:59:16.441 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:59:16.442 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 09:59:16.443 -05:00 [INF] User logged out.
2017-11-14 09:59:16.624 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-14 09:59:16.626 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-14 09:59:16.628 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-14 09:59:16.630 -05:00 [DBG] Processing signout callback request
2017-11-14 09:59:16.656 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:16.658 -05:00 [DBG] No client front-channel logout URLs
2017-11-14 09:59:16.659 -05:00 [DBG] No client back-channel logout URLs
2017-11-14 09:59:16.659 -05:00 [INF] Successful signout callback.
2017-11-14 09:59:16.660 -05:00 [DBG] No client front-channel iframe urls
2017-11-14 09:59:16.661 -05:00 [DBG] No client back-channel iframe urls
2017-11-14 09:59:22.709 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-14 09:59:22.710 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-14 09:59:22.711 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-14 09:59:22.713 -05:00 [DBG] Start authorize request
2017-11-14 09:59:22.713 -05:00 [DBG] No user present in authorize request
2017-11-14 09:59:22.714 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:22.733 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:22.735 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:22.735 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:22.741 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:22.803 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:22.806 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:22.809 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:22.810 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:22.811 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbGAPjqAbkYSDAjZ0gBy3QIGbITzL_jvxnihdiQtTjlYm8Y1CaM8Q0MYs57phJlVmhwPTpHhrs1_lvOFQgM4mNCbMTgFs1gmMUmyjHq06GqXJalHxW511NAXJdHy7tIQz3csf05vieH8aP6Qwg1VQoJm997FU2zsQKMizTcC1xlzKCGdPBArqTIDIXOPkHZxER0if96p2hku2oLA0LtECGFBGvJoVwiHZEyUYSkcdZSORtgH6wXV9KXKKd1mKugRhVUxsfig64VGHSi7AtQnEcQ",
  "Nonce": "636462683626889220.ZDI1YTRmMmMtNjkwMy00M2Y3LWE2MTAtYzAxODJhM2JiOTViOWYwMTkxYjAtMTdkYS00ZjQ2LWJjM2UtNGZkOTNkYTMxNTli",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683626889220.ZDI1YTRmMmMtNjkwMy00M2Y3LWE2MTAtYzAxODJhM2JiOTViOWYwMTkxYjAtMTdkYS00ZjQ2LWJjM2UtNGZkOTNkYTMxNTli",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbGAPjqAbkYSDAjZ0gBy3QIGbITzL_jvxnihdiQtTjlYm8Y1CaM8Q0MYs57phJlVmhwPTpHhrs1_lvOFQgM4mNCbMTgFs1gmMUmyjHq06GqXJalHxW511NAXJdHy7tIQz3csf05vieH8aP6Qwg1VQoJm997FU2zsQKMizTcC1xlzKCGdPBArqTIDIXOPkHZxER0if96p2hku2oLA0LtECGFBGvJoVwiHZEyUYSkcdZSORtgH6wXV9KXKKd1mKugRhVUxsfig64VGHSi7AtQnEcQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:22.821 -05:00 [INF] Showing login: User is not authenticated
2017-11-14 09:59:22.827 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 09:59:24.150 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorRememberMe was successfully authenticated.
2017-11-14 09:59:24.157 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:59:24.158 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:59:24.159 -05:00 [INF] User logged in.
2017-11-14 09:59:24.166 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:24.167 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:24.168 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 09:59:24.169 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 09:59:24.170 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 09:59:24.171 -05:00 [DBG] Start authorize callback request
2017-11-14 09:59:24.172 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:24.173 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 09:59:24.193 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.194 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 09:59:24.194 -05:00 [DBG] No PKCE used.
2017-11-14 09:59:24.200 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:24.270 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:24.273 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:24.339 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:24.340 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 09:59:24.341 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbGAPjqAbkYSDAjZ0gBy3QIGbITzL_jvxnihdiQtTjlYm8Y1CaM8Q0MYs57phJlVmhwPTpHhrs1_lvOFQgM4mNCbMTgFs1gmMUmyjHq06GqXJalHxW511NAXJdHy7tIQz3csf05vieH8aP6Qwg1VQoJm997FU2zsQKMizTcC1xlzKCGdPBArqTIDIXOPkHZxER0if96p2hku2oLA0LtECGFBGvJoVwiHZEyUYSkcdZSORtgH6wXV9KXKKd1mKugRhVUxsfig64VGHSi7AtQnEcQ",
  "Nonce": "636462683626889220.ZDI1YTRmMmMtNjkwMy00M2Y3LWE2MTAtYzAxODJhM2JiOTViOWYwMTkxYjAtMTdkYS00ZjQ2LWJjM2UtNGZkOTNkYTMxNTli",
  "SessionId": "99097c66ef63a0b591252009e3840c0d",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462683626889220.ZDI1YTRmMmMtNjkwMy00M2Y3LWE2MTAtYzAxODJhM2JiOTViOWYwMTkxYjAtMTdkYS00ZjQ2LWJjM2UtNGZkOTNkYTMxNTli",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbGAPjqAbkYSDAjZ0gBy3QIGbITzL_jvxnihdiQtTjlYm8Y1CaM8Q0MYs57phJlVmhwPTpHhrs1_lvOFQgM4mNCbMTgFs1gmMUmyjHq06GqXJalHxW511NAXJdHy7tIQz3csf05vieH8aP6Qwg1VQoJm997FU2zsQKMizTcC1xlzKCGdPBArqTIDIXOPkHZxER0if96p2hku2oLA0LtECGFBGvJoVwiHZEyUYSkcdZSORtgH6wXV9KXKKd1mKugRhVUxsfig64VGHSi7AtQnEcQ",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 09:59:24.356 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: true
2017-11-14 09:59:24.361 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2017-11-14 09:59:24.362 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-14 09:59:24.372 -05:00 [DBG] CbEZNz/tREMyZpa+9VfZKxXJyLikLe/FMJ8HjA9uwgQ= not found in database
2017-11-14 09:59:24.376 -05:00 [DBG] Creating Implicit Flow response.
2017-11-14 09:59:24.377 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:59:24.378 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:59:24.384 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbGAPjqAbkYSDAjZ0gBy3QIGbITzL_jvxnihdiQtTjlYm8Y1CaM8Q0MYs57phJlVmhwPTpHhrs1_lvOFQgM4mNCbMTgFs1gmMUmyjHq06GqXJalHxW511NAXJdHy7tIQz3csf05vieH8aP6Qwg1VQoJm997FU2zsQKMizTcC1xlzKCGdPBArqTIDIXOPkHZxER0if96p2hku2oLA0LtECGFBGvJoVwiHZEyUYSkcdZSORtgH6wXV9KXKKd1mKugRhVUxsfig64VGHSi7AtQnEcQ",
  "Scope": "openid profile email api1"
}
2017-11-14 09:59:24.388 -05:00 [DBG] Augmenting SignInContext
2017-11-14 09:59:24.389 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 09:59:24.655 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-14 09:59:24.657 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-14 09:59:24.658 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-14 09:59:24.659 -05:00 [DBG] Start token request.
2017-11-14 09:59:24.660 -05:00 [DBG] Start client validation
2017-11-14 09:59:24.661 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-14 09:59:24.661 -05:00 [DBG] Start parsing for secret in post body
2017-11-14 09:59:24.663 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-14 09:59:24.664 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-14 09:59:24.689 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.690 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-14 09:59:24.691 -05:00 [DBG] Client validation success
2017-11-14 09:59:24.692 -05:00 [DBG] Start token request validation
2017-11-14 09:59:24.693 -05:00 [DBG] Start validation of authorization code token request
2017-11-14 09:59:24.696 -05:00 [DBG] CbEZNz/tREMyZpa+9VfZKxXJyLikLe/FMJ8HjA9uwgQ= found in database: true
2017-11-14 09:59:24.710 -05:00 [DBG] removing CbEZNz/tREMyZpa+9VfZKxXJyLikLe/FMJ8HjA9uwgQ= persisted grant from database
2017-11-14 09:59:24.716 -05:00 [DBG] Validation of authorization code token request success
2017-11-14 09:59:24.718 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "133535007dd9456f42cbbc5d5e716208526764d8342324f91f95511848171cc9",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "133535007dd9456f42cbbc5d5e716208526764d8342324f91f95511848171cc9",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-14 09:59:24.742 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.751 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:24.817 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:24.819 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-14 09:59:24.819 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:24.845 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.851 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:24.917 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:24.918 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 09:59:24.919 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 09:59:24.924 -05:00 [DBG] Token request success.
2017-11-14 09:59:24.927 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-14 09:59:24.928 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-14 09:59:24.929 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-14 09:59:24.930 -05:00 [DBG] Start userinfo request
2017-11-14 09:59:24.931 -05:00 [DBG] Bearer token found in header
2017-11-14 09:59:24.955 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.980 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:24.981 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510671564,
    "exp": 1510675164,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671564,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-14 09:59:24.989 -05:00 [DBG] Creating userinfo response
2017-11-14 09:59:24.990 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-14 09:59:24.997 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:24.999 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-14 09:59:25.004 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-14 09:59:25.006 -05:00 [DBG] End userinfo request
2017-11-14 09:59:27.350 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:27.352 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:30.735 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:30.737 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:30.789 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 09:59:30.818 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 09:59:30.825 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 09:59:30.887 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 09:59:57.662 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:57.665 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:58.821 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:58.822 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:59.725 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 09:59:59.726 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:00.549 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:00.550 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:01.567 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:01.569 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:01.574 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:00:01.602 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:00:01.609 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:00:01.691 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:00:04.766 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:04.768 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:05.997 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:05.999 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:06.789 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:06.790 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:07.853 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:07.856 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:00:07.860 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:00:07.905 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:00:07.912 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:00:07.975 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:01:59.959 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:01:59.961 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:01.293 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:01.294 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:01.299 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:02:01.326 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:02:01.332 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:02:01.395 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:02:04.642 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:04.643 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:05.619 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:05.620 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:02:05.625 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:02:05.648 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:02:05.655 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:02:05.718 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:05:01.847 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:05:01.847 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:05:01.852 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:05:01.889 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:05:01.898 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:05:01.994 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:05:02.159 -05:00 [ERR] An unhandled exception has occurred while executing the request
Microsoft.AspNetCore.Mvc.Razor.Compilation.CompilationFailedException: One or more compilation failures occurred:
C:\GitHub\IdSP\src\IdSP.Core\Views\Manage\Grants.cshtml(8,44): error CS1061: 'GrantsViewModel' does not contain a definition for 'StatusMessage' and no extension method 'StatusMessage' accepting a first argument of type 'GrantsViewModel' could be found (are you missing a using directive or an assembly reference?)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(RazorCodeDocument codeDocument, String generatedCode)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CompileAndEmit(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.Internal.RazorViewCompiler.CreateCacheEntry(String normalizedPath)
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
   at Microsoft.AspNetCore.Mvc.Razor.Internal.DefaultRazorPageFactoryProvider.CreateFactory(String relativePath)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.CreateCacheResult(HashSet`1 expirationTokens, String relativePath, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.OnCacheMiss(ViewLocationExpanderContext expanderContext, ViewLocationCacheKey cacheKey)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.LocatePageFromViewLocations(ActionContext actionContext, String pageName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.Razor.RazorViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewEngines.CompositeViewEngine.FindView(ActionContext context, String viewName, Boolean isMainPage)
   at Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewResultExecutor.FindView(ActionContext actionContext, ViewResult viewResult)
   at Microsoft.AspNetCore.Mvc.ViewResult.<ExecuteResultAsync>d__26.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeResultAsync>d__19.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResultFilterAsync>d__24.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextResourceFilter>d__22.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__17.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__15.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.IdentityServerMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.<Invoke>d__6.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.<Invoke>d__7.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at IdentityServer4.Hosting.BaseUrlMiddleware.<Invoke>d__3.MoveNext()
--- End of stack trace from previous location where exception was thrown ---
   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()
   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()
2017-11-14 10:05:55.658 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:05:55.659 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:05:57.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:05:57.933 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:23.320 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 10:10:23.346 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 10:10:23.347 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 10:10:23.347 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 10:10:23.348 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 10:10:23.436 -05:00 [DBG] Starting token cleanup
2017-11-14 10:10:24.040 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:24.053 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:35.990 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:35.992 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:36.033 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-14 10:10:36.042 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:10:36.611 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:10:36.655 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:10:36.870 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:10:40.830 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:40.832 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:42.014 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:42.015 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:10:42.020 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:10:42.047 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:10:42.053 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:10:42.118 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:12:40.593 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:12:40.594 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:12:46.042 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:12:46.044 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:12:46.048 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:12:46.077 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:12:46.085 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:12:46.156 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:13:06.521 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:06.523 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:07.369 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:07.371 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:07.375 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:13:07.405 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:13:07.411 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:13:07.478 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:13:25.170 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:25.172 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:26.992 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:26.994 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:28.325 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:28.326 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:28.468 -05:00 [INF] User with ID cf559f42-d46a-4dea-9390-b50e0f71a84e has disabled 2fa.
2017-11-14 10:13:28.476 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:28.478 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:32.951 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:32.953 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:33.848 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:33.850 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:34.503 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:34.505 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:35.271 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:35.272 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:38.457 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:38.459 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:43.175 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:43.177 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:43.848 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:13:43.850 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:14:28.983 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:14:28.985 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:14:28.991 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:14:29.024 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:14:29.031 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:14:29.103 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:29.113 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 10:17:29.141 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 10:17:29.142 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 10:17:29.143 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 10:17:29.144 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 10:17:29.232 -05:00 [DBG] Starting token cleanup
2017-11-14 10:17:31.444 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:31.458 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:31.705 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 10:17:31.707 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 10:17:31.708 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 10:17:31.709 -05:00 [INF] User logged out.
2017-11-14 10:17:34.219 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-14 10:17:34.225 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-14 10:17:34.226 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-14 10:17:34.231 -05:00 [DBG] Processing signout callback request
2017-11-14 10:17:34.514 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:34.519 -05:00 [DBG] No client front-channel logout URLs
2017-11-14 10:17:34.520 -05:00 [DBG] No client back-channel logout URLs
2017-11-14 10:17:34.521 -05:00 [INF] Successful signout callback.
2017-11-14 10:17:34.521 -05:00 [DBG] No client front-channel iframe urls
2017-11-14 10:17:34.522 -05:00 [DBG] No client back-channel iframe urls
2017-11-14 10:17:45.180 -05:00 [DBG] Request path /.well-known/openid-configuration matched to endpoint type Discovery
2017-11-14 10:17:45.183 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryEndpoint
2017-11-14 10:17:45.185 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryEndpoint for /.well-known/openid-configuration
2017-11-14 10:17:45.192 -05:00 [DBG] Start discovery request
2017-11-14 10:17:45.407 -05:00 [DBG] Found ["openid","profile","phone","email","api1"] as all scopes in database
2017-11-14 10:17:45.619 -05:00 [DBG] Request path /.well-known/openid-configuration/jwks matched to endpoint type Discovery
2017-11-14 10:17:45.622 -05:00 [DBG] Endpoint enabled: Discovery, successfully created handler: IdentityServer4.Endpoints.DiscoveryKeyEndpoint
2017-11-14 10:17:45.623 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.DiscoveryKeyEndpoint for /.well-known/openid-configuration/jwks
2017-11-14 10:17:45.628 -05:00 [DBG] Start key discovery request
2017-11-14 10:17:45.674 -05:00 [DBG] Request path /connect/endsession matched to endpoint type Endsession
2017-11-14 10:17:45.676 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionEndpoint
2017-11-14 10:17:45.678 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionEndpoint for /connect/endsession
2017-11-14 10:17:45.685 -05:00 [DBG] Processing signout request for anonymous
2017-11-14 10:17:45.692 -05:00 [DBG] Start end session request validation
2017-11-14 10:17:45.698 -05:00 [DBG] Start identity token validation
2017-11-14 10:17:45.733 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:45.734 -05:00 [DBG] Client found: mvc.hybrid / null
2017-11-14 10:17:45.752 -05:00 [DBG] Calling into custom token validator: IdentityServer4.Validation.DefaultCustomTokenValidator
2017-11-14 10:17:45.807 -05:00 [DBG] Token validation success
{
  "ClientId": "mvc.hybrid",
  "ValidateLifetime": false,
  "Claims": {
    "nbf": 1510671564,
    "exp": 1510671864,
    "iss": "http://localhost:5000",
    "aud": "mvc.hybrid",
    "nonce": "636462683626889220.ZDI1YTRmMmMtNjkwMy00M2Y3LWE2MTAtYzAxODJhM2JiOTViOWYwMTkxYjAtMTdkYS00ZjQ2LWJjM2UtNGZkOTNkYTMxNTli",
    "iat": 1510671564,
    "at_hash": "OUJByW7wDqCm1zPOwZUTxA",
    "sid": "99097c66ef63a0b591252009e3840c0d",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510671564,
    "idp": "local",
    "amr": "external"
  }
}
2017-11-14 10:17:45.819 -05:00 [INF] End session request validation success
{
  "ClientId": "mvc.hybrid",
  "SubjectId": "unknown",
  "PostLogOutUri": "http://localhost:5002/signout-callback-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VaJhUvUcQ7MN8X-tzYaUy5Ogsv38jgQnNeN5xAZrXMuB4E-DME1M-oFhYzmO0N1gJ4jH4lH5j6L7rP_7ENEJed_8zIfoMOy6kgGHPjdDTjlcKTS0Px0G74Xd39xMPzA_T-LcXaaJ3RnGfsjvWUsrKoB",
  "Raw": {
    "post_logout_redirect_uri": "http://localhost:5002/signout-callback-oidc",
    "id_token_hint": "eyJhbGciOiJSUzI1NiIsImtpZCI6ImFkNzk3YjY5ZmFmMmMwNjgwYmRhYTJhZDZjN2ZhZGFiIiwidHlwIjoiSldUIn0.eyJuYmYiOjE1MTA2NzE1NjQsImV4cCI6MTUxMDY3MTg2NCwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdDo1MDAwIiwiYXVkIjoibXZjLmh5YnJpZCIsIm5vbmNlIjoiNjM2NDYyNjgzNjI2ODg5MjIwLlpESTFZVFJtTW1NdE5qa3dNeTAwTTJZM0xXRTJNVEF0WXpBeE9ESmhNMkppT1RWaU9XWXdNVGt4WWpBdE1UZGtZUzAwWmpRMkxXSmpNMlV0Tkdaa09UTmtZVE14TlRsaSIsImlhdCI6MTUxMDY3MTU2NCwiYXRfaGFzaCI6Ik9VSkJ5Vzd3RHFDbTF6UE93WlVUeEEiLCJzaWQiOiI5OTA5N2M2NmVmNjNhMGI1OTEyNTIwMDllMzg0MGMwZCIsInN1YiI6ImNmNTU5ZjQyLWQ0NmEtNGRlYS05MzkwLWI1MGUwZjcxYTg0ZSIsImF1dGhfdGltZSI6MTUxMDY3MTU2NCwiaWRwIjoibG9jYWwiLCJhbXIiOlsiZXh0ZXJuYWwiXX0.Q9ho1C-5bUpiTsv8WpAcHxoyS5TOIwao5waCy95Iz6VA7dIIXKSuqzGW5bvgG8PJYKKTLAI_jNEdNXVPXeBLpC-lnihv9DkeFFaMNx1-VUI86lDndcWvKIAc-SYJGoDpWGoLwLdfb1e3xjr807DIA_bkiiELJtcAkQ7ejjbGfYQwm0gk9EK0669tWL97JBzF50PARk6gqDiNv80Eb5qSxrN8O8v5sK3pdqT2ReixIrxH2cTiRtbapVG8XbQVfBWg8ZvtgdEIY5G6zvJdfTHjFK1atjVh4ozPqacGcdMgfaQayzylDlldPpPAeQs1eEeoncnLFEzxmHeynT6Aj6X_yg",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VaJhUvUcQ7MN8X-tzYaUy5Ogsv38jgQnNeN5xAZrXMuB4E-DME1M-oFhYzmO0N1gJ4jH4lH5j6L7rP_7ENEJed_8zIfoMOy6kgGHPjdDTjlcKTS0Px0G74Xd39xMPzA_T-LcXaaJ3RnGfsjvWUsrKoB",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 10:17:45.829 -05:00 [DBG] Success validating end session request from mvc.hybrid
2017-11-14 10:17:45.860 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 10:17:45.862 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 10:17:45.864 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 10:17:45.865 -05:00 [INF] User logged out.
2017-11-14 10:17:47.354 -05:00 [DBG] Request path /connect/authorize matched to endpoint type Authorize
2017-11-14 10:17:47.358 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeEndpoint
2017-11-14 10:17:47.360 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeEndpoint for /connect/authorize
2017-11-14 10:17:47.365 -05:00 [DBG] Start authorize request
2017-11-14 10:17:47.370 -05:00 [DBG] No user present in authorize request
2017-11-14 10:17:47.377 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 10:17:47.404 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:47.409 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 10:17:47.412 -05:00 [DBG] No PKCE used.
2017-11-14 10:17:47.444 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:47.552 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:47.564 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:47.581 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:47.590 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 10:17:47.601 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "anonymous",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKY566Drkzw9PGdvxDOvCY_hf7zoXmk4oocLVuTPCOtbnek-Zili_AhV08E9gHbHyUtWJyxLNHXyP-mnS5zvLluxJmIKN_JaLhIKbFdpnbURQWDm4FFadzBE1_e5otOzs-SNxjywWWg9OALlXPTyad1YPt6DSL4RWncnn3Bw8-jb2FlascBk0Fc1KCQNLwlxst1bEkqOtRCM-afAWFKaAs7bstvgep4BsUJBttJ9KRVT5TSYaxchX7j9FzcsKTTmgrlISaSKbr9gseTIvI0765",
  "Nonce": "636462694673471392.MmJmYjE1YmMtMDk0Ni00OTYyLWE3MGUtMWFjNDAyNWY3ZTE3OTIzY2RjN2YtMTlhMC00NzZmLWFmOWUtZDRmOTNlODQzOTg3",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462694673471392.MmJmYjE1YmMtMDk0Ni00OTYyLWE3MGUtMWFjNDAyNWY3ZTE3OTIzY2RjN2YtMTlhMC00NzZmLWFmOWUtZDRmOTNlODQzOTg3",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKY566Drkzw9PGdvxDOvCY_hf7zoXmk4oocLVuTPCOtbnek-Zili_AhV08E9gHbHyUtWJyxLNHXyP-mnS5zvLluxJmIKN_JaLhIKbFdpnbURQWDm4FFadzBE1_e5otOzs-SNxjywWWg9OALlXPTyad1YPt6DSL4RWncnn3Bw8-jb2FlascBk0Fc1KCQNLwlxst1bEkqOtRCM-afAWFKaAs7bstvgep4BsUJBttJ9KRVT5TSYaxchX7j9FzcsKTTmgrlISaSKbr9gseTIvI0765",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 10:17:47.620 -05:00 [INF] Showing login: User is not authenticated
2017-11-14 10:17:47.634 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 10:17:50.104 -05:00 [DBG] Augmenting SignInContext
2017-11-14 10:17:50.111 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 10:17:50.113 -05:00 [INF] User logged in.
2017-11-14 10:17:50.121 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:50.123 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:50.125 -05:00 [DBG] Request path /connect/authorize/callback matched to endpoint type Authorize
2017-11-14 10:17:50.128 -05:00 [DBG] Endpoint enabled: Authorize, successfully created handler: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint
2017-11-14 10:17:50.130 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.AuthorizeCallbackEndpoint for /connect/authorize/callback
2017-11-14 10:17:50.137 -05:00 [DBG] Start authorize callback request
2017-11-14 10:17:50.143 -05:00 [DBG] User in authorize request: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:17:50.144 -05:00 [DBG] Start authorize request protocol validation
2017-11-14 10:17:50.170 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:50.172 -05:00 [DBG] Checking for PKCE parameters
2017-11-14 10:17:50.173 -05:00 [DBG] No PKCE used.
2017-11-14 10:17:50.182 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:50.264 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:50.271 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:50.343 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:50.344 -05:00 [DBG] Calling into custom validator: IdentityServer4.Validation.DefaultCustomAuthorizeRequestValidator
2017-11-14 10:17:50.346 -05:00 [INF] ValidatedAuthorizeRequest
{
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "AllowedRedirectUris": [
    "http://localhost:5002/signin-oidc"
  ],
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ResponseType": "code id_token",
  "ResponseMode": "form_post",
  "GrantType": "hybrid",
  "RequestedScopes": "openid profile email api1",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKY566Drkzw9PGdvxDOvCY_hf7zoXmk4oocLVuTPCOtbnek-Zili_AhV08E9gHbHyUtWJyxLNHXyP-mnS5zvLluxJmIKN_JaLhIKbFdpnbURQWDm4FFadzBE1_e5otOzs-SNxjywWWg9OALlXPTyad1YPt6DSL4RWncnn3Bw8-jb2FlascBk0Fc1KCQNLwlxst1bEkqOtRCM-afAWFKaAs7bstvgep4BsUJBttJ9KRVT5TSYaxchX7j9FzcsKTTmgrlISaSKbr9gseTIvI0765",
  "Nonce": "636462694673471392.MmJmYjE1YmMtMDk0Ni00OTYyLWE3MGUtMWFjNDAyNWY3ZTE3OTIzY2RjN2YtMTlhMC00NzZmLWFmOWUtZDRmOTNlODQzOTg3",
  "SessionId": "43073f4044751f2919c9c106b96cfbdc",
  "Raw": {
    "client_id": "mvc.hybrid",
    "redirect_uri": "http://localhost:5002/signin-oidc",
    "response_type": "code id_token",
    "scope": "openid profile email api1",
    "response_mode": "form_post",
    "nonce": "636462694673471392.MmJmYjE1YmMtMDk0Ni00OTYyLWE3MGUtMWFjNDAyNWY3ZTE3OTIzY2RjN2YtMTlhMC00NzZmLWFmOWUtZDRmOTNlODQzOTg3",
    "state": "CfDJ8ML9_O-wk55LiS4tPceL6VbKY566Drkzw9PGdvxDOvCY_hf7zoXmk4oocLVuTPCOtbnek-Zili_AhV08E9gHbHyUtWJyxLNHXyP-mnS5zvLluxJmIKN_JaLhIKbFdpnbURQWDm4FFadzBE1_e5otOzs-SNxjywWWg9OALlXPTyad1YPt6DSL4RWncnn3Bw8-jb2FlascBk0Fc1KCQNLwlxst1bEkqOtRCM-afAWFKaAs7bstvgep4BsUJBttJ9KRVT5TSYaxchX7j9FzcsKTTmgrlISaSKbr9gseTIvI0765",
    "x-client-SKU": "ID_NET",
    "x-client-ver": "2.1.4.0"
  }
}
2017-11-14 10:17:50.377 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-14 10:17:50.398 -05:00 [DBG] wr9e120HELGX7ySrK562s2RhRZw4MPkiuHqgvL7HCe4= found in database: true
2017-11-14 10:17:50.410 -05:00 [DBG] Consent found in consent store is same as current request, consent is not required
2017-11-14 10:17:50.417 -05:00 [DBG] Creating Hybrid Flow response.
2017-11-14 10:17:50.451 -05:00 [DBG] 6u8jKeg9BKnMxBA6aPmrC6K1rb7GXx8S5crdcKu7NNA= not found in database
2017-11-14 10:17:50.476 -05:00 [DBG] Creating Implicit Flow response.
2017-11-14 10:17:50.485 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 10:17:50.490 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 10:17:50.526 -05:00 [INF] Authorize endpoint response
{
  "SubjectId": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
  "ClientId": "mvc.hybrid",
  "RedirectUri": "http://localhost:5002/signin-oidc",
  "State": "CfDJ8ML9_O-wk55LiS4tPceL6VbKY566Drkzw9PGdvxDOvCY_hf7zoXmk4oocLVuTPCOtbnek-Zili_AhV08E9gHbHyUtWJyxLNHXyP-mnS5zvLluxJmIKN_JaLhIKbFdpnbURQWDm4FFadzBE1_e5otOzs-SNxjywWWg9OALlXPTyad1YPt6DSL4RWncnn3Bw8-jb2FlascBk0Fc1KCQNLwlxst1bEkqOtRCM-afAWFKaAs7bstvgep4BsUJBttJ9KRVT5TSYaxchX7j9FzcsKTTmgrlISaSKbr9gseTIvI0765",
  "Scope": "openid profile email api1"
}
2017-11-14 10:17:50.540 -05:00 [DBG] Augmenting SignInContext
2017-11-14 10:17:50.542 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 10:17:50.841 -05:00 [DBG] Request path /connect/token matched to endpoint type Token
2017-11-14 10:17:50.844 -05:00 [DBG] Endpoint enabled: Token, successfully created handler: IdentityServer4.Endpoints.TokenEndpoint
2017-11-14 10:17:50.845 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.TokenEndpoint for /connect/token
2017-11-14 10:17:50.854 -05:00 [DBG] Start token request.
2017-11-14 10:17:50.861 -05:00 [DBG] Start client validation
2017-11-14 10:17:50.866 -05:00 [DBG] Start parsing Basic Authentication secret
2017-11-14 10:17:50.870 -05:00 [DBG] Start parsing for secret in post body
2017-11-14 10:17:50.872 -05:00 [DBG] Parser found secret: PostBodySecretParser
2017-11-14 10:17:50.873 -05:00 [DBG] Secret id found: mvc.hybrid
2017-11-14 10:17:50.894 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:50.903 -05:00 [DBG] Secret validator success: HashedSharedSecretValidator
2017-11-14 10:17:50.904 -05:00 [DBG] Client validation success
2017-11-14 10:17:50.915 -05:00 [DBG] Start token request validation
2017-11-14 10:17:50.931 -05:00 [DBG] Start validation of authorization code token request
2017-11-14 10:17:50.935 -05:00 [DBG] 6u8jKeg9BKnMxBA6aPmrC6K1rb7GXx8S5crdcKu7NNA= found in database: true
2017-11-14 10:17:50.953 -05:00 [DBG] removing 6u8jKeg9BKnMxBA6aPmrC6K1rb7GXx8S5crdcKu7NNA= persisted grant from database
2017-11-14 10:17:50.961 -05:00 [DBG] Validation of authorization code token request success
2017-11-14 10:17:50.966 -05:00 [INF] Token request validation success
{
  "ClientId": "mvc.hybrid",
  "GrantType": "authorization_code",
  "AuthorizationCode": "40dc339debe0dac93005c161a77e7ced4a55e40ec147914eef022d1d7a54d528",
  "Raw": {
    "client_id": "mvc.hybrid",
    "client_secret": "***REDACTED***",
    "code": "40dc339debe0dac93005c161a77e7ced4a55e40ec147914eef022d1d7a54d528",
    "grant_type": "authorization_code",
    "redirect_uri": "http://localhost:5002/signin-oidc"
  }
}
2017-11-14 10:17:50.987 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:50.995 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:51.058 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:51.068 -05:00 [DBG] Getting claims for access token for client: mvc.hybrid
2017-11-14 10:17:51.070 -05:00 [DBG] Getting claims for access token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:17:51.092 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:51.094 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:51.098 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:17:51.099 -05:00 [DBG] Getting claims for identity token for subject: cf559f42-d46a-4dea-9390-b50e0f71a84e and client: mvc.hybrid
2017-11-14 10:17:51.101 -05:00 [DBG] In addition to an id_token, an access_token was requested. No claims other than sub are included in the id_token. To obtain more user claims, either use the user info endpoint or set AlwaysIncludeUserClaimsInIdToken on the client configuration.
2017-11-14 10:17:51.109 -05:00 [DBG] Token request success.
2017-11-14 10:17:51.121 -05:00 [DBG] Request path /connect/userinfo matched to endpoint type Userinfo
2017-11-14 10:17:51.123 -05:00 [DBG] Endpoint enabled: Userinfo, successfully created handler: IdentityServer4.Endpoints.UserInfoEndpoint
2017-11-14 10:17:51.125 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.UserInfoEndpoint for /connect/userinfo
2017-11-14 10:17:51.133 -05:00 [DBG] Start userinfo request
2017-11-14 10:17:51.136 -05:00 [DBG] Bearer token found in header
2017-11-14 10:17:51.168 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:51.196 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:51.197 -05:00 [DBG] Token validation success
{
  "ValidateLifetime": true,
  "AccessTokenType": "Jwt",
  "ExpectedScope": "openid",
  "Claims": {
    "nbf": 1510672671,
    "exp": 1510676271,
    "iss": "http://localhost:5000",
    "aud": [
      "http://localhost:5000/resources",
      "api1"
    ],
    "client_id": "mvc.hybrid",
    "sub": "cf559f42-d46a-4dea-9390-b50e0f71a84e",
    "auth_time": 1510672670,
    "idp": "local",
    "scope": [
      "openid",
      "profile",
      "email",
      "api1"
    ],
    "amr": "external"
  }
}
2017-11-14 10:17:51.216 -05:00 [DBG] Creating userinfo response
2017-11-14 10:17:51.222 -05:00 [DBG] Scopes in access token: openid profile email api1
2017-11-14 10:17:51.234 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:51.236 -05:00 [DBG] Requested claim types: sub updated_at locale zoneinfo birthdate gender website profile preferred_username nickname middle_name given_name family_name name picture email email_verified
2017-11-14 10:17:51.244 -05:00 [INF] Profile service returned to the following claim types: sub preferred_username name email email_verified
2017-11-14 10:17:51.246 -05:00 [DBG] End userinfo request
2017-11-14 10:17:52.786 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:52.788 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:54.921 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:54.924 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:17:54.950 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:17:54.978 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:17:54.985 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:17:55.047 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:19:15.175 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:19:15.177 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:19:15.182 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:19:15.215 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:19:15.224 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:19:15.300 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:19:31.183 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:19:31.184 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:19:31.188 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:19:31.217 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:19:31.224 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:19:31.289 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:22:30.955 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:30.957 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:30.962 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:22:30.987 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:22:30.995 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:22:31.058 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:22:34.057 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:34.059 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:34.064 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:22:34.089 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:22:34.096 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:22:34.158 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:22:36.263 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:36.264 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:22:36.270 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:22:36.295 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:22:36.302 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:22:36.367 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:23:25.695 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:23:25.697 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:23:25.702 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:23:25.725 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:23:25.731 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:23:25.795 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:23:54.358 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:23:54.359 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:23:54.363 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:23:54.391 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:23:54.400 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:23:54.465 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:24:38.645 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:24:38.646 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:24:38.651 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:24:38.677 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:24:38.683 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:24:38.753 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:27:05.387 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:27:05.388 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:27:05.395 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:27:05.432 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:27:05.440 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:27:05.507 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:27:25.394 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:27:25.396 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:27:25.401 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:27:25.428 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:27:25.436 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:27:25.510 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:30:51.955 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:30:51.957 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:30:51.961 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:30:51.985 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:30:51.992 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:30:52.057 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:31:32.658 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:31:32.660 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:31:32.664 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:31:32.690 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:31:32.697 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:31:32.769 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:31:52.113 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:31:52.114 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:31:52.119 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:31:52.147 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:31:52.154 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:31:52.237 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:32:37.770 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:32:37.771 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:32:37.776 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:32:37.804 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:32:37.811 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:32:37.875 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:34:46.038 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:34:46.039 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:34:46.045 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:34:46.075 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:34:46.083 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:34:46.158 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:35:08.910 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:08.919 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:08.928 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:35:08.954 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:35:08.961 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:35:09.022 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:35:24.621 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:24.623 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:24.628 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:35:24.654 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:35:24.662 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:35:24.727 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:35:42.492 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:42.497 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:35:42.502 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:35:42.532 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:35:42.538 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:35:42.616 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:36:07.788 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:07.789 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:07.793 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:36:07.832 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:36:07.839 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:36:07.911 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:36:26.516 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:26.518 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:26.522 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:36:26.549 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:36:26.556 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:36:26.620 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:36:29.507 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:29.509 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:36:29.515 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:36:29.541 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:36:29.549 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:36:29.616 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:42:55.601 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:42:55.603 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:42:55.612 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:42:55.647 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:42:55.654 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:42:55.734 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:42:58.698 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:42:58.700 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:42:58.704 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:42:58.731 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:42:58.738 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:42:58.800 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:46:06.108 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:46:06.109 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:46:06.115 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:46:06.147 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:46:06.154 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:46:06.222 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:46:26.603 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:46:26.605 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:46:26.609 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:46:26.636 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:46:26.642 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:46:26.713 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:50:02.470 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:50:02.472 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:50:02.477 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:50:02.505 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:50:02.511 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:50:02.581 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:51:22.529 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:51:22.531 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:51:22.536 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:51:22.561 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:51:22.568 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:51:22.634 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:52:11.282 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:52:11.284 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:52:11.290 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:52:11.316 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:52:11.324 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:52:11.390 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:52:14.882 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:52:14.883 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:52:14.888 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:52:14.919 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:52:14.926 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:52:15.009 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:53:00.653 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:00.654 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:00.659 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:53:00.686 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:53:00.694 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:53:00.760 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:53:21.801 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:21.803 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:21.812 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:53:21.837 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:53:21.844 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:53:21.909 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:53:47.149 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:47.151 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:53:47.155 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:53:47.179 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:53:47.187 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:53:47.250 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:54:34.494 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:54:34.495 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:54:34.500 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:54:34.529 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:54:34.537 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:54:34.604 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:55:48.974 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:55:48.976 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:55:48.983 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:55:49.014 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:55:49.021 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:55:49.109 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:57:38.881 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:57:38.883 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:57:38.889 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:57:38.917 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:57:38.924 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:57:38.993 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:58:09.798 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:58:09.799 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:58:09.804 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:58:09.834 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:58:09.843 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:58:09.917 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:58:54.154 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:58:54.156 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:58:54.161 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:58:54.188 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:58:54.195 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:58:54.260 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:59:00.224 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:00.225 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:00.229 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:59:00.256 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:59:00.263 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:59:00.331 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:59:06.106 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:06.108 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:07.403 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:07.405 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:08.403 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:08.404 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:09.265 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:09.267 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:10.411 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:10.413 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:12.794 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:12.796 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:14.340 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:14.342 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:16.962 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:16.964 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:16.968 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:59:16.997 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:59:17.005 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:59:17.097 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:59:18.089 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:18.091 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:19.506 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:19.507 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:20.227 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:20.229 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:23.345 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:23.347 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:25.721 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:25.723 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:25.728 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:59:25.759 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:59:25.766 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:59:25.834 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 10:59:26.576 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:26.578 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:27.442 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:27.444 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 10:59:27.448 -05:00 [DBG] 1 persisted grants found for cf559f42-d46a-4dea-9390-b50e0f71a84e
2017-11-14 10:59:27.474 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 10:59:27.480 -05:00 [DBG] Found ["openid","profile","email"] identity scopes in database
2017-11-14 10:59:27.541 -05:00 [DBG] Found ["api1"] API scopes in database
2017-11-14 11:00:57.827 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:00:57.829 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:00.265 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:00.266 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:02.710 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:02.712 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:04.371 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:04.373 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:23.169 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:23.171 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:01:23.174 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 11:01:23.175 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:01:23.176 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 11:01:23.177 -05:00 [INF] User logged out.
2017-11-14 11:01:23.347 -05:00 [DBG] Request path /connect/endsession/callback matched to endpoint type Endsession
2017-11-14 11:01:23.349 -05:00 [DBG] Endpoint enabled: Endsession, successfully created handler: IdentityServer4.Endpoints.EndSessionCallbackEndpoint
2017-11-14 11:01:23.350 -05:00 [INF] Invoking IdentityServer endpoint: IdentityServer4.Endpoints.EndSessionCallbackEndpoint for /connect/endsession/callback
2017-11-14 11:01:23.352 -05:00 [DBG] Processing signout callback request
2017-11-14 11:01:23.383 -05:00 [DBG] mvc.hybrid found in database: true
2017-11-14 11:01:23.385 -05:00 [DBG] No client front-channel logout URLs
2017-11-14 11:01:23.387 -05:00 [DBG] No client back-channel logout URLs
2017-11-14 11:01:23.388 -05:00 [INF] Successful signout callback.
2017-11-14 11:01:23.389 -05:00 [DBG] No client front-channel iframe urls
2017-11-14 11:01:23.389 -05:00 [DBG] No client back-channel iframe urls
2017-11-14 11:02:05.072 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:09:48.318 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 11:09:48.349 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 11:09:48.350 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 11:09:48.351 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 11:09:48.351 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 11:09:48.503 -05:00 [DBG] Starting token cleanup
2017-11-14 11:09:49.656 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:32:27.479 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 11:32:27.508 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 11:32:27.509 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 11:32:27.510 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 11:32:27.510 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 11:32:27.600 -05:00 [DBG] Starting token cleanup
2017-11-14 11:32:27.842 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:32:43.028 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:33:22.666 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:41:20.469 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:42:22.024 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:43:03.902 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:43:20.139 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:43:45.052 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:43:59.950 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:44:54.324 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:44:56.044 -05:00 [INF] AuthenticationScheme: Identity.Application was challenged.
2017-11-14 11:44:56.057 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:45:35.790 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:45:41.123 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:45:42.797 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-14 11:45:43.531 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:45:43.548 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:45:43.684 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:45:43.749 -05:00 [DBG] Augmenting SignInContext
2017-11-14 11:45:43.757 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 11:45:43.759 -05:00 [INF] User logged in with Facebook provider.
2017-11-14 11:45:43.770 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:45:43.771 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:13.629 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:13.632 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:15.851 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:15.853 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:18.596 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:18.598 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:18.630 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 11:46:18.631 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:18.632 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 11:46:18.634 -05:00 [INF] User logged out.
2017-11-14 11:46:20.691 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:22.455 -05:00 [INF] AuthenticationScheme: Twitter was challenged.
2017-11-14 11:46:26.060 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:46:26.069 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:46:32.097 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:46:32.120 -05:00 [WRN] User f0d1356a-387b-4936-9590-be701c45a871 validation failed: DuplicateUserName.
2017-11-14 11:46:39.146 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:42.612 -05:00 [INF] AuthenticationScheme: Facebook was challenged.
2017-11-14 11:46:42.901 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:46:42.909 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:46:42.916 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:42.923 -05:00 [DBG] Augmenting SignInContext
2017-11-14 11:46:42.924 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 11:46:42.926 -05:00 [INF] User logged in with Facebook provider.
2017-11-14 11:46:42.932 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:42.934 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:44.299 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:44.301 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:45.777 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:45.779 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:46.466 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:46.468 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:48.516 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:48.517 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:48.525 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:48.685 -05:00 [INF] AuthenticationScheme: Twitter was challenged.
2017-11-14 11:46:53.211 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:46:53.219 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:53.221 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:53.231 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:46:53.296 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:53.339 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:53.340 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:58.065 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:58.068 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:59.154 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:59.156 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:46:59.159 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 11:46:59.160 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:46:59.161 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 11:46:59.162 -05:00 [INF] User logged out.
2017-11-14 11:47:01.178 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:47:02.935 -05:00 [INF] AuthenticationScheme: Twitter was challenged.
2017-11-14 11:47:06.813 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:47:06.821 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:47:06.828 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:47:06.838 -05:00 [DBG] Augmenting SignInContext
2017-11-14 11:47:06.839 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 11:47:06.840 -05:00 [INF] User logged in with Twitter provider.
2017-11-14 11:47:06.846 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:06.847 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:08.436 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:08.437 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:08.440 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 11:47:08.442 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:47:08.443 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 11:47:08.444 -05:00 [INF] User logged out.
2017-11-14 11:47:10.361 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:47:11.483 -05:00 [INF] AuthenticationScheme: Twitter was challenged.
2017-11-14 11:47:21.396 -05:00 [INF] AuthenticationScheme: Identity.External signed in.
2017-11-14 11:47:21.405 -05:00 [INF] AuthenticationScheme: Identity.External was successfully authenticated.
2017-11-14 11:47:21.411 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 11:47:21.418 -05:00 [DBG] Augmenting SignInContext
2017-11-14 11:47:21.420 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 11:47:21.421 -05:00 [INF] User logged in with Twitter provider.
2017-11-14 11:47:21.428 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:21.429 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:28.359 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:28.361 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:30.097 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:30.099 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 11:47:30.101 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 12:32:27.571 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-14 12:32:27.580 -05:00 [INF] Clearing 0 tokens
2017-11-14 12:43:27.723 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 12:43:27.725 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 12:43:27.727 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 12:43:27.728 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:43:27.729 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 12:43:27.730 -05:00 [INF] User logged out.
2017-11-14 12:43:29.757 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:45:18.815 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:46:52.382 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:47:53.417 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:48:20.339 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:48:38.730 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:48:48.656 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 12:49:39.071 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:20:47.001 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 13:20:47.043 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 13:20:47.044 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 13:20:47.044 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 13:20:47.045 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 13:20:47.143 -05:00 [DBG] Starting token cleanup
2017-11-14 13:20:52.641 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:21:04.417 -05:00 [DBG] Using Identity.Application as default scheme for authentication
2017-11-14 13:21:04.444 -05:00 [DBG] Using Identity.External as default scheme for sign-in
2017-11-14 13:21:04.445 -05:00 [DBG] Using Identity.External as default scheme for sign-out
2017-11-14 13:21:04.446 -05:00 [DBG] Using Identity.Application as default scheme for challenge
2017-11-14 13:21:04.447 -05:00 [DBG] Using Identity.Application as default scheme for forbid
2017-11-14 13:21:04.528 -05:00 [DBG] Starting token cleanup
2017-11-14 13:21:05.796 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:21:25.207 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:21:58.051 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:23:45.905 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:24:26.638 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:25:11.614 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:29:15.478 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:30:24.767 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:30:27.255 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:30:28.318 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:32:52.708 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:33:26.848 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:34:50.665 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 13:34:58.976 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:13:55.029 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:14:12.799 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:14:31.501 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:15:02.862 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:15:22.877 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:16:13.483 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:16:39.995 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:17:06.747 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:17:42.985 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:18:30.296 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:18:32.917 -05:00 [DBG] Augmenting SignInContext
2017-11-14 14:18:32.927 -05:00 [INF] AuthenticationScheme: Identity.Application signed in.
2017-11-14 14:18:32.929 -05:00 [INF] User logged in.
2017-11-14 14:18:32.939 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 14:18:32.941 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 14:18:35.191 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 14:18:35.193 -05:00 [INF] AuthenticationScheme: Identity.Application was successfully authenticated.
2017-11-14 14:18:35.238 -05:00 [INF] AuthenticationScheme: Identity.Application signed out.
2017-11-14 14:18:35.240 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:18:35.242 -05:00 [INF] AuthenticationScheme: Identity.TwoFactorUserId signed out.
2017-11-14 14:18:35.242 -05:00 [INF] User logged out.
2017-11-14 14:18:37.461 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:19:49.751 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:20:08.422 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:20:48.409 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:21:04.480 -05:00 [WRN] Sensitive data logging is enabled. Log entries and exception messages may include sensitive application data, this mode should only be enabled during development.
2017-11-14 14:21:04.489 -05:00 [INF] Clearing 0 tokens
2017-11-14 14:21:31.462 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:21:56.278 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:22:11.686 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:22:14.068 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:22:26.069 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:23:16.995 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:23:54.563 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:24:45.346 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:25:07.551 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:25:29.999 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:26:06.479 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:26:32.514 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 14:29:57.915 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:21:04.470 -05:00 [INF] Clearing 0 tokens
2017-11-14 15:21:41.538 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:22:03.632 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:22:09.289 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:22:52.069 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:28:59.380 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:29:11.484 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:29:30.874 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:29:32.461 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:29:33.781 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:29:35.004 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
2017-11-14 15:30:10.730 -05:00 [INF] AuthenticationScheme: Identity.External signed out.
